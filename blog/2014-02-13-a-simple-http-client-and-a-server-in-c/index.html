<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<title>A simple HTTP client and a server in C - The Insane Techie</title>
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="generator" content="Hugo 0.72.0" /><meta itemprop="name" content="A simple HTTP client and a server in C">
<meta itemprop="description" content="The HTTP server sends the files requested by the client, if it is available at the server. The HTTP client uses GET method for requesting files from the server. Only .html, .txt and .pdf files are implemented. On receiving the file, the client program opens it using firefox or gedit or acrobat reader, as per the file type. Note that the given programs were done in Linux (Debian) environment.
httpserver.c">
<meta itemprop="datePublished" content="2014-02-13T23:06:00&#43;05:30" />
<meta itemprop="dateModified" content="2014-02-13T23:06:00&#43;05:30" />
<meta itemprop="wordCount" content="1357">



<meta itemprop="keywords" content="gcc,http,linux,C/CPP,socket,tcp,network," /><meta property="og:title" content="A simple HTTP client and a server in C" />
<meta property="og:description" content="The HTTP server sends the files requested by the client, if it is available at the server. The HTTP client uses GET method for requesting files from the server. Only .html, .txt and .pdf files are implemented. On receiving the file, the client program opens it using firefox or gedit or acrobat reader, as per the file type. Note that the given programs were done in Linux (Debian) environment.
httpserver.c" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dhanoopbhaskar.github.io/blog/2014-02-13-a-simple-http-client-and-a-server-in-c/" />
<meta property="article:published_time" content="2014-02-13T23:06:00+05:30" />
<meta property="article:modified_time" content="2014-02-13T23:06:00+05:30" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="A simple HTTP client and a server in C"/>
<meta name="twitter:description" content="The HTTP server sends the files requested by the client, if it is available at the server. The HTTP client uses GET method for requesting files from the server. Only .html, .txt and .pdf files are implemented. On receiving the file, the client program opens it using firefox or gedit or acrobat reader, as per the file type. Note that the given programs were done in Linux (Debian) environment.
httpserver.c"/>
<meta name="twitter:site" content="@dhanoopbhaskar"/>
<link rel="stylesheet" href="/css/bundle.min.759e3848ea529eef056dab665b241e2af569e601ab80f68f8d4a4d002a155dd4.css" integrity="sha256-dZ44SOpSnu8FbatmWyQeKvVp5gGrgPaPjUpNACoVXdQ="><link rel="stylesheet" href="/css/add-on.css">
</head>

  <body>
    

<header id="site-header">
  <nav id="site-nav">
    <h1 class="nav-title">
      <a href="/" class="nav">
        
          
            Blog
          
        
      </a>
    </h1>
    <menu id="site-nav-menu" class="flyout-menu menu">
      
        
          
          
            <a href="/" class="nav link"><i class='fa fa-home'></i> Home</a>
          
        
      
        
          
          
            <a href="/about/" class="nav link"><i class='far fa-id-card'></i> About</a>
          
        
      
        
          
          
            <a href="/blog/" class="nav link"><i class='far fa-newspaper'></i> Blog</a>
          
        
      
        
          
          
            <a href="/categories/" class="nav link"><i class='fas fa-sitemap'></i> Categories</a>
          
        
      
        
          
          
            <a href="/contact/" class="nav link"><i class='far fa-envelope'></i> Contact</a>
          
        
      
      <a href="#share-menu" class="nav share-toggle"><i class="fas fa-share-alt">&nbsp;</i>Share</a>
      <a href="#search-input" class="nav search-toggle"><i class="fas fa-search">&nbsp;</i>Search</a>
    </menu>
    <a href="#search-input" class="nav search-toggle"><i class="fas fa-search fa-2x">&nbsp;</i></a>
    <a href="#share-menu" class="nav share-toggle"><i class="fas fa-share-alt fa-2x">&nbsp;</i></a>
    <a href="#lang-menu" class="nav lang-toggle" lang="en">en</a>
    <a href="#site-nav" class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a>
  </nav>
  <menu id="search" class="menu"><input id="search-input" class="search-input menu"></input><div id="search-results" class="search-results menu"></div></menu>
  <menu id="lang-menu" class="flyout-menu menu">
  <a href="#" lang="en" class="nav link active">English (en)</a>
  
    
      
    
  
</menu>

  
    <menu id="share-menu" class="flyout-menu menu">
      <h1>Share Post</h1>
      




  
    
    <a href="//twitter.com/share?text=A%20simple%20HTTP%20client%20and%20a%20server%20in%20C&amp;url=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f" target="_blank" rel="noopener" class="nav share-btn twitter">
        <i class="fab fa-twitter"></i><p>&nbsp;Twitter</p>
      </a>
  

  
      <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f" target="_blank" rel="noopener" class="nav share-btn facebook">
        <i class="fab fa-facebook"></i><p>&nbsp;Facebook</p>
        </a>
  

  
    <a href="//www.reddit.com/submit?url=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f&amp;title=A%20simple%20HTTP%20client%20and%20a%20server%20in%20C" target="_blank" rel="noopener" class="nav share-btn reddit">
          <i class="fab fa-reddit-alien"></i><p>&nbsp;Reddit</p>
        </a>
  

  
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f&amp;title=A%20simple%20HTTP%20client%20and%20a%20server%20in%20C" target="_blank" rel="noopener" class="nav share-btn linkedin">
            <i class="fab fa-linkedin"></i><p>&nbsp;LinkedIn</p>
          </a>
  

  
        <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f&amp;description=A%20simple%20HTTP%20client%20and%20a%20server%20in%20C" target="_blank" rel="noopener" class="nav share-btn pinterest">
          <i class="fab fa-pinterest-p"></i><p>&nbsp;Pinterest</p>
        </a>
  

  
        <a href="mailto:?subject=Check%20out%20this%20post%20by Dhanoop%20Bhaskar&amp;body=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f" target="_blank" class="nav share-btn email" data-proofer-ignore>
          <i class="fas fa-envelope"></i><p>&nbsp;Email</p>
        </a>
  


    </menu>
  
</header>

    <div id="wrapper">
      <section id="site-intro" >
  <a href="/"><img src="https://dhanoopbhaskar.github.io/img/main/logo.jpeg" class="circle" width="" alt="Dhanoop Bhaskar" /></a>
  <header>
    <h1>The Insane Techie</h1>
  </header>
  <main>
    <p>let's talk with the computers!</p>
  </main>
  
    <footer>
      <ul class="socnet-icons">
        

        <li><a href="//github.com/dhanoopbhaskar" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>


<li><a href="//bitbucket.com/dhanoopbhaskar" target="_blank" rel="noopener" title="Bitbucket" class="fab fa-bitbucket"></a></li>






<li><a href="//theinsanetechie.wordpress.com" target="_blank" rel="noopener" title="WordPress" class="fab fa-wordpress"></a></li>

<li><a href="//linkedin.com/in/dhanoopbhaskar" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a></li>




<li><a href="//facebook.com/dhanoopbhaskar" target="_blank" rel="noopener" title="Facebook" class="fab fa-facebook"></a></li>

<li><a href="//quora.com/profile/dhanoopbhaskar" target="_blank" rel="noopener" title="Quora" class="fab fa-quora"></a></li>
<li><a href="//youtube.com/dhanoopbhaskar" target="_blank" rel="noopener" title="YouTube" class="fab fa-youtube"></a></li>





<li><a href="//instagram.com/dhanoopbhaskar" target="_blank" rel="noopener" title="Instagram" class="fab fa-instagram"></a></li>

<li><a href="//twitter.com/dhanoopbhaskar" target="_blank" rel="noopener" title="Twitter" class="fab fa-twitter"></a></li>

<li><a href="skype:dhanoopbhaskar?userinfo" target="_blank" rel="noopener" title="Skype" class="fab fa-skype"></a></li>









<li><a href="mailto:dhanoopbhaskar@gmail.com" target="_blank" title="Email" class="far fa-envelope"></a></li>

      </ul>
    </footer>
  
</section>

      <main id="site-main">
        
  <article class="post">
    <header>
  <div class="title">
    
      <h2><a href="/blog/2014-02-13-a-simple-http-client-and-a-server-in-c/">A simple HTTP client and a server in C</a></h2>
    
    
  </div>
  <div class="meta">
    <time class="published" datetime="2014-02-13 23:06:00.001 &#43;0530 IST">
      February 13, 2014
    </time>
    <span class="author">Dhanoop Bhaskar</span>
    
      <p>7 minute read</p>
    
  </div>
</header>

    <section id="socnet-share">
      




  
    
    <a href="//twitter.com/share?text=A%20simple%20HTTP%20client%20and%20a%20server%20in%20C&amp;url=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f" target="_blank" rel="noopener" class="nav share-btn twitter">
        <i class="fab fa-twitter"></i><p>&nbsp;Twitter</p>
      </a>
  

  
      <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f" target="_blank" rel="noopener" class="nav share-btn facebook">
        <i class="fab fa-facebook"></i><p>&nbsp;Facebook</p>
        </a>
  

  
    <a href="//www.reddit.com/submit?url=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f&amp;title=A%20simple%20HTTP%20client%20and%20a%20server%20in%20C" target="_blank" rel="noopener" class="nav share-btn reddit">
          <i class="fab fa-reddit-alien"></i><p>&nbsp;Reddit</p>
        </a>
  

  
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f&amp;title=A%20simple%20HTTP%20client%20and%20a%20server%20in%20C" target="_blank" rel="noopener" class="nav share-btn linkedin">
            <i class="fab fa-linkedin"></i><p>&nbsp;LinkedIn</p>
          </a>
  

  
        <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f&amp;description=A%20simple%20HTTP%20client%20and%20a%20server%20in%20C" target="_blank" rel="noopener" class="nav share-btn pinterest">
          <i class="fab fa-pinterest-p"></i><p>&nbsp;Pinterest</p>
        </a>
  

  
        <a href="mailto:?subject=Check%20out%20this%20post%20by Dhanoop%20Bhaskar&amp;body=https%3a%2f%2fdhanoopbhaskar.github.io%2fblog%2f2014-02-13-a-simple-http-client-and-a-server-in-c%2f" target="_blank" class="nav share-btn email" data-proofer-ignore>
          <i class="fas fa-envelope"></i><p>&nbsp;Email</p>
        </a>
  


    </section>
    

    <div class="content">
      <p><em>The HTTP server sends the files requested by the client, if it is available at the server. The HTTP client uses GET method for requesting files from the server. Only .html, .txt and .pdf files are implemented. On receiving the file, the client program opens it using firefox or gedit or acrobat reader, as per the file type. Note that the given programs were done in Linux (Debian) environment.</em></p>
<p><strong>httpserver.c</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">    <span style="color:#75715e">/**httpserver.c**/</span>
    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;stdio.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;stdlib.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;sys/types.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;sys/socket.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;string.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;netinet/in.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;time.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;dirent.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;netdb.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
    <span style="color:#75715e">#define BUF_SIZE 1024
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#define CLADDR_LEN 100
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">createSocket</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> host, <span style="color:#66d9ef">int</span> port);
    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">listenForRequest</span>(<span style="color:#66d9ef">int</span> sockfd);
    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">getFileType</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> file);

    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv) { 
     DIR <span style="color:#f92672">*</span> dirptr;
     FILE <span style="color:#f92672">*</span> fileptr;
     time_t timenow;
     <span style="color:#66d9ef">struct</span> tm <span style="color:#f92672">*</span> timeinfo;
     time (<span style="color:#f92672">&amp;</span>timenow);
     timeinfo <span style="color:#f92672">=</span> localtime(<span style="color:#f92672">&amp;</span>timenow);

     <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> header, <span style="color:#f92672">*</span> request, <span style="color:#f92672">*</span> path, <span style="color:#f92672">*</span> newpath, <span style="color:#f92672">*</span> host;
     <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> dir, <span style="color:#f92672">*</span> temp;
     <span style="color:#66d9ef">int</span> port, sockfd, connfd;
     <span style="color:#66d9ef">char</span> get[<span style="color:#ae81ff">3</span>], http[<span style="color:#ae81ff">9</span>];
     <span style="color:#66d9ef">char</span> filepath[BUF_SIZE];
     <span style="color:#66d9ef">char</span> http_not_found[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;HTTP/1.0 404 Not Found</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
     <span style="color:#66d9ef">char</span> http_ok[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;HTTP/1.0 200 OK</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
     <span style="color:#66d9ef">char</span> buffer[BUF_SIZE];
     <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> contentType;

     <span style="color:#66d9ef">if</span> (argc <span style="color:#f92672">!=</span> <span style="color:#ae81ff">4</span>) {
      printf(<span style="color:#e6db74">&#34;usage: [host] [directory] [portnumber]</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      exit(<span style="color:#ae81ff">1</span>);
     }

     header <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>)malloc(BUF_SIZE<span style="color:#f92672">*</span><span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">char</span>));
     request <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>)malloc(BUF_SIZE<span style="color:#f92672">*</span><span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">char</span>));
     path <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>)malloc(BUF_SIZE<span style="color:#f92672">*</span><span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">char</span>));
     newpath <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>)malloc(BUF_SIZE<span style="color:#f92672">*</span><span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">char</span>));

     host <span style="color:#f92672">=</span> argv[<span style="color:#ae81ff">1</span>];
     dir <span style="color:#f92672">=</span> argv[<span style="color:#ae81ff">2</span>];
     port <span style="color:#f92672">=</span> atoi(argv[<span style="color:#ae81ff">3</span>]);

     <span style="color:#66d9ef">if</span> ((dirptr <span style="color:#f92672">=</span> opendir(dir)) <span style="color:#f92672">==</span> NULL) {
          printf(<span style="color:#e6db74">&#34;Directory Not Found!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
          exit(<span style="color:#ae81ff">1</span>);
     }
     
     sockfd <span style="color:#f92672">=</span> createSocket(host, port);
     
     <span style="color:#66d9ef">for</span> (;;) {
      printf(<span style="color:#e6db74">&#34;--------------------------------------------------------</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      printf(<span style="color:#e6db74">&#34;Waiting for a connection...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      connfd <span style="color:#f92672">=</span> listenForRequest(sockfd);
      <span style="color:#75715e">//gets the request from the connection
</span><span style="color:#75715e"></span>      recv(connfd, request, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">0</span>);
      printf(<span style="color:#e6db74">&#34;Processing request...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      <span style="color:#75715e">//parses request
</span><span style="color:#75715e"></span>      sscanf(request, <span style="color:#e6db74">&#34;%s %s %s&#34;</span>, get, path, http);
      newpath <span style="color:#f92672">=</span> path <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>; <span style="color:#75715e">//ignores the first slash
</span><span style="color:#75715e"></span>        sprintf(filepath,<span style="color:#e6db74">&#34;%s/%s&#34;</span>, dir, newpath);
      contentType <span style="color:#f92672">=</span> getFileType(newpath);
      sprintf(header, <span style="color:#e6db74">&#34;Date: %sHostname: %s:%d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Location: %s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Content-Type: %s</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>, asctime(timeinfo), host, port, newpath, contentType);
      <span style="color:#66d9ef">if</span> ((fileptr <span style="color:#f92672">=</span> fopen(filepath, <span style="color:#e6db74">&#34;r&#34;</span>)) <span style="color:#f92672">==</span> NULL ) {
       printf(<span style="color:#e6db74">&#34;File not found!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
       send(connfd, http_not_found, strlen(http_not_found), <span style="color:#ae81ff">0</span>); <span style="color:#75715e">//sends HTTP 404
</span><span style="color:#75715e"></span>      } <span style="color:#66d9ef">else</span> {
       printf(<span style="color:#e6db74">&#34;Sending the file...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
       send(connfd, http_ok, strlen(http_ok), <span style="color:#ae81ff">0</span>); <span style="color:#75715e">//sends HTTP 200 OK  
</span><span style="color:#75715e"></span>       recv(connfd, buffer, BUF_SIZE, <span style="color:#ae81ff">0</span>);
       <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(buffer, <span style="color:#e6db74">&#34;OK&#34;</span>)) <span style="color:#f92672">==</span> NULL) {
        printf(<span style="color:#e6db74">&#34;Operation aborted by the user!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
        <span style="color:#66d9ef">break</span>;
       }
       send(connfd, header, strlen(header), <span style="color:#ae81ff">0</span>); <span style="color:#75715e">//sends the header
</span><span style="color:#75715e"></span>       recv(connfd, buffer, BUF_SIZE, <span style="color:#ae81ff">0</span>);
       <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(buffer, <span style="color:#e6db74">&#34;OK&#34;</span>)) <span style="color:#f92672">==</span> NULL) {
        printf(<span style="color:#e6db74">&#34;Operation aborted by the user!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
        <span style="color:#66d9ef">break</span>;
       }
       memset(<span style="color:#f92672">&amp;</span>buffer, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(buffer));
       <span style="color:#66d9ef">while</span> (<span style="color:#f92672">!</span>feof(fileptr)) { <span style="color:#75715e">//sends the file
</span><span style="color:#75715e"></span>        fread(<span style="color:#f92672">&amp;</span>buffer, <span style="color:#66d9ef">sizeof</span>(buffer), <span style="color:#ae81ff">1</span>, fileptr);
        send(connfd, buffer, <span style="color:#66d9ef">sizeof</span>(buffer), <span style="color:#ae81ff">0</span>);
        memset(<span style="color:#f92672">&amp;</span>buffer, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(buffer));
       }
       printf(<span style="color:#e6db74">&#34;File sent...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      }
      printf(<span style="color:#e6db74">&#34;Processing completed...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      close(connfd);
     }

     close(sockfd);
     free(header);
     free(request);
     free(path);
     free(newpath);

     <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
    }

    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">createSocket</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> host, <span style="color:#66d9ef">int</span> port) {
     <span style="color:#66d9ef">int</span> sockfd;
     <span style="color:#66d9ef">struct</span> sockaddr_in addr;
     <span style="color:#66d9ef">struct</span> hostent <span style="color:#f92672">*</span> host_ent;
     <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> hostAddr;

     memset(<span style="color:#f92672">&amp;</span>addr, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(addr));
     addr.sin_family <span style="color:#f92672">=</span> AF_INET;
     addr.sin_addr.s_addr <span style="color:#f92672">=</span> INADDR_ANY;
     addr.sin_port <span style="color:#f92672">=</span> htons((<span style="color:#66d9ef">short</span>)port);

     sockfd <span style="color:#f92672">=</span> socket(AF_INET, SOCK_STREAM, <span style="color:#ae81ff">0</span>);
     <span style="color:#66d9ef">if</span> (sockfd <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) {  
      printf(<span style="color:#e6db74">&#34;Error creating socket!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);  
      exit(<span style="color:#ae81ff">1</span>);  
     }  
     printf(<span style="color:#e6db74">&#34;Socket created...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);

     <span style="color:#66d9ef">if</span> (bind(sockfd, (<span style="color:#66d9ef">struct</span> sockaddr <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>addr, <span style="color:#66d9ef">sizeof</span>(addr)) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) {
      printf(<span style="color:#e6db74">&#34;Error binding socket to port!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);  
      exit(<span style="color:#ae81ff">1</span>);
       }
     printf(<span style="color:#e6db74">&#34;Binding done...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);

     <span style="color:#66d9ef">return</span> sockfd;
    }

    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">listenForRequest</span>(<span style="color:#66d9ef">int</span> sockfd) {
     <span style="color:#66d9ef">int</span> conn;
     <span style="color:#66d9ef">char</span> hostip[<span style="color:#ae81ff">32</span>];
     <span style="color:#66d9ef">struct</span> sockaddr_in addr;
     <span style="color:#66d9ef">struct</span> hostent <span style="color:#f92672">*</span> host;
     <span style="color:#66d9ef">struct</span> in_addr inAddr;
     <span style="color:#66d9ef">int</span> len;

     addr.sin_family <span style="color:#f92672">=</span> AF_INET;

     listen(sockfd, <span style="color:#ae81ff">5</span>); <span style="color:#75715e">//maximum 5 connections
</span><span style="color:#75715e"></span>     len <span style="color:#f92672">=</span> <span style="color:#66d9ef">sizeof</span>(addr); 
     <span style="color:#66d9ef">if</span> ((conn <span style="color:#f92672">=</span> accept(sockfd, (<span style="color:#66d9ef">struct</span> sockaddr <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>addr, <span style="color:#f92672">&amp;</span>len)) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) {
      printf(<span style="color:#e6db74">&#34;Error accepting connection!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      exit(<span style="color:#ae81ff">1</span>);
     }
     printf(<span style="color:#e6db74">&#34;Connection accepted...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      
     inet_ntop(AF_INET, <span style="color:#f92672">&amp;</span>(addr.sin_addr), hostip, <span style="color:#ae81ff">32</span>);
     inet_pton(AF_INET, hostip, <span style="color:#f92672">&amp;</span>inAddr);
     host <span style="color:#f92672">=</span> gethostbyaddr(<span style="color:#f92672">&amp;</span>inAddr, <span style="color:#66d9ef">sizeof</span>(inAddr), AF_INET);

     printf(<span style="color:#e6db74">&#34;---Connection received from: %s [IP= %s]---</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, host<span style="color:#f92672">-&gt;</span>h_name, hostip);
     <span style="color:#66d9ef">return</span> conn;
    }

    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">getFileType</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> file) {
     <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> temp;
     <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(file, <span style="color:#e6db74">&#34;.html&#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
      <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;text/html&#34;</span>;
     } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(file, <span style="color:#e6db74">&#34;.pdf&#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
      <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;application/pdf&#34;</span>;
     } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(file, <span style="color:#e6db74">&#34;.txt&#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
      <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;text/html&#34;</span>;
     }
    }</code></pre></div>
<p><strong>httpclient.c</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">     
    <span style="color:#75715e">/**httpclient.c**/</span>
    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;stdio.h&#34;  </span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;stdlib.h&#34;  </span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;sys/types.h&#34;  </span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;sys/socket.h&#34;  </span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;string.h&#34;  </span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;netinet/in.h&#34;  </span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#75715e">#include</span><span style="color:#75715e">&#34;netdb.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>      
    <span style="color:#75715e">#define BUF_SIZE 1024 
</span><span style="color:#75715e"></span>      
    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">get_request</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> url, <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> port);
    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">isValidIP</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> ip);
    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">parseHeader</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> header);
    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">splitKeyValue</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> line, <span style="color:#66d9ef">int</span> index);
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">openFile</span>();

    FILE <span style="color:#f92672">*</span> fileptr;
    <span style="color:#66d9ef">char</span> keys[][<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;Date: &#34;</span>, <span style="color:#e6db74">&#34;Hostname: &#34;</span>, <span style="color:#e6db74">&#34;Location: &#34;</span>, <span style="color:#e6db74">&#34;Content-Type: &#34;</span>};
    <span style="color:#66d9ef">char</span> status[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>};
    <span style="color:#66d9ef">char</span> contentFileType[<span style="color:#ae81ff">100</span>];
    <span style="color:#66d9ef">char</span> path[<span style="color:#ae81ff">1000</span>];

    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span><span style="color:#f92672">**</span>argv) {  
     <span style="color:#66d9ef">struct</span> sockaddr_in addr, cl_addr;  
     <span style="color:#66d9ef">int</span> sockfd, ret; 
     <span style="color:#66d9ef">struct</span> hostent <span style="color:#f92672">*</span> server;
     <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> url, <span style="color:#f92672">*</span> temp;
     <span style="color:#66d9ef">int</span> portNumber;
     <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> fileName;
     <span style="color:#66d9ef">char</span> status_ok[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;OK&#34;</span>;
     <span style="color:#66d9ef">char</span> buffer[BUF_SIZE]; 
     <span style="color:#66d9ef">char</span> http_not_found[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;HTTP/1.0 404 Not Found&#34;</span>;
     <span style="color:#66d9ef">char</span> http_ok[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;HTTP/1.0 200 OK&#34;</span>;
     <span style="color:#66d9ef">char</span> location[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Location: &#34;</span>;
     <span style="color:#66d9ef">char</span> contentType[] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Content-Type: &#34;</span>;
     <span style="color:#66d9ef">int</span> sPos, ePos;

     <span style="color:#66d9ef">if</span> (argc <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>) {
      printf(<span style="color:#e6db74">&#34;usage: [URL] [port number]</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      exit(<span style="color:#ae81ff">1</span>);  
     }

     url <span style="color:#f92672">=</span> argv[<span style="color:#ae81ff">1</span>];
     portNumber <span style="color:#f92672">=</span> atoi(argv[<span style="color:#ae81ff">2</span>]);

     <span style="color:#75715e">//checking the protocol specified
</span><span style="color:#75715e"></span>     <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(url, <span style="color:#e6db74">&#34;http://&#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
      url <span style="color:#f92672">=</span> url <span style="color:#f92672">+</span> <span style="color:#ae81ff">7</span>;
     } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(url, <span style="color:#e6db74">&#34;https://&#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
      url <span style="color:#f92672">=</span> url <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>;
     }

     <span style="color:#75715e">//checking the port number
</span><span style="color:#75715e"></span>     <span style="color:#66d9ef">if</span> (portNumber <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">65536</span> <span style="color:#f92672">||</span> portNumber <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) {
      printf(<span style="color:#e6db74">&#34;Invalid Port Number!&#34;</span>);
      exit(<span style="color:#ae81ff">1</span>);
     }
     
     sockfd <span style="color:#f92672">=</span> get_request(url, argv[<span style="color:#ae81ff">2</span>]); 

     memset(<span style="color:#f92672">&amp;</span>buffer, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(buffer));
     ret <span style="color:#f92672">=</span> recv(sockfd, buffer, BUF_SIZE, <span style="color:#ae81ff">0</span>);  
     <span style="color:#66d9ef">if</span> (ret <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) {  
      printf(<span style="color:#e6db74">&#34;Error receiving HTTP status!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);    
     } <span style="color:#66d9ef">else</span> {
      printf(<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, buffer);
      <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(buffer, http_ok)) <span style="color:#f92672">!=</span> NULL) {
       send(sockfd, status_ok, strlen(status_ok), <span style="color:#ae81ff">0</span>);
      } <span style="color:#66d9ef">else</span> {
       close(sockfd);
       <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
      }
     }

     memset(<span style="color:#f92672">&amp;</span>buffer, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(buffer)); 
     ret <span style="color:#f92672">=</span> recv(sockfd, buffer, BUF_SIZE, <span style="color:#ae81ff">0</span>);  
     <span style="color:#66d9ef">if</span> (ret <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) {  
      printf(<span style="color:#e6db74">&#34;Error receiving HTTP header!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);    
     } <span style="color:#66d9ef">else</span> {
      printf(<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, buffer);
      <span style="color:#66d9ef">if</span> (parseHeader(buffer) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
       send(sockfd, status_ok, strlen(status_ok), <span style="color:#ae81ff">0</span>);
      } <span style="color:#66d9ef">else</span> {
       printf(<span style="color:#e6db74">&#34;Error in HTTP header!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
       close(sockfd);
       <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
      }
     } 

     <span style="color:#75715e">//printf(&#34;file: [%s]\n&#34;, fileName);
</span><span style="color:#75715e"></span>     fileptr <span style="color:#f92672">=</span> fopen(path, <span style="color:#e6db74">&#34;w&#34;</span>);
     <span style="color:#66d9ef">if</span> (fileptr <span style="color:#f92672">==</span> NULL) {
      printf(<span style="color:#e6db74">&#34;Error opening file!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      close(sockfd);
      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
     }

     memset(<span style="color:#f92672">&amp;</span>buffer, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(buffer));
     <span style="color:#66d9ef">while</span> (recv(sockfd, buffer, BUF_SIZE, <span style="color:#ae81ff">0</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) { <span style="color:#75715e">//receives the file
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">if</span> ((strstr(contentFileType, <span style="color:#e6db74">&#34;text/html&#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
       fprintf(fileptr, <span style="color:#e6db74">&#34;%s&#34;</span>, buffer);
      } <span style="color:#66d9ef">else</span> {
       fwrite(<span style="color:#f92672">&amp;</span>buffer, <span style="color:#66d9ef">sizeof</span>(buffer), <span style="color:#ae81ff">1</span>, fileptr);
      }
      memset(<span style="color:#f92672">&amp;</span>buffer, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(buffer));
     }

     fclose(fileptr);
     close(sockfd);

     openFile();

     <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
    }


    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">get_request</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> url, <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> port) {

     <span style="color:#66d9ef">int</span> sockfd, bindfd;
            <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> ptr, <span style="color:#f92672">*</span> host;
     <span style="color:#66d9ef">char</span> getrequest[<span style="color:#ae81ff">1024</span>];
            <span style="color:#66d9ef">struct</span> sockaddr_in addr;

     <span style="color:#66d9ef">if</span> (isValidIP(url)) { <span style="color:#75715e">//when an IP address is given
</span><span style="color:#75715e"></span>      sprintf(getrequest, <span style="color:#e6db74">&#34;GET / HTTP/1.0</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">HOST: %s</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>, url);
            } <span style="color:#66d9ef">else</span> { <span style="color:#75715e">//when a host name is given
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">if</span> ((ptr <span style="color:#f92672">=</span> strstr(url, <span style="color:#e6db74">&#34;/&#34;</span>)) <span style="color:#f92672">==</span> NULL) {
       <span style="color:#75715e">//when hostname does not contain a slash
</span><span style="color:#75715e"></span>       sprintf(getrequest, <span style="color:#e6db74">&#34;GET / HTTP/1.0</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">HOST: %s</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>, url);
      } <span style="color:#66d9ef">else</span> {
       <span style="color:#75715e">//when hostname contains a slash, it is a path to file
</span><span style="color:#75715e"></span>       strcpy(path, ptr);
              host <span style="color:#f92672">=</span> strtok(url, <span style="color:#e6db74">&#34;/&#34;</span>);
       sprintf(getrequest, <span style="color:#e6db74">&#34;GET %s HTTP/1.0</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">HOST: %s</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>, path, url);
      }
     } 

     <span style="color:#75715e">// creates a socket to the host
</span><span style="color:#75715e"></span>     sockfd <span style="color:#f92672">=</span> socket(AF_INET, SOCK_STREAM, <span style="color:#ae81ff">0</span>);
     <span style="color:#66d9ef">if</span> (sockfd <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>) {  
      printf(<span style="color:#e6db74">&#34;Error creating socket!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);  
      exit(<span style="color:#ae81ff">1</span>);  
     }  
     printf(<span style="color:#e6db74">&#34;Socket created...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);

     memset(<span style="color:#f92672">&amp;</span>addr, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(addr));  
     addr.sin_family <span style="color:#f92672">=</span> AF_INET;  
     addr.sin_addr.s_addr <span style="color:#f92672">=</span> inet_addr(url);
     addr.sin_port <span style="color:#f92672">=</span> htons(atoi(port));

     <span style="color:#66d9ef">if</span> (connect(sockfd, (<span style="color:#66d9ef">struct</span> sockaddr <span style="color:#f92672">*</span>) <span style="color:#f92672">&amp;</span>addr, <span style="color:#66d9ef">sizeof</span>(addr)) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> ) {
      printf(<span style="color:#e6db74">&#34;Connection Error!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      exit(<span style="color:#ae81ff">1</span>);
     }
     printf(<span style="color:#e6db74">&#34;Connection successful...</span><span style="color:#ae81ff">\n\n\n</span><span style="color:#e6db74">&#34;</span>);
     ptr <span style="color:#f92672">=</span> strtok(path, <span style="color:#e6db74">&#34;/&#34;</span>);
     strcpy(path, ptr);
     <span style="color:#75715e">//printf(&#34;path=%s\n&#34;, path); 
</span><span style="color:#75715e"></span>     <span style="color:#75715e">//fileptr = fopen(path, &#34;w&#34;);
</span><span style="color:#75715e"></span>     <span style="color:#75715e">//strcpy(fileName, path);
</span><span style="color:#75715e"></span>     <span style="color:#75715e">//sprintf(fileName, &#34;%s&#34;, path);
</span><span style="color:#75715e"></span>
            <span style="color:#75715e">//int optval = 1;
</span><span style="color:#75715e"></span>            <span style="color:#75715e">//setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;optval, sizeof optval);
</span><span style="color:#75715e"></span>
     <span style="color:#75715e">// writes the HTTP GET Request to the sockfd
</span><span style="color:#75715e"></span>     write(sockfd, getrequest, strlen(getrequest));

     <span style="color:#66d9ef">return</span> sockfd;
    }


    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">isValidIP</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> ip) {
     <span style="color:#66d9ef">struct</span> sockaddr_in addr;
     <span style="color:#66d9ef">int</span> valid <span style="color:#f92672">=</span> inet_pton(AF_INET, ip, <span style="color:#f92672">&amp;</span>(addr.sin_addr));
     <span style="color:#66d9ef">return</span> valid <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>;
    }


    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">parseHeader</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> header) {
     <span style="color:#75715e">//&#34;Date: %sHostname: %s:%d\nLocation: %s\nContent-Type: %s\n\n&#34;
</span><span style="color:#75715e"></span>     <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> line, <span style="color:#f92672">*</span> key, <span style="color:#f92672">*</span> value;
     <span style="color:#66d9ef">char</span> temp[<span style="color:#ae81ff">100</span>];
     <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
     line <span style="color:#f92672">=</span> strtok(header, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
     <span style="color:#66d9ef">while</span> (line <span style="color:#f92672">!=</span> NULL) {
      <span style="color:#75715e">//printf(&#34;%s\n&#34;, line);
</span><span style="color:#75715e"></span>      strcpy(temp, line);
      value <span style="color:#f92672">=</span> splitKeyValue(line, i);  
      <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>) {   
       strcpy(contentFileType, value);
      }
      <span style="color:#75715e">//printf(&#34;value=%s\n&#34;, value);
</span><span style="color:#75715e"></span>      line <span style="color:#f92672">=</span> strtok(NULL, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
      i<span style="color:#f92672">++</span>; 
     }
     <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>; i<span style="color:#f92672">++</span>) {
      <span style="color:#66d9ef">if</span> (status[i] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>;
      <span style="color:#75715e">//printf(&#34;status[%d]=%d\n&#34;, i, status[i]);
</span><span style="color:#75715e"></span>     }
     <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
    }

    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">splitKeyValue</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> line, <span style="color:#66d9ef">int</span> index) {
     <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> temp;
     <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(line, keys[index])) <span style="color:#f92672">!=</span> NULL) {
      temp <span style="color:#f92672">=</span> temp <span style="color:#f92672">+</span> strlen(keys[index]);
      status[index] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
     }
     <span style="color:#66d9ef">return</span> temp;
    }

    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">openFile</span>() {
     <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> temp;
     <span style="color:#66d9ef">char</span> command[<span style="color:#ae81ff">100</span>];
     <span style="color:#66d9ef">char</span> fileName[<span style="color:#ae81ff">1000</span>];
     strcpy(fileName, path);
     <span style="color:#75715e">//printf(&#34;File Name: %s\n&#34;, fileName);
</span><span style="color:#75715e"></span>     <span style="color:#75715e">//printf(&#34;Content Type: %s\n&#34;, contentFileType);
</span><span style="color:#75715e"></span>     <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(contentFileType, <span style="color:#e6db74">&#34;text/html&#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
      <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(fileName, <span style="color:#e6db74">&#34;.txt&#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
       sprintf(command, <span style="color:#e6db74">&#34;gedit %s&#34;</span>, fileName);
      } <span style="color:#66d9ef">else</span> {
       sprintf(command, <span style="color:#e6db74">&#34;firefox %s&#34;</span>, fileName);
      }
      system(command);
     } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> ((temp <span style="color:#f92672">=</span> strstr(contentFileType, <span style="color:#e6db74">&#34;application/pdf&#34;</span>)) <span style="color:#f92672">!=</span> NULL) {
      sprintf(command, <span style="color:#e6db74">&#34;acroread %s&#34;</span>, fileName);
      system(command);
     } <span style="color:#66d9ef">else</span> {
      printf(<span style="color:#e6db74">&#34;The filetype %s is not supported. Failed to open %s!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, contentFileType, fileName);
     }
    }</code></pre></div>
<p><strong>Execution:</strong></p>
<p>(terminal 1)</p>
<pre><code>gcc httpserver.c -o server 
./server 'www.dhanoop.com' '/home/dhanoopbhaskar/coding/http/dir/' 4444 
</code></pre>
<p>(terminal 2)</p>
<pre><code>gcc httpclient.c -o client 
./client '192.168.0.6/abc.txt' 4444 
./client '192.168.0.6/abc.html' 4444 
./client '192.168.0.6/abc.pdf' 4444
</code></pre>
<p><em>NB: The requested files abc.txt, abc.html and abc.pdf should be present in the path <code>/home/dhanoopbhaskar/coding/http/dir/</code> (or whatever is given while running server).</em></p>

    </div>
    <footer>
      <ul class="stats">
  <li class="categories">
    <ul>
    
      
        
          <li><a class="article-terms-link" href="/categories/gcc/">gcc</a></li>
        
          <li><a class="article-terms-link" href="/categories/c/">C</a></li>
        
      
    
    </ul>
  </li>
  <li class="tags">
    <ul>
    
      
        
          <li><a class="article-terms-link" href="/tags/gcc/">gcc</a></li>
        
          <li><a class="article-terms-link" href="/tags/http/">http</a></li>
        
          <li><a class="article-terms-link" href="/tags/linux/">linux</a></li>
        
          <li><a class="article-terms-link" href="/tags/c/cpp/">C/CPP</a></li>
        
          <li><a class="article-terms-link" href="/tags/socket/">socket</a></li>
        
          <li><a class="article-terms-link" href="/tags/tcp/">tcp</a></li>
        
          <li><a class="article-terms-link" href="/tags/network/">network</a></li>
        
      
    
    </ul>
  </li>
</ul>

    </footer>
  </article>
  
  <article class="post">
    
<div>
  <h2>Say something</h2>
    <form id="post-js-form" class="post-new-comment" method="POST">
      
      <h5 class='post-reply-notice hidden'>
        <span class='post-reply-arrow'></span><span class='post-reply-name'></span>
      </h5>

      
      <input type="hidden" name="options[entryId]" value="5fd2acc7f6388bda086bcfd0e4040721">
      <input type='hidden' name='fields[replyThread]' value=''>
      <input type='hidden' name='fields[replyID]' value=''>
      <input type='hidden' name='fields[replyName]' value=''>

      
      <input required name='fields[name]' type='text' placeholder='Your name (Required)'>
      <input name='fields[website]' type='text' placeholder='Your website'>
      <input required name='fields[email]' type='email' placeholder='Your email address (Required for Gravatar)'>
      <textarea required name='fields[body]' placeholder='Your message. Feel free to use Markdown (Google &#39;Markdown Cheat Sheet&#39;).' rows='10'></textarea>

      
      

      
      <p class='post-submit-notice'>
        <strong class='post-submit-notice-text submit-success hidden'>Thanks for your comment! It will be shown on the site once it has been approved.</strong>
        <strong class='post-submit-notice-text submit-failed hidden'>Sorry, there was an error with your submission.  Please make sure all required fields have been completed and try again.</strong>
      </p>

      
      <input type='submit' value='Submit' class='button'>
      <input type='submit' value='Submitted' class='hidden button' disabled>
      <input type='reset' value='Reset' class='button'>
    </form>
</div>


<div>
  <h2>Comments</h2>

  
</div>

  </article>


  <div class="pagination">
  
    <a href="/blog/2014-01-22-a-simple-chat-program-in-c-tcp/" class="button"><div class="previous"><div>A simple chat program in C (TCP)</div></div></a>
  
  
    <a href="/blog/2014-04-05-java-encryption-and-decryption-of-an-image-using-blowfish-algorithm-using-password/" class="button"><div class="next"><div>Java - Encryption and Decryption of an Image Using Blowfish Algorithm (using password)</div></div></a>
  
</div>


      </main>
      <section id="site-sidebar">
  
    <section id="recent-posts">
      <header>
        <h1>Recent posts</h1>
      </header>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h2><a href="/blog/2020-05-07-ros-in-docker-container/">ROS In Docker Container</a></h2>
          <time class="published" datetime="">May 7, 2020</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h2><a href="/blog/2020-05-07-working-with-python-3-in-ros-kinetic-or-melodic/">Working With Python 3 In ROS Kinetic Or Melodic</a></h2>
          <time class="published" datetime="">May 7, 2020</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h2><a href="/blog/2019-10-28-biped-walking-robot/">Biped Walking Robot</a></h2>
          <time class="published" datetime="">October 28, 2019</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h2><a href="/blog/2019-10-28-robotic-arm/">Robotic Arm</a></h2>
          <time class="published" datetime="">October 28, 2019</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h2><a href="/blog/2019-10-28-7-robots-in-6-days/">7 Robots in 6 Days</a></h2>
          <time class="published" datetime="">October 28, 2019</time>
        </header>
      </article>
      
      
        <footer>
          <a href="/blog/" class="button">See more</a>
        </footer>
      
    </section>
  

  
    
      <section id="categories">
        <header>
          <h1><a href="/categories">Categories</a></h1>
        </header>
        <ul>
          
            
          
          
          <li>
            
              <a href="/categories/java/">java<span class="count">9</span></a>
            
          
          <li>
            
              <a href="/categories/c/">c<span class="count">7</span></a>
            
          
          <li>
            
              <a href="/categories/gcc/">gcc<span class="count">7</span></a>
            
          
          <li>
            
              <a href="/categories/crypto/">crypto<span class="count">6</span></a>
            
          
          <li>
            
              <a href="/categories/cryptography/">cryptography<span class="count">6</span></a>
            
          
          <li>
            
              <a href="/categories/decryption/">decryption<span class="count">6</span></a>
            
          
          <li>
            
              <a href="/categories/encryption/">encryption<span class="count">6</span></a>
            
          
          <li>
            
              <a href="/categories/arduino/">arduino<span class="count">3</span></a>
            
          
          <li>
            
              <a href="/categories/robotics/">robotics<span class="count">3</span></a>
            
          
          <li>
            
              <a href="/categories/aes-algorithm/">aes-algorithm<span class="count">2</span></a>
            
          
          <li>
            
              <a href="/categories/blowfish-algorithm/">blowfish-algorithm<span class="count">2</span></a>
            
          
          <li>
            
              <a href="/categories/des-algorithm/">des-algorithm<span class="count">2</span></a>
            
          
          <li>
            
              <a href="/categories/linux/">linux<span class="count">2</span></a>
            
          
          <li>
            
              <a href="/categories/python/">python<span class="count">2</span></a>
            
          
          <li>
            
              <a href="/categories/ros/">ros<span class="count">2</span></a>
            
          
          <li>
            
              <a href="/categories/docker/">docker<span class="count">1</span></a>
            
          
          <li>
            
              <a href="/categories/gratitude/">gratitude<span class="count">1</span></a>
            
          
          <li>
            
              <a href="/categories/iphone/">iphone<span class="count">1</span></a>
            
          
          <li>
            
              <a href="/categories/mysql/">mysql<span class="count">1</span></a>
            
          
          <li>
            
              <a href="/categories/phpmyadmin/">phpmyadmin<span class="count">1</span></a>
            
          
          <li>
            
              <a href="/categories/rest/">rest<span class="count">1</span></a>
            
          
          <li>
            
              <a href="/categories/software-engineering/">software-engineering<span class="count">1</span></a>
            
          
          <li>
            
              <a href="/categories/web-services/">web-services<span class="count">1</span></a>
            
          
          </li>
        </ul>
      </section>
    
  

  
    <section id="mini-bio">
      <header>
        <h1>About</h1>
      </header>
      <p>A technical blog which covers mainly Java technologies. Other programming languages are also covered.</p>
      <footer>
        <a href="/about" class="button">Learn More</a>
      </footer>
    </section>
  
</section>

      <footer id="site-footer">
  
      <ul class="socnet-icons">
        

        <li><a href="//github.com/dhanoopbhaskar" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>


<li><a href="//bitbucket.com/dhanoopbhaskar" target="_blank" rel="noopener" title="Bitbucket" class="fab fa-bitbucket"></a></li>






<li><a href="//theinsanetechie.wordpress.com" target="_blank" rel="noopener" title="WordPress" class="fab fa-wordpress"></a></li>

<li><a href="//linkedin.com/in/dhanoopbhaskar" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a></li>




<li><a href="//facebook.com/dhanoopbhaskar" target="_blank" rel="noopener" title="Facebook" class="fab fa-facebook"></a></li>

<li><a href="//quora.com/profile/dhanoopbhaskar" target="_blank" rel="noopener" title="Quora" class="fab fa-quora"></a></li>
<li><a href="//youtube.com/dhanoopbhaskar" target="_blank" rel="noopener" title="YouTube" class="fab fa-youtube"></a></li>





<li><a href="//instagram.com/dhanoopbhaskar" target="_blank" rel="noopener" title="Instagram" class="fab fa-instagram"></a></li>

<li><a href="//twitter.com/dhanoopbhaskar" target="_blank" rel="noopener" title="Twitter" class="fab fa-twitter"></a></li>

<li><a href="skype:dhanoopbhaskar?userinfo" target="_blank" rel="noopener" title="Skype" class="fab fa-skype"></a></li>









<li><a href="mailto:dhanoopbhaskar@gmail.com" target="_blank" title="Email" class="far fa-envelope"></a></li>

      </ul>
  
  <p class="copyright">
    
      &copy; 2020
      
        The Insane Techie
      
    . <br>
    Theme: <a href='https://github.com/pacollins/hugo-future-imperfect-slim' target='_blank' rel='noopener'>Hugo Future Imperfect Slim</a><br>A <a href='https://html5up.net/future-imperfect' target='_blank' rel='noopener'>HTML5 UP port</a> | Powered by <a href='https://gohugo.io/' title='0.72.0' target='_blank' rel='noopener'>Hugo</a>
  </p>
</footer>
<a id="back-to-top" href="#" class="fas fa-arrow-up fa-2x"></a>

      <script src="/js/highlight.js"></script>
    <script>hljs.initHighlightingOnLoad();</script><script src="/js/bundle.min.5d79af27975749c3227a49c2927464145e6336cb82149e8919f5014d0d3a3982.js" integrity="sha256-XXmvJ5dXScMieknCknRkFF5jNsuCFJ6JGfUBTQ06OYI="></script>
    <script src="/js/add-on.js"></script>
    </div>
  </body>
</html>
