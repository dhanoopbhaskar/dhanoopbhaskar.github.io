<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  AES Implementation In Java with ECB | CBC | OFB | CFB Modes Of Operation · The Insane Techie
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Dhanoop Bhaskar">
<meta name="description" content="Note that these are ONLY basic level programs for easy understanding
of the Advanced Encryption Standard (AES) algorithm
Key Generation - AESkeygen.java
    import java.io.File;
    import java.io.FileWriter;

    public class AESkeygen {

        private final File file = new File(&#34;AESkey.txt&#34;);
        private final int KEY_LENGTH = 32;
        private final static char[] hexArray = &#34;0123456789ABCDEF&#34;.toCharArray();

        public AESkeygen() {
            try {
                FileWriter fileWriter = new FileWriter(file);
                fileWriter.write(&#34;&#34;);
                for (int i = 0; i &lt; KEY_LENGTH; i&#43;&#43;) {
                    double random = Math.random();
                    int index = (int) (random * 16);
                    fileWriter.append(hexArray[index]);
                    fileWriter.flush();
                }
                fileWriter.close();
                System.out.println(&#34;Key generated and saved in &#34; &#43; file.getName());
            } catch (Exception exp) {
                exp.printStackTrace();
            }
        }

        public static void main(String[] args) {
            new AESkeygen();
        }

    }
Word.java">
<meta name="keywords" content="">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="AES Implementation In Java with ECB | CBC | OFB | CFB Modes Of Operation">
  <meta name="twitter:description" content="Note that these are ONLY basic level programs for easy understanding of the Advanced Encryption Standard (AES) algorithm
Key Generation - AESkeygen.java
import java.io.File; import java.io.FileWriter; public class AESkeygen { private final File file = new File(&#34;AESkey.txt&#34;); private final int KEY_LENGTH = 32; private final static char[] hexArray = &#34;0123456789ABCDEF&#34;.toCharArray(); public AESkeygen() { try { FileWriter fileWriter = new FileWriter(file); fileWriter.write(&#34;&#34;); for (int i = 0; i &lt; KEY_LENGTH; i&#43;&#43;) { double random = Math.random(); int index = (int) (random * 16); fileWriter.append(hexArray[index]); fileWriter.flush(); } fileWriter.close(); System.out.println(&#34;Key generated and saved in &#34; &#43; file.getName()); } catch (Exception exp) { exp.printStackTrace(); } } public static void main(String[] args) { new AESkeygen(); } } Word.java">

<meta property="og:url" content="https://dhanoopbhaskar.github.io/posts/2014-07-30-aes-implementation-in-java-with-ecb-cbc-ofb-cfb-modes-of-operation/">
  <meta property="og:site_name" content="The Insane Techie">
  <meta property="og:title" content="AES Implementation In Java with ECB | CBC | OFB | CFB Modes Of Operation">
  <meta property="og:description" content="Note that these are ONLY basic level programs for easy understanding of the Advanced Encryption Standard (AES) algorithm
Key Generation - AESkeygen.java
import java.io.File; import java.io.FileWriter; public class AESkeygen { private final File file = new File(&#34;AESkey.txt&#34;); private final int KEY_LENGTH = 32; private final static char[] hexArray = &#34;0123456789ABCDEF&#34;.toCharArray(); public AESkeygen() { try { FileWriter fileWriter = new FileWriter(file); fileWriter.write(&#34;&#34;); for (int i = 0; i &lt; KEY_LENGTH; i&#43;&#43;) { double random = Math.random(); int index = (int) (random * 16); fileWriter.append(hexArray[index]); fileWriter.flush(); } fileWriter.close(); System.out.println(&#34;Key generated and saved in &#34; &#43; file.getName()); } catch (Exception exp) { exp.printStackTrace(); } } public static void main(String[] args) { new AESkeygen(); } } Word.java">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2014-07-30T23:19:00+05:30">
    <meta property="article:modified_time" content="2014-07-30T23:19:00+05:30">
    <meta property="article:tag" content="Aes Algorithm">
    <meta property="article:tag" content="Encryption">
    <meta property="article:tag" content="Crypto">
    <meta property="article:tag" content="Decryption">
    <meta property="article:tag" content="Cryptography">
    <meta property="article:tag" content="Java">




<link rel="canonical" href="https://dhanoopbhaskar.github.io/posts/2014-07-30-aes-implementation-in-java-with-ecb-cbc-ofb-cfb-modes-of-operation/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.7763f8bc6341ecf82378e867c285e1549abb063a899be313ccd25dbfcd24fa7d.css" integrity="sha256-d2P4vGNB7PgjeOhnwoXhVJq7BjqJm&#43;MTzNJdv80k&#43;n0=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://dhanoopbhaskar.github.io/">
      The Insane Techie
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Posts</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/pencils/">Pencils</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/">Categories</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://dhanoopbhaskar.github.io/posts/2014-07-30-aes-implementation-in-java-with-ecb-cbc-ofb-cfb-modes-of-operation/">
              AES Implementation In Java with ECB | CBC | OFB | CFB Modes Of Operation
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2014-07-30T23:19:00&#43;05:30">
                July 30, 2014
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              32-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/aes-algorithm/">Aes Algorithm</a>
      <span class="separator">•</span>
    <a href="/categories/cryptography/">Cryptography</a>
      <span class="separator">•</span>
    <a href="/categories/java/">Java</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/aes-algorithm/">Aes Algorithm</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/encryption/">Encryption</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/crypto/">Crypto</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/decryption/">Decryption</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/cryptography/">Cryptography</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/java/">Java</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p><em><strong>Note that these are ONLY basic level programs for easy understanding
of the Advanced Encryption Standard (AES) algorithm</strong></em></p>
<p><strong>Key Generation - AESkeygen.java</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.File;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileWriter;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AESkeygen</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> File file <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;AESkey.txt&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> KEY_LENGTH <span style="color:#f92672">=</span> 32;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> hexArray <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0123456789ABCDEF&#34;</span>.<span style="color:#a6e22e">toCharArray</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">AESkeygen</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                FileWriter fileWriter <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileWriter(file);
</span></span><span style="display:flex;"><span>                fileWriter.<span style="color:#a6e22e">write</span>(<span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> KEY_LENGTH; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">double</span> random <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">random</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">int</span> index <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>) (random <span style="color:#f92672">*</span> 16);
</span></span><span style="display:flex;"><span>                    fileWriter.<span style="color:#a6e22e">append</span>(hexArray<span style="color:#f92672">[</span>index<span style="color:#f92672">]</span>);
</span></span><span style="display:flex;"><span>                    fileWriter.<span style="color:#a6e22e">flush</span>();
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                fileWriter.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Key generated and saved in &#34;</span> <span style="color:#f92672">+</span> file.<span style="color:#a6e22e">getName</span>());
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (Exception exp) {
</span></span><span style="display:flex;"><span>                exp.<span style="color:#a6e22e">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> AESkeygen();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p><strong>Word.java</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Word</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> word <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Word</span>() {
</span></span><span style="display:flex;"><span>            word <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Word</span>(<span style="color:#66d9ef">byte</span> k0, <span style="color:#66d9ef">byte</span> k1, <span style="color:#66d9ef">byte</span> k2, <span style="color:#66d9ef">byte</span> k3) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>();
</span></span><span style="display:flex;"><span>            word<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> k0;
</span></span><span style="display:flex;"><span>            word<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> k1;
</span></span><span style="display:flex;"><span>            word<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> k2;
</span></span><span style="display:flex;"><span>            word<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> k3;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getWord</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> word;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setWord</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> word) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">word</span> <span style="color:#f92672">=</span> word;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">wordToBytes</span>(Word word) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> word.<span style="color:#a6e22e">getWord</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">wordsToBytes</span>(Word<span style="color:#f92672">[]</span> words) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> words.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> words.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> words<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>.<span style="color:#a6e22e">getWord</span>();
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> temp<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> temp<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> temp<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> temp<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">rotWord</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getWord</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> newWord <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            newWord<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> temp<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            newWord<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> temp<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            newWord<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> temp<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            newWord<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> temp<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">setWord</span>(newWord);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">subWord</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getWord</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span> a <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> row <span style="color:#f92672">=</span> (a <span style="color:#f92672">&gt;&gt;</span> 4) <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> col <span style="color:#f92672">=</span> a <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) AESencrypt.<span style="color:#a6e22e">sBox</span><span style="color:#f92672">[</span>row <span style="color:#f92672">*</span> 16 <span style="color:#f92672">+</span> col<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">word</span><span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Word <span style="color:#a6e22e">XORWords</span>(Word word1, Word word2) {
</span></span><span style="display:flex;"><span>            Word outWord <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in1 <span style="color:#f92672">=</span> word1.<span style="color:#a6e22e">getWord</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in2 <span style="color:#f92672">=</span> word2.<span style="color:#a6e22e">getWord</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((in1<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in2<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            outWord.<span style="color:#a6e22e">setWord</span>(out);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> outWord;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">toString</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> AESencrypt.<span style="color:#a6e22e">bytesToHex</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getWord</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  </span></span></code></pre></div>
<p><strong>Encryption - AESencrypt.java</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.BufferedReader;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.File;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileInputStream;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileOutputStream;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileReader;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.util.Arrays;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AESencrypt</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> BITS <span style="color:#f92672">=</span> 16;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> ROUNDS <span style="color:#f92672">=</span> 10;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> NO_OF_WORDS_IN_KEY <span style="color:#f92672">=</span> 44;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> KEY_LENGTH <span style="color:#f92672">=</span> 16;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> BLOCK_LENGTH <span style="color:#f92672">=</span> 16;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> hexArray <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0123456789ABCDEF&#34;</span>.<span style="color:#a6e22e">toCharArray</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> RC <span style="color:#f92672">=</span> { 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1B, 0x36 };
</span></span><span style="display:flex;"><span>        Word<span style="color:#f92672">[]</span> Rcon <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word<span style="color:#f92672">[</span>ROUNDS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> word <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> String mode <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> sBox <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76,
</span></span><span style="display:flex;"><span>          0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0,
</span></span><span style="display:flex;"><span>          0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15,
</span></span><span style="display:flex;"><span>          0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75,
</span></span><span style="display:flex;"><span>          0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84,
</span></span><span style="display:flex;"><span>          0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf,
</span></span><span style="display:flex;"><span>          0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8,
</span></span><span style="display:flex;"><span>          0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2,
</span></span><span style="display:flex;"><span>          0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73,
</span></span><span style="display:flex;"><span>          0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb,
</span></span><span style="display:flex;"><span>          0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79,
</span></span><span style="display:flex;"><span>          0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08,
</span></span><span style="display:flex;"><span>          0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a,
</span></span><span style="display:flex;"><span>          0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e,
</span></span><span style="display:flex;"><span>          0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf,
</span></span><span style="display:flex;"><span>          0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>          
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> invSBox <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          0x52, 0x09, 0x6a, 0xd5, 0x30, 0x36, 0xa5, 0x38, 0xbf, 0x40, 0xa3, 0x9e, 0x81, 0xf3, 0xd7, 0xfb,
</span></span><span style="display:flex;"><span>          0x7c, 0xe3, 0x39, 0x82, 0x9b, 0x2f, 0xff, 0x87, 0x34, 0x8e, 0x43, 0x44, 0xc4, 0xde, 0xe9, 0xcb,
</span></span><span style="display:flex;"><span>          0x54, 0x7b, 0x94, 0x32, 0xa6, 0xc2, 0x23, 0x3d, 0xee, 0x4c, 0x95, 0x0b, 0x42, 0xfa, 0xc3, 0x4e,
</span></span><span style="display:flex;"><span>          0x08, 0x2e, 0xa1, 0x66, 0x28, 0xd9, 0x24, 0xb2, 0x76, 0x5b, 0xa2, 0x49, 0x6d, 0x8b, 0xd1, 0x25, 
</span></span><span style="display:flex;"><span>          0x72, 0xf8, 0xf6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xd4, 0xa4, 0x5c, 0xcc, 0x5d, 0x65, 0xb6, 0x92, 
</span></span><span style="display:flex;"><span>          0x6c, 0x70, 0x48, 0x50, 0xfd, 0xed, 0xb9, 0xda, 0x5e, 0x15, 0x46, 0x57, 0xa7, 0x8d, 0x9d, 0x84, 
</span></span><span style="display:flex;"><span>          0x90, 0xd8, 0xab, 0x00, 0x8c, 0xbc, 0xd3, 0x0a, 0xf7, 0xe4, 0x58, 0x05, 0xb8, 0xb3, 0x45, 0x06, 
</span></span><span style="display:flex;"><span>          0xd0, 0x2c, 0x1e, 0x8f, 0xca, 0x3f, 0x0f, 0x02, 0xc1, 0xaf, 0xbd, 0x03, 0x01, 0x13, 0x8a, 0x6b, 
</span></span><span style="display:flex;"><span>          0x3a, 0x91, 0x11, 0x41, 0x4f, 0x67, 0xdc, 0xea, 0x97, 0xf2, 0xcf, 0xce, 0xf0, 0xb4, 0xe6, 0x73, 
</span></span><span style="display:flex;"><span>          0x96, 0xac, 0x74, 0x22, 0xe7, 0xad, 0x35, 0x85, 0xe2, 0xf9, 0x37, 0xe8, 0x1c, 0x75, 0xdf, 0x6e, 
</span></span><span style="display:flex;"><span>          0x47, 0xf1, 0x1a, 0x71, 0x1d, 0x29, 0xc5, 0x89, 0x6f, 0xb7, 0x62, 0x0e, 0xaa, 0x18, 0xbe, 0x1b, 
</span></span><span style="display:flex;"><span>          0xfc, 0x56, 0x3e, 0x4b, 0xc6, 0xd2, 0x79, 0x20, 0x9a, 0xdb, 0xc0, 0xfe, 0x78, 0xcd, 0x5a, 0xf4, 
</span></span><span style="display:flex;"><span>          0x1f, 0xdd, 0xa8, 0x33, 0x88, 0x07, 0xc7, 0x31, 0xb1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xec, 0x5f, 
</span></span><span style="display:flex;"><span>          0x60, 0x51, 0x7f, 0xa9, 0x19, 0xb5, 0x4a, 0x0d, 0x2d, 0xe5, 0x7a, 0x9f, 0x93, 0xc9, 0x9c, 0xef, 
</span></span><span style="display:flex;"><span>          0xa0, 0xe0, 0x3b, 0x4d, 0xae, 0x2a, 0xf5, 0xb0, 0xc8, 0xeb, 0xbb, 0x3c, 0x83, 0x53, 0x99, 0x61, 
</span></span><span style="display:flex;"><span>          0x17, 0x2b, 0x04, 0x7e, 0xba, 0x77, 0xd6, 0x26, 0xe1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0c, 0x7d
</span></span><span style="display:flex;"><span>        };                   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">AESencrypt</span>(String mode) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">mode</span> <span style="color:#f92672">=</span> mode;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> ROUNDS; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                Rcon<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word();
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                temp<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (RC<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                temp<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                temp<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                temp<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                Rcon<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>.<span style="color:#a6e22e">setWord</span>(temp);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            word <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>NO_OF_WORDS_IN_KEY<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Ref: http://www.samiam.org/galois.html */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Galois Addition */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span> <span style="color:#a6e22e">gadd</span>(<span style="color:#66d9ef">byte</span> a, <span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">byte</span>) ((a <span style="color:#f92672">^</span> b) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Galois Subtraction */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span> <span style="color:#a6e22e">gsub</span>(<span style="color:#66d9ef">byte</span> a, <span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">byte</span>) ((a <span style="color:#f92672">^</span> b) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Galois Multiplication */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span> <span style="color:#a6e22e">gmul</span>(<span style="color:#66d9ef">byte</span> a, <span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> p <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> counter;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> high_bit_set;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> byte0x80 <span style="color:#f92672">=</span> hexStringToByteArray(<span style="color:#e6db74">&#34;80&#34;</span>)<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (counter <span style="color:#f92672">=</span> 0; counter <span style="color:#f92672">&lt;</span> 8; counter<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> ((b <span style="color:#f92672">&amp;</span> 0x01) <span style="color:#f92672">==</span> 1) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// System.out.println(&#34;lower bit of b is set&#34;);</span>
</span></span><span style="display:flex;"><span>                    p <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((p <span style="color:#f92672">^</span> a) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                high_bit_set <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (a <span style="color:#f92672">&amp;</span> 0x80);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printByte(&#34;high_bit_set&#34;, high_bit_set);</span>
</span></span><span style="display:flex;"><span>                a <span style="color:#f92672">&lt;&lt;=</span> 1;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (high_bit_set <span style="color:#f92672">==</span> byte0x80) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// System.out.println(&#34;higher bit of a is set&#34;);</span>
</span></span><span style="display:flex;"><span>                    a <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((a <span style="color:#f92672">^</span> 0x1b) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                b <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((b <span style="color:#f92672">&gt;&gt;</span> 1) <span style="color:#f92672">&amp;</span> 0x7f);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printByte(&#34;a&#34;, a);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printByte(&#34;b&#34;, b);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printByte(&#34;p&#34;, p);</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> p;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span> <span style="color:#a6e22e">gmul</span>(<span style="color:#66d9ef">byte</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> t <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (b <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> gmul(a, t);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Key Expansion */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">expandKey</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(key.length);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(bytesToHex(key));</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (key.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> KEY_LENGTH) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Exception(<span style="color:#e6db74">&#34;Key should be of length, 128 bits&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            Word<span style="color:#f92672">[]</span> w <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word<span style="color:#f92672">[</span>NO_OF_WORDS_IN_KEY<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            Word temp;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                w<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word(key<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i<span style="color:#f92672">]</span>, key<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span>, key<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 2<span style="color:#f92672">]</span>, key<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 3<span style="color:#f92672">]</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;w&#34; + i + &#34; = &#34; + w[i]);</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 4; i <span style="color:#f92672">&lt;</span> 44; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                temp <span style="color:#f92672">=</span> w<span style="color:#f92672">[</span>i <span style="color:#f92672">-</span> 1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                Word temp1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word();
</span></span><span style="display:flex;"><span>                temp1.<span style="color:#a6e22e">setWord</span>(temp.<span style="color:#a6e22e">getWord</span>());
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;w&#34; + (i-1) + &#34; = &#34; + temp);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">%</span> 4 <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>                    temp1.<span style="color:#a6e22e">rotWord</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// System.out.println(&#34;Rot=&#34; + temp1);</span>
</span></span><span style="display:flex;"><span>                    temp1.<span style="color:#a6e22e">subWord</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// System.out.println(&#34;Sub=&#34; + temp1);</span>
</span></span><span style="display:flex;"><span>                    temp1 <span style="color:#f92672">=</span> Word.<span style="color:#a6e22e">XORWords</span>(temp1, Rcon<span style="color:#f92672">[</span>(i <span style="color:#f92672">/</span> 4) <span style="color:#f92672">-</span> 1<span style="color:#f92672">]</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// System.out.println(&#34;Rcon&#34; + temp1);</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                w<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> Word.<span style="color:#a6e22e">XORWords</span>(w<span style="color:#f92672">[</span>i <span style="color:#f92672">-</span> 4<span style="color:#f92672">]</span>, temp1);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;w&#34; + i + &#34; = &#34; + w[i]);</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> Word.<span style="color:#a6e22e">wordsToBytes</span>(w);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Substitute Bytes */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">subBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span> a <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> row <span style="color:#f92672">=</span> (a <span style="color:#f92672">&gt;&gt;</span> 4) <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> col <span style="color:#f92672">=</span> a <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) sBox<span style="color:#f92672">[</span>row <span style="color:#f92672">*</span> BITS <span style="color:#f92672">+</span> col<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Inverse Substitute Bytes */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">inverseSubBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span> a <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> row <span style="color:#f92672">=</span> (a <span style="color:#f92672">&gt;&gt;</span> 4) <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> col <span style="color:#f92672">=</span> a <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) invSBox<span style="color:#f92672">[</span>row <span style="color:#f92672">*</span> BITS <span style="color:#f92672">+</span> col<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Shift Rows */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">shiftRows</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;temp: &#34; + bytesToHex(temp));</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> a <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(temp, (4 <span style="color:#f92672">*</span> i), (4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 4));
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> b <span style="color:#f92672">=</span> leftShift(a, i);
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">leftShift</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in, <span style="color:#66d9ef">int</span> times) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(in, 0, 4);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> times; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(out, 0, 4);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Inverse Shift Rows */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">inverseShiftRows</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> a <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(temp, (4 <span style="color:#f92672">*</span> i), (4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 4));
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> b <span style="color:#f92672">=</span> rightShift(a, i);
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">rightShift</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in, <span style="color:#66d9ef">int</span> times) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(in, 0, 4);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> times; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(out, 0, 4);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Mix Columns */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">mixColumns</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            in <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 2) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 3) <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 2) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 3) <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 2) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 3))
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 3) <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 2))
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Inverse Mix Columns */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">inverseMixColumns</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            in <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 14) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 11) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 13)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 9)) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 9) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 14) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 11)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 13)) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 13) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 9) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 14)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 11)) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 11) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 13) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 9)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 14)) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">hexStringToByteArray</span>(String string) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> string.<span style="color:#a6e22e">length</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>) Math.<span style="color:#a6e22e">ceil</span>((length <span style="color:#f92672">+</span> 1) <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> length <span style="color:#f92672">-</span> 1; i <span style="color:#f92672">&gt;=</span> 0; i <span style="color:#f92672">-=</span> 2) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((Character.<span style="color:#a6e22e">digit</span>(<span style="color:#e6db74">&#39;0&#39;</span>, 16) <span style="color:#f92672">&lt;&lt;</span> 4) <span style="color:#f92672">+</span> Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i), 16));
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i <span style="color:#f92672">-</span> 1), 16) <span style="color:#f92672">&lt;&lt;</span> 4)
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">+</span> Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i), 16));
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">         * http://stackoverflow.com/questions/9655181/convert-from-byte-array-to-hex-
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">         * string-in-java
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">         */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">bytesToHex</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> bytes) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> hexChars <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[</span>bytes.<span style="color:#a6e22e">length</span> <span style="color:#f92672">*</span> 2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> bytes.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> v <span style="color:#f92672">=</span> bytes<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">&amp;</span> 0xFF;
</span></span><span style="display:flex;"><span>                hexChars<span style="color:#f92672">[</span>j <span style="color:#f92672">*</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> hexArray<span style="color:#f92672">[</span>v <span style="color:#f92672">&gt;&gt;&gt;</span> 4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                hexChars<span style="color:#f92672">[</span>j <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> hexArray<span style="color:#f92672">[</span>v <span style="color:#f92672">&amp;</span> 0x0F<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> String(hexChars);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> input.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">print</span>(byteToBits(input<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printByte</span>(String msg, <span style="color:#66d9ef">byte</span> input) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            temp<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> input;
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(msg <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;: &#34;</span> <span style="color:#f92672">+</span> bytesToHex(temp));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> String <span style="color:#a6e22e">byteToBits</span>(<span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            StringBuffer buffer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuffer();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> 8; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>                buffer.<span style="color:#a6e22e">append</span>((<span style="color:#66d9ef">int</span>) (b <span style="color:#f92672">&gt;&gt;</span> (8 <span style="color:#f92672">-</span> (i <span style="color:#f92672">+</span> 1)) <span style="color:#f92672">&amp;</span> 0x0001));
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> buffer.<span style="color:#a6e22e">toString</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getRoundKey</span>(<span style="color:#66d9ef">int</span> round) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>KEY_LENGTH<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(word, 16 <span style="color:#f92672">*</span> round, 16 <span style="color:#f92672">*</span> round <span style="color:#f92672">+</span> 16);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">XORBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in1, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in2) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>in1.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> in1.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((in1<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in2<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">encryptText</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> plainText, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BLOCK_LENGTH<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">word</span> <span style="color:#f92672">=</span> expandKey(key);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> roundKey <span style="color:#f92672">=</span> getRoundKey(0);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Round 0 */</span>
</span></span><span style="display:flex;"><span>            cipher <span style="color:#f92672">=</span> XORBytes(plainText, roundKey);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;Round 0\n&#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Rounds 1 to 9 */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 1; i <span style="color:#f92672">&lt;</span> 10; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;Round &#34; + i);</span>
</span></span><span style="display:flex;"><span>                cipher <span style="color:#f92672">=</span> subBytes(cipher);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;SubBytes: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>                cipher <span style="color:#f92672">=</span> shiftRows(cipher);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;ShiftRows: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>                cipher <span style="color:#f92672">=</span> mixColumns(cipher);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;MixColumns: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>                roundKey <span style="color:#f92672">=</span> getRoundKey(i);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;RoundKey: &#34; + bytesToHex(roundKey));</span>
</span></span><span style="display:flex;"><span>                cipher <span style="color:#f92672">=</span> XORBytes(cipher, roundKey);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;CIPHER: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Round 10 */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;Round 10&#34;);</span>
</span></span><span style="display:flex;"><span>            cipher <span style="color:#f92672">=</span> subBytes(cipher);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;SubBytes: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>            cipher <span style="color:#f92672">=</span> shiftRows(cipher);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;ShiftRows: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>            roundKey <span style="color:#f92672">=</span> getRoundKey(10);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;RoundKey: &#34; + bytesToHex(roundKey));</span>
</span></span><span style="display:flex;"><span>            cipher <span style="color:#f92672">=</span> XORBytes(cipher, roundKey);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;CIPHER: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> cipher;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">decryptText</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> plainText <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BLOCK_LENGTH<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">word</span> <span style="color:#f92672">=</span> expandKey(key);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> roundKey <span style="color:#f92672">=</span> getRoundKey(10);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Round 0 */</span>
</span></span><span style="display:flex;"><span>            plainText <span style="color:#f92672">=</span> XORBytes(cipher, roundKey);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Rounds 1 to 9 */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 9; i <span style="color:#f92672">&gt;</span> 0; i<span style="color:#f92672">--</span>) {
</span></span><span style="display:flex;"><span>                plainText <span style="color:#f92672">=</span> inverseShiftRows(plainText);
</span></span><span style="display:flex;"><span>                plainText <span style="color:#f92672">=</span> inverseSubBytes(plainText);
</span></span><span style="display:flex;"><span>                roundKey <span style="color:#f92672">=</span> getRoundKey(i);
</span></span><span style="display:flex;"><span>                plainText <span style="color:#f92672">=</span> XORBytes(plainText, roundKey);
</span></span><span style="display:flex;"><span>                plainText <span style="color:#f92672">=</span> inverseMixColumns(plainText);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Round 10 */</span>
</span></span><span style="display:flex;"><span>            plainText <span style="color:#f92672">=</span> inverseShiftRows(plainText);
</span></span><span style="display:flex;"><span>            plainText <span style="color:#f92672">=</span> inverseSubBytes(plainText);
</span></span><span style="display:flex;"><span>            roundKey <span style="color:#f92672">=</span> getRoundKey(0);
</span></span><span style="display:flex;"><span>            plainText <span style="color:#f92672">=</span> XORBytes(plainText, roundKey);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> plainText;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (args.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 1) {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Usage: java &lt; classname &gt; &lt; mode &gt;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n\t&lt; mode &gt; := (ECB|CBC|OFB|CFB)&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/* ECB, CBC, OFB, or CFB */</span>
</span></span><span style="display:flex;"><span>                String mode <span style="color:#f92672">=</span> args<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// String mode = &#34;CFB&#34;;</span>
</span></span><span style="display:flex;"><span>                mode <span style="color:#f92672">=</span> mode.<span style="color:#a6e22e">toUpperCase</span>();
</span></span><span style="display:flex;"><span>                AESencrypt aes <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AESencrypt(mode);
</span></span><span style="display:flex;"><span>                File keyFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;AESkey.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                File textFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;AESplaintext.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                File cipherFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;AESciphertext.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                FileReader keyFileReader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileReader(keyFile);
</span></span><span style="display:flex;"><span>                BufferedReader bufferedReader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader(keyFileReader);
</span></span><span style="display:flex;"><span>                FileInputStream textFileInputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream(textFile);
</span></span><span style="display:flex;"><span>                FileOutputStream cipherFileOutputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream(cipherFile);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>(<span style="color:#66d9ef">int</span>) keyFile.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                String keyString <span style="color:#f92672">=</span> bufferedReader.<span style="color:#a6e22e">readLine</span>();
</span></span><span style="display:flex;"><span>                key <span style="color:#f92672">=</span> aes.<span style="color:#a6e22e">hexStringToByteArray</span>(keyString);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>(<span style="color:#66d9ef">int</span>) textFile.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                textFileInputStream.<span style="color:#a6e22e">read</span>(message);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> aes.<span style="color:#a6e22e">encrypt</span>(message, key);
</span></span><span style="display:flex;"><span>                cipherFileOutputStream.<span style="color:#a6e22e">write</span>(cipher);
</span></span><span style="display:flex;"><span>                cipherFileOutputStream.<span style="color:#a6e22e">flush</span>();
</span></span><span style="display:flex;"><span>                cipherFileOutputStream.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                bufferedReader.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                textFileInputStream.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Encryption done! Please check AESciphertext.txt for output!&#34;</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (Exception exp) {
</span></span><span style="display:flex;"><span>                exp.<span style="color:#a6e22e">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">encrypt</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (message.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> 16) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Message should be atleast 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (key.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 16) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Key should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> message.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (length <span style="color:#f92672">+</span> 15) <span style="color:#f92672">/</span> 16 <span style="color:#f92672">*</span> 16;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (length <span style="color:#f92672">==</span> 16) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;ECB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> encryptText(message, key);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> iv <span style="color:#f92672">=</span> getInitializationVector();
</span></span><span style="display:flex;"><span>                    message <span style="color:#f92672">=</span> XORBytes(message, iv);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> encryptText(message, key);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> nounce <span style="color:#f92672">=</span> getNounce();
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> encryptText(nounce, key);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> XORBytes(temp, message);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported mode of operation!&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> feedback <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>16<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getInitializationVector();
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getNounce();
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getInitializationVectorCFB();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> (i <span style="color:#f92672">&lt;</span> length) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> block <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>16<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>16<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (; j <span style="color:#f92672">&lt;</span> 16 <span style="color:#f92672">&amp;&amp;</span> i <span style="color:#f92672">&lt;</span> length; j<span style="color:#f92672">++</span>, i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    block<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> message<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;</span> 16) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* pad with white spaces */</span>
</span></span><span style="display:flex;"><span>                    block<span style="color:#f92672">[</span>j<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> 0x20;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;BLOCK: &#34;);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printBytes(block);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;ECB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> encryptText(block, key);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    block <span style="color:#f92672">=</span> XORBytes(block, feedback);
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> encryptText(block, key);
</span></span><span style="display:flex;"><span>                    feedback <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 16);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> encryptText(feedback, key);
</span></span><span style="display:flex;"><span>                    feedback <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 16);
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> XORBytes(result, block);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> encryptText(feedback, key);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 8);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 0, 8);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp1 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                    feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 8, 16), temp1);
</span></span><span style="display:flex;"><span>                    resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 8, 16);
</span></span><span style="display:flex;"><span>                    blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 8, 16);
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> encryptText(feedback, key);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp2 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                    feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 8, 16), temp2);
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> mergeBytes(temp1, temp2);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported mode of operation!&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;RESULT: &#34;);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printBytes(result);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> 16 <span style="color:#f92672">&amp;&amp;</span> k <span style="color:#f92672">&lt;</span> cipher.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>, k<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    cipher<span style="color:#f92672">[</span>k<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> result<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> cipher;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getInitializationVector</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;247D8AC4DDB1AA739DC593821D0BC432&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getInitializationVectorCFB</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;247D8AC4DDB1AA739DC593821D0BC432&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getNounce</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// char[] hexArray = &#34;0123456789ABCDEF&#34;.toCharArray();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// String nounceStr = &#34;&#34;;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// for (int i = 0 ; i &lt; 16 ; i++) {</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// double random = Math.random();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// int index = (int) (random * 16);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// nounceStr += hexArray[index];</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// }</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// return hexStringToByteArray(nounceStr);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;247D8AC4DDB1AA739DC593821D0BC432&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">mergeBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in1, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in2) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>in1.<span style="color:#a6e22e">length</span> <span style="color:#f92672">+</span> in2.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> in1.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> in1<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> in2.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> in2<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p><strong>Decryption - AESdecrypt.java</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.BufferedReader;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.File;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileInputStream;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileOutputStream;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileReader;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.util.Arrays;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AESdecrypt</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> BITS <span style="color:#f92672">=</span> 16;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> ROUNDS <span style="color:#f92672">=</span> 10;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> NO_OF_WORDS_IN_KEY <span style="color:#f92672">=</span> 44;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> KEY_LENGTH <span style="color:#f92672">=</span> 16;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> BLOCK_LENGTH <span style="color:#f92672">=</span> 16;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> hexArray <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0123456789ABCDEF&#34;</span>.<span style="color:#a6e22e">toCharArray</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> RC <span style="color:#f92672">=</span> { 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1B, 0x36 };
</span></span><span style="display:flex;"><span>        Word<span style="color:#f92672">[]</span> Rcon <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word<span style="color:#f92672">[</span>ROUNDS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> word <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> String mode <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> sBox <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76,
</span></span><span style="display:flex;"><span>          0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0,
</span></span><span style="display:flex;"><span>          0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15,
</span></span><span style="display:flex;"><span>          0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75,
</span></span><span style="display:flex;"><span>          0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84,
</span></span><span style="display:flex;"><span>          0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf,
</span></span><span style="display:flex;"><span>          0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8,
</span></span><span style="display:flex;"><span>          0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2,
</span></span><span style="display:flex;"><span>          0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73,
</span></span><span style="display:flex;"><span>          0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb,
</span></span><span style="display:flex;"><span>          0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79,
</span></span><span style="display:flex;"><span>          0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08,
</span></span><span style="display:flex;"><span>          0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a,
</span></span><span style="display:flex;"><span>          0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e,
</span></span><span style="display:flex;"><span>          0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf,
</span></span><span style="display:flex;"><span>          0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>          
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> invSBox <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          0x52, 0x09, 0x6a, 0xd5, 0x30, 0x36, 0xa5, 0x38, 0xbf, 0x40, 0xa3, 0x9e, 0x81, 0xf3, 0xd7, 0xfb,
</span></span><span style="display:flex;"><span>          0x7c, 0xe3, 0x39, 0x82, 0x9b, 0x2f, 0xff, 0x87, 0x34, 0x8e, 0x43, 0x44, 0xc4, 0xde, 0xe9, 0xcb,
</span></span><span style="display:flex;"><span>          0x54, 0x7b, 0x94, 0x32, 0xa6, 0xc2, 0x23, 0x3d, 0xee, 0x4c, 0x95, 0x0b, 0x42, 0xfa, 0xc3, 0x4e,
</span></span><span style="display:flex;"><span>          0x08, 0x2e, 0xa1, 0x66, 0x28, 0xd9, 0x24, 0xb2, 0x76, 0x5b, 0xa2, 0x49, 0x6d, 0x8b, 0xd1, 0x25, 
</span></span><span style="display:flex;"><span>          0x72, 0xf8, 0xf6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xd4, 0xa4, 0x5c, 0xcc, 0x5d, 0x65, 0xb6, 0x92, 
</span></span><span style="display:flex;"><span>          0x6c, 0x70, 0x48, 0x50, 0xfd, 0xed, 0xb9, 0xda, 0x5e, 0x15, 0x46, 0x57, 0xa7, 0x8d, 0x9d, 0x84, 
</span></span><span style="display:flex;"><span>          0x90, 0xd8, 0xab, 0x00, 0x8c, 0xbc, 0xd3, 0x0a, 0xf7, 0xe4, 0x58, 0x05, 0xb8, 0xb3, 0x45, 0x06, 
</span></span><span style="display:flex;"><span>          0xd0, 0x2c, 0x1e, 0x8f, 0xca, 0x3f, 0x0f, 0x02, 0xc1, 0xaf, 0xbd, 0x03, 0x01, 0x13, 0x8a, 0x6b, 
</span></span><span style="display:flex;"><span>          0x3a, 0x91, 0x11, 0x41, 0x4f, 0x67, 0xdc, 0xea, 0x97, 0xf2, 0xcf, 0xce, 0xf0, 0xb4, 0xe6, 0x73, 
</span></span><span style="display:flex;"><span>          0x96, 0xac, 0x74, 0x22, 0xe7, 0xad, 0x35, 0x85, 0xe2, 0xf9, 0x37, 0xe8, 0x1c, 0x75, 0xdf, 0x6e, 
</span></span><span style="display:flex;"><span>          0x47, 0xf1, 0x1a, 0x71, 0x1d, 0x29, 0xc5, 0x89, 0x6f, 0xb7, 0x62, 0x0e, 0xaa, 0x18, 0xbe, 0x1b, 
</span></span><span style="display:flex;"><span>          0xfc, 0x56, 0x3e, 0x4b, 0xc6, 0xd2, 0x79, 0x20, 0x9a, 0xdb, 0xc0, 0xfe, 0x78, 0xcd, 0x5a, 0xf4, 
</span></span><span style="display:flex;"><span>          0x1f, 0xdd, 0xa8, 0x33, 0x88, 0x07, 0xc7, 0x31, 0xb1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xec, 0x5f, 
</span></span><span style="display:flex;"><span>          0x60, 0x51, 0x7f, 0xa9, 0x19, 0xb5, 0x4a, 0x0d, 0x2d, 0xe5, 0x7a, 0x9f, 0x93, 0xc9, 0x9c, 0xef, 
</span></span><span style="display:flex;"><span>          0xa0, 0xe0, 0x3b, 0x4d, 0xae, 0x2a, 0xf5, 0xb0, 0xc8, 0xeb, 0xbb, 0x3c, 0x83, 0x53, 0x99, 0x61, 
</span></span><span style="display:flex;"><span>          0x17, 0x2b, 0x04, 0x7e, 0xba, 0x77, 0xd6, 0x26, 0xe1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0c, 0x7d
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">AESdecrypt</span>(String mode) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">mode</span> <span style="color:#f92672">=</span> mode;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> ROUNDS; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                Rcon<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word();
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                temp<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (RC<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                temp<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                temp<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                temp<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                Rcon<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>.<span style="color:#a6e22e">setWord</span>(temp);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            word <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>NO_OF_WORDS_IN_KEY<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Ref: http://www.samiam.org/galois.html */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Galois Addition */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span> <span style="color:#a6e22e">gadd</span>(<span style="color:#66d9ef">byte</span> a, <span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">byte</span>) ((a <span style="color:#f92672">^</span> b) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Galois Subtraction */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span> <span style="color:#a6e22e">gsub</span>(<span style="color:#66d9ef">byte</span> a, <span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">byte</span>) ((a <span style="color:#f92672">^</span> b) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Galois Multiplication */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span> <span style="color:#a6e22e">gmul</span>(<span style="color:#66d9ef">byte</span> a, <span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> p <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> counter;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> high_bit_set;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> byte0x80 <span style="color:#f92672">=</span> hexStringToByteArray(<span style="color:#e6db74">&#34;80&#34;</span>)<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (counter <span style="color:#f92672">=</span> 0; counter <span style="color:#f92672">&lt;</span> 8; counter<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> ((b <span style="color:#f92672">&amp;</span> 0x01) <span style="color:#f92672">==</span> 1) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// System.out.println(&#34;lower bit of b is set&#34;);</span>
</span></span><span style="display:flex;"><span>                    p <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((p <span style="color:#f92672">^</span> a) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                high_bit_set <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (a <span style="color:#f92672">&amp;</span> 0x80);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printByte(&#34;high_bit_set&#34;, high_bit_set);</span>
</span></span><span style="display:flex;"><span>                a <span style="color:#f92672">&lt;&lt;=</span> 1;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (high_bit_set <span style="color:#f92672">==</span> byte0x80) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// System.out.println(&#34;higher bit of a is set&#34;);</span>
</span></span><span style="display:flex;"><span>                    a <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((a <span style="color:#f92672">^</span> 0x1b) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                b <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((b <span style="color:#f92672">&gt;&gt;</span> 1) <span style="color:#f92672">&amp;</span> 0x7f);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printByte(&#34;a&#34;, a);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printByte(&#34;b&#34;, b);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printByte(&#34;p&#34;, p);</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> p;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span> <span style="color:#a6e22e">gmul</span>(<span style="color:#66d9ef">byte</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> t <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (b <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> gmul(a, t);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Key Expansion */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">expandKey</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(key.length);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(bytesToHex(key));</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (key.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> KEY_LENGTH) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Exception(<span style="color:#e6db74">&#34;Key should be of length, 128 bits&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            Word<span style="color:#f92672">[]</span> w <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word<span style="color:#f92672">[</span>NO_OF_WORDS_IN_KEY<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            Word temp;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                w<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word(key<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i<span style="color:#f92672">]</span>, key<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span>, key<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 2<span style="color:#f92672">]</span>, key<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 3<span style="color:#f92672">]</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;w&#34; + i + &#34; = &#34; + w[i]);</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 4; i <span style="color:#f92672">&lt;</span> 44; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                temp <span style="color:#f92672">=</span> w<span style="color:#f92672">[</span>i <span style="color:#f92672">-</span> 1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                Word temp1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Word();
</span></span><span style="display:flex;"><span>                temp1.<span style="color:#a6e22e">setWord</span>(temp.<span style="color:#a6e22e">getWord</span>());
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;w&#34; + (i-1) + &#34; = &#34; + temp);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">%</span> 4 <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>                    temp1.<span style="color:#a6e22e">rotWord</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// System.out.println(&#34;Rot=&#34; + temp1);</span>
</span></span><span style="display:flex;"><span>                    temp1.<span style="color:#a6e22e">subWord</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// System.out.println(&#34;Sub=&#34; + temp1);</span>
</span></span><span style="display:flex;"><span>                    temp1 <span style="color:#f92672">=</span> Word.<span style="color:#a6e22e">XORWords</span>(temp1, Rcon<span style="color:#f92672">[</span>(i <span style="color:#f92672">/</span> 4) <span style="color:#f92672">-</span> 1<span style="color:#f92672">]</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// System.out.println(&#34;Rcon&#34; + temp1);</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                w<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> Word.<span style="color:#a6e22e">XORWords</span>(w<span style="color:#f92672">[</span>i <span style="color:#f92672">-</span> 4<span style="color:#f92672">]</span>, temp1);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;w&#34; + i + &#34; = &#34; + w[i]);</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> Word.<span style="color:#a6e22e">wordsToBytes</span>(w);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Substitute Bytes */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">subBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span> a <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> row <span style="color:#f92672">=</span> (a <span style="color:#f92672">&gt;&gt;</span> 4) <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> col <span style="color:#f92672">=</span> a <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) sBox<span style="color:#f92672">[</span>row <span style="color:#f92672">*</span> BITS <span style="color:#f92672">+</span> col<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Inverse Substitute Bytes */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">inverseSubBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span> a <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> row <span style="color:#f92672">=</span> (a <span style="color:#f92672">&gt;&gt;</span> 4) <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> col <span style="color:#f92672">=</span> a <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) invSBox<span style="color:#f92672">[</span>row <span style="color:#f92672">*</span> BITS <span style="color:#f92672">+</span> col<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Shift Rows */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">shiftRows</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;temp: &#34; + bytesToHex(temp));</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> a <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(temp, (4 <span style="color:#f92672">*</span> i), (4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 4));
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> b <span style="color:#f92672">=</span> leftShift(a, i);
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">leftShift</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in, <span style="color:#66d9ef">int</span> times) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(in, 0, 4);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> times; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(out, 0, 4);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Inverse Shift Rows */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">inverseShiftRows</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> a <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(temp, (4 <span style="color:#f92672">*</span> i), (4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 4));
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> b <span style="color:#f92672">=</span> rightShift(a, i);
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> 3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> b<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">rightShift</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in, <span style="color:#66d9ef">int</span> times) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(in, 0, 4);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> times; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                in <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(out, 0, 4);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Mix Columns */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">mixColumns</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            in <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 2) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 3) <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 2) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 3) <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 2) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 3))
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 3) <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 2))
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Inverse Mix Columns */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">inverseMixColumns</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BITS<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            in <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 14) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 11) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 13)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 9)) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 9) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 14) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 11)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 13)) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 13) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 9) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 14)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 11)) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 0 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 11) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 1 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 13) <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 9)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">^</span> gmul(in<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> 3 <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>, 14)) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> BITS <span style="color:#f92672">/</span> 4; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    temp<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> out<span style="color:#f92672">[</span>4 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">hexStringToByteArray</span>(String string) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> string.<span style="color:#a6e22e">length</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>) Math.<span style="color:#a6e22e">ceil</span>((length <span style="color:#f92672">+</span> 1) <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> length <span style="color:#f92672">-</span> 1; i <span style="color:#f92672">&gt;=</span> 0; i <span style="color:#f92672">-=</span> 2) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((Character.<span style="color:#a6e22e">digit</span>(<span style="color:#e6db74">&#39;0&#39;</span>, 16) <span style="color:#f92672">&lt;&lt;</span> 4) <span style="color:#f92672">+</span> Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i), 16));
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i <span style="color:#f92672">-</span> 1), 16) <span style="color:#f92672">&lt;&lt;</span> 4)
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">+</span> Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i), 16));
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">         * http://stackoverflow.com/questions/9655181/convert-from-byte-array-to-hex-
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">         * string-in-java
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">         */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">bytesToHex</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> bytes) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> hexChars <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[</span>bytes.<span style="color:#a6e22e">length</span> <span style="color:#f92672">*</span> 2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> bytes.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> v <span style="color:#f92672">=</span> bytes<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">&amp;</span> 0xFF;
</span></span><span style="display:flex;"><span>                hexChars<span style="color:#f92672">[</span>j <span style="color:#f92672">*</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> hexArray<span style="color:#f92672">[</span>v <span style="color:#f92672">&gt;&gt;&gt;</span> 4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                hexChars<span style="color:#f92672">[</span>j <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> hexArray<span style="color:#f92672">[</span>v <span style="color:#f92672">&amp;</span> 0x0F<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> String(hexChars);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> input.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">print</span>(byteToBits(input<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printByte</span>(String msg, <span style="color:#66d9ef">byte</span> input) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            temp<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> input;
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(msg <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;: &#34;</span> <span style="color:#f92672">+</span> bytesToHex(temp));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> String <span style="color:#a6e22e">byteToBits</span>(<span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            StringBuffer buffer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuffer();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> 8; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>                buffer.<span style="color:#a6e22e">append</span>((<span style="color:#66d9ef">int</span>) (b <span style="color:#f92672">&gt;&gt;</span> (8 <span style="color:#f92672">-</span> (i <span style="color:#f92672">+</span> 1)) <span style="color:#f92672">&amp;</span> 0x0001));
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> buffer.<span style="color:#a6e22e">toString</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getRoundKey</span>(<span style="color:#66d9ef">int</span> round) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>KEY_LENGTH<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            out <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(word, 16 <span style="color:#f92672">*</span> round, 16 <span style="color:#f92672">*</span> round <span style="color:#f92672">+</span> 16);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">XORBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in1, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in2) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>in1.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> in1.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((in1<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in2<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">encryptText</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> plainText, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BLOCK_LENGTH<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">word</span> <span style="color:#f92672">=</span> expandKey(key);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> roundKey <span style="color:#f92672">=</span> getRoundKey(0);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Round 0 */</span>
</span></span><span style="display:flex;"><span>            cipher <span style="color:#f92672">=</span> XORBytes(plainText, roundKey);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;Round 0\n&#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Rounds 1 to 9 */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 1; i <span style="color:#f92672">&lt;</span> 10; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;Round &#34; + i);</span>
</span></span><span style="display:flex;"><span>                cipher <span style="color:#f92672">=</span> subBytes(cipher);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;SubBytes: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>                cipher <span style="color:#f92672">=</span> shiftRows(cipher);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;ShiftRows: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>                cipher <span style="color:#f92672">=</span> mixColumns(cipher);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;MixColumns: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>                roundKey <span style="color:#f92672">=</span> getRoundKey(i);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;RoundKey: &#34; + bytesToHex(roundKey));</span>
</span></span><span style="display:flex;"><span>                cipher <span style="color:#f92672">=</span> XORBytes(cipher, roundKey);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;CIPHER: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Round 10 */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;Round 10&#34;);</span>
</span></span><span style="display:flex;"><span>            cipher <span style="color:#f92672">=</span> subBytes(cipher);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;SubBytes: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>            cipher <span style="color:#f92672">=</span> shiftRows(cipher);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;ShiftRows: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>            roundKey <span style="color:#f92672">=</span> getRoundKey(10);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;RoundKey: &#34; + bytesToHex(roundKey));</span>
</span></span><span style="display:flex;"><span>            cipher <span style="color:#f92672">=</span> XORBytes(cipher, roundKey);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// System.out.println(&#34;CIPHER: &#34; + bytesToHex(cipher));</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> cipher;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">decryptText</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> plainText <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>BLOCK_LENGTH<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">word</span> <span style="color:#f92672">=</span> expandKey(key);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> roundKey <span style="color:#f92672">=</span> getRoundKey(10);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Round 0 */</span>
</span></span><span style="display:flex;"><span>            plainText <span style="color:#f92672">=</span> XORBytes(cipher, roundKey);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Rounds 1 to 9 */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 9; i <span style="color:#f92672">&gt;</span> 0; i<span style="color:#f92672">--</span>) {
</span></span><span style="display:flex;"><span>                plainText <span style="color:#f92672">=</span> inverseShiftRows(plainText);
</span></span><span style="display:flex;"><span>                plainText <span style="color:#f92672">=</span> inverseSubBytes(plainText);
</span></span><span style="display:flex;"><span>                roundKey <span style="color:#f92672">=</span> getRoundKey(i);
</span></span><span style="display:flex;"><span>                plainText <span style="color:#f92672">=</span> XORBytes(plainText, roundKey);
</span></span><span style="display:flex;"><span>                plainText <span style="color:#f92672">=</span> inverseMixColumns(plainText);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* Round 10 */</span>
</span></span><span style="display:flex;"><span>            plainText <span style="color:#f92672">=</span> inverseShiftRows(plainText);
</span></span><span style="display:flex;"><span>            plainText <span style="color:#f92672">=</span> inverseSubBytes(plainText);
</span></span><span style="display:flex;"><span>            roundKey <span style="color:#f92672">=</span> getRoundKey(0);
</span></span><span style="display:flex;"><span>            plainText <span style="color:#f92672">=</span> XORBytes(plainText, roundKey);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> plainText;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (args.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 1) {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Usage: java &lt; classname &gt; &lt; mode &gt;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n\t&lt; mode &gt; := (ECB|CBC|OFB|CFB)&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/* ECB, CBC, OFB, or CFB */</span>
</span></span><span style="display:flex;"><span>                String mode <span style="color:#f92672">=</span> args<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// String mode = &#34;CFB&#34;;</span>
</span></span><span style="display:flex;"><span>                mode <span style="color:#f92672">=</span> mode.<span style="color:#a6e22e">toUpperCase</span>();
</span></span><span style="display:flex;"><span>                AESdecrypt aes <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AESdecrypt(mode);
</span></span><span style="display:flex;"><span>                File keyFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;AESkey.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                File textFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;AESplaintext.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                File cipherFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;AESciphertext.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                FileReader keyFileReader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileReader(keyFile);
</span></span><span style="display:flex;"><span>                BufferedReader bufferedReader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader(keyFileReader);
</span></span><span style="display:flex;"><span>                FileInputStream cipherFileInputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream(cipherFile);
</span></span><span style="display:flex;"><span>                FileOutputStream textFileOutputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream(textFile);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>(<span style="color:#66d9ef">int</span>) keyFile.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                String keyString <span style="color:#f92672">=</span> bufferedReader.<span style="color:#a6e22e">readLine</span>();
</span></span><span style="display:flex;"><span>                key <span style="color:#f92672">=</span> aes.<span style="color:#a6e22e">hexStringToByteArray</span>(keyString);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>(<span style="color:#66d9ef">int</span>) cipherFile.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                cipherFileInputStream.<span style="color:#a6e22e">read</span>(cipher);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message <span style="color:#f92672">=</span> aes.<span style="color:#a6e22e">decrypt</span>(cipher, key);
</span></span><span style="display:flex;"><span>                textFileOutputStream.<span style="color:#a6e22e">write</span>(message);
</span></span><span style="display:flex;"><span>                textFileOutputStream.<span style="color:#a6e22e">flush</span>();
</span></span><span style="display:flex;"><span>                textFileOutputStream.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                bufferedReader.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                cipherFileInputStream.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Decryption done! Please check AESplaintext.txt for output!&#34;</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (Exception exp) {
</span></span><span style="display:flex;"><span>                exp.<span style="color:#a6e22e">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">decrypt</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key) <span style="color:#66d9ef">throws</span> Exception {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (message.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> 16) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Message should be atleast 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (key.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 16) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Key should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> message.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (length <span style="color:#f92672">+</span> 15) <span style="color:#f92672">/</span> 16 <span style="color:#f92672">*</span> 16;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (length <span style="color:#f92672">==</span> 16) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;ECB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> decryptText(message, key);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> iv <span style="color:#f92672">=</span> getInitializationVector();
</span></span><span style="display:flex;"><span>                    message <span style="color:#f92672">=</span> XORBytes(message, iv);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> decryptText(message, key);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> nounce <span style="color:#f92672">=</span> getNounce();
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> encryptText(nounce, key);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> XORBytes(temp, message);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported mode of operation!&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> feedback <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>16<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getInitializationVector();
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getNounce();
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getInitializationVectorCFB();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> (i <span style="color:#f92672">&lt;</span> length) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> block <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>16<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>16<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (; j <span style="color:#f92672">&lt;</span> 16 <span style="color:#f92672">&amp;&amp;</span> i <span style="color:#f92672">&lt;</span> length; j<span style="color:#f92672">++</span>, i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    block<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> message<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;</span> 16) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* pad with white spaces */</span>
</span></span><span style="display:flex;"><span>                    block<span style="color:#f92672">[</span>j<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> 0x20;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;BLOCK: &#34;);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printBytes(block);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;ECB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> decryptText(block, key);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> decryptText(block, key);
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> XORBytes(result, feedback);
</span></span><span style="display:flex;"><span>                    feedback <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 0, 16);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> encryptText(feedback, key);
</span></span><span style="display:flex;"><span>                    feedback <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 16);
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> XORBytes(result, block);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> encryptText(feedback, key);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 8);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 0, 8);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp1 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                    feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 8, 16), blockPart);
</span></span><span style="display:flex;"><span>                    resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 8, 16);
</span></span><span style="display:flex;"><span>                    blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 8, 16);
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> encryptText(feedback, key);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp2 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                    feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 8, 16), blockPart);
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> mergeBytes(temp1, temp2);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported mode of operation!&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;RESULT: &#34;);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printBytes(result);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> 16 <span style="color:#f92672">&amp;&amp;</span> k <span style="color:#f92672">&lt;</span> cipher.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>, k<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    cipher<span style="color:#f92672">[</span>k<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> result<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> cipher;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getInitializationVector</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;247D8AC4DDB1AA739DC593821D0BC432&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getInitializationVectorCFB</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;247D8AC4DDB1AA739DC593821D0BC432&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getNounce</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// char[] hexArray = &#34;0123456789ABCDEF&#34;.toCharArray();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// String nounceStr = &#34;&#34;;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// for (int i = 0 ; i &lt; 16 ; i++) {</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// double random = Math.random();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// int index = (int) (random * 16);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// nounceStr += hexArray[index];</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// }</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// return hexStringToByteArray(nounceStr);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;247D8AC4DDB1AA739DC593821D0BC432&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">mergeBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in1, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in2) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>in1.<span style="color:#a6e22e">length</span> <span style="color:#f92672">+</span> in2.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> in1.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> in1<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> in2.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> in2<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p><strong>Output</strong></p>
<pre><code>dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$ java AESkeygen 
Key generated and saved in AESkey.txt 
dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$ java AESencrypt 
Usage: java &lt; classname &gt; &lt; mode &gt; 
 &lt; mode &gt; := (ECB|CBC|OFB|CFB) 
dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$ java AESencrypt ecb 
Encryption done! Please check AESciphertext.txt for output!
dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$ java AESdecrypt ecb 
Decryption done! Please check AESplaintext.txt for output! 
dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$ java AESencrypt cbc 
Encryption done! Please check AESciphertext.txt for output! 
dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$ java AESdecrypt cbc 
Decryption done! Please check AESplaintext.txt for output! 
dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$ java AESencrypt ofb 
Encryption done! Please check AESciphertext.txt for output! 
dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$ java AESdecrypt ofb 
Decryption done! Please check AESplaintext.txt for output! 
dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$ java AESencrypt cfb 
Encryption done! Please check AESciphertext.txt for output! 
dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$ java AESdecrypt cfb 
Decryption done! Please check AESplaintext.txt for output! 
dhanoopbhaskar@dhanoop-laptop:~/workspace/Copy/crypto/run_aes$
</code></pre>
<p><strong>About Input/Output Files</strong></p>
<p>AESkeygen.java - (output) AESkey.txt</p>
<p>AESencrypt.java - (input) AESkey.txt &amp; AESplaintext.txt (output)
AESciphertext.txt</p>
<p>AESdecrypt.java - (input) AESkey.txt &amp; AESciphertext.txt (output)
AESplaintext.txt</p>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    
    <p>Hey, let's talk with the computers!</p>
    
    ©
    
      2019 -
    
    2025
     Dhanoop Bhaskar 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169392426-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169392426-1');
</script>


  

  

  

  

  

  

  

  
</body>
</html>
