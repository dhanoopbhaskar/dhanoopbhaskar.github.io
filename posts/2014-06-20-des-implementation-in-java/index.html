<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  DES Implementation In Java Â· The Insane Techie
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Dhanoop Bhaskar">
<meta name="description" content="DES.java
    public class DES {
        /* Initial Permutation */
        static final int[] IP = {
            58, 50, 42, 34, 26, 18, 10, 2,
            60, 52, 44, 36, 28, 20, 12, 4,
            62, 54, 46, 38, 30, 22, 14, 6,
            64, 56, 48, 40, 32, 24, 16, 8,
            57, 49, 41, 33, 25, 17,  9, 1,
            59, 51, 43, 35, 27, 19, 11, 3,
            61, 53, 45, 37, 29, 21, 13, 5,
            63, 55, 47, 39, 31, 23, 15, 7
        };
        /* Inverse Initial Permutation */
        static final int[] IIP = {
            40, 8, 48, 16, 56, 24, 64, 32,
            39, 7, 47, 15, 55, 23, 63, 31,
            38, 6, 46, 14, 54, 22, 62, 30,
            37, 5, 45, 13, 53, 21, 61, 29,
            36, 4, 44, 12, 52, 20, 60, 28,
            35, 3, 43, 11, 51, 19, 59, 27,
            34, 2, 42, 10, 50, 18, 58, 26,
            33, 1, 41,  9, 49, 17, 57, 25
        };
        /* Expansion Permutation */
        static final int[] E = {
            32,  1,  2,  3,  4,  5,
            4,  5,  6,  7,  8,  9,
            8,  9, 10, 11, 12, 13,
            12, 13, 14, 15, 16, 17,
            16, 17, 18, 19, 20, 21,
            20, 21, 22, 23, 24, 25,
            24, 25, 26, 27, 28, 29,
            28, 29, 30, 31, 32,  1
        };
        /* Permutation Function */
        static final int[] P = {
            16,  7, 20, 21,
            29, 12, 28, 17,
            1, 15, 23, 26,
            5, 18, 31, 10,
            2,  8, 24, 14,
            32, 27,  3,  9,
            19, 13, 30,  6,
            22, 11,  4, 25
        };
        /* S-Boxes*/
        static final int[] S1 = {
            14,  4, 13,  1,  2, 15, 11,  8,  3, 10,  6, 12,  5,  9,  0,  7,
             0, 15,  7,  4, 14,  2, 13,  1, 10,  6, 12, 11,  9,  5,  3,  8,
             4,  1, 14,  8, 13,  6,  2, 11, 15, 12,  9,  7,  3, 10,  5,  0,
            15, 12,  8,  2,  4,  9,  1,  7,  5, 11,  3, 14, 10,  0,  6, 13
        };
        static final int[] S2 = {
            15,  1,  8, 14,  6, 11,  3,  4,  9,  7,  2, 13, 12,  0,  5, 10,
             3, 13,  4,  7, 15,  2,  8, 14, 12,  0,  1, 10,  6,  9, 11,  5,
             0, 14,  7, 11, 10,  4, 13,  1,  5,  8, 12,  6,  9,  3,  2, 15,
            13,  8, 10,  1,  3, 15,  4,  2, 11,  6,  7, 12,  0,  5, 14,  9
        };
        static final int[] S3 = {
            10,  0,  9, 14,  6,  3, 15,  5,  1, 13, 12,  7, 11,  4,  2,  8,
            13,  7,  0,  9,  3,  4,  6, 10,  2,  8,  5, 14, 12, 11, 15,  1,
            13,  6,  4,  9,  8, 15,  3,  0, 11,  1,  2, 12,  5, 10, 14,  7,
             1, 10, 13,  0,  6,  9,  8,  7,  4, 15, 14,  3, 11,  5,  2, 12
        };
        static final int[] S4 = {
             7, 13, 14,  3,  0,  6,  9, 10,  1,  2,  8,  5, 11, 12,  4, 15,
            13,  8, 11,  5,  6, 15,  0,  3,  4,  7,  2, 12,  1, 10, 14,  9,
            10,  6,  9,  0, 12, 11,  7, 13, 15,  1,  3, 14,  5,  2,  8,  4,
             3, 15,  0,  6, 10,  1, 13,  8,  9,  4,  5, 11, 12,  7,  2, 14
        };
        static final int[] S5 = {
             2, 12,  4,  1,  7, 10, 11,  6,  8,  5,  3, 15, 13,  0, 14,  9,
            14, 11,  2, 12,  4,  7, 13,  1,  5,  0, 15, 10,  3,  9,  8,  6,
             4,  2,  1, 11, 10, 13,  7,  8, 15,  9, 12,  5,  6,  3,  0, 14,
            11,  8, 12,  7,  1, 14,  2, 13,  6, 15,  0,  9, 10,  4,  5,  3
        };
        static final int[] S6 = {
            12,  1, 10, 15,  9,  2,  6,  8,  0, 13,  3,  4, 14,  7,  5, 11,
            10, 15,  4,  2,  7, 12,  9,  5,  6,  1, 13, 14,  0, 11,  3,  8,
             9, 14, 15,  5,  2,  8, 12,  3,  7,  0,  4, 10,  1, 13, 11,  6,
             4,  3,  2, 12,  9,  5, 15, 10, 11, 14,  1,  7,  6,  0,  8, 13
        };
        static final int[] S7 = {
             4, 11,  2, 14, 15,  0,  8, 13,  3, 12,  9,  7,  5, 10,  6,  1,
            13,  0, 11,  7,  4,  9,  1, 10, 14,  3,  5, 12,  2, 15,  8,  6,
             1,  4, 11, 13, 12,  3,  7, 14, 10, 15,  6,  8,  0,  5,  9,  2,
             6, 11, 13,  8,  1,  4, 10,  7,  9,  5,  0, 15, 14,  2,  3, 12
        };
        static final int[] S8 = {
            13,  2,  8,  4,  6, 15, 11,  1, 10,  9,  3, 14,  5,  0, 12,  7,
             1, 15, 13,  8, 10,  3,  7,  4, 12,  5,  6, 11,  0, 14,  9,  2,
             7, 11,  4,  1,  9, 12, 14,  2,  0,  6, 10, 13, 15,  3,  5,  8,
             2,  1, 14,  7,  4, 10,  8, 13, 15, 12,  9,  0,  3,  5,  6, 11
        };
        /* Permuted Choice One */
        static final int[] PC1 = {
            57, 49, 41, 33, 25, 17,  9,
             1, 58, 50, 42, 34, 26, 18,
            10,  2, 59, 51, 43, 35, 27,
            19, 11,  3, 60, 52, 44, 36,
            63, 55, 47, 39, 31, 23, 15,
             7, 62, 54, 46, 38, 30, 22,
            14,  6, 61, 53, 45, 37, 29,
            21, 13,  5, 28, 20, 12,  4
        };
        /* Permuted Choice Two */
        static final int[] PC2 = {
            14, 17, 11, 24,  1,  5,
             3, 28, 15,  6, 21, 10,
            23, 19, 12,  4, 26,  8,
            16,  7, 27, 20, 13,  2,
            41, 52, 31, 37, 47, 55,
            30, 40, 51, 45, 33, 48,
            44, 49, 39, 56, 34, 53,
            46, 42, 50, 36, 29, 32
        };
        /* Schedule of Left Shifts */
        static final int[] SHIFTS = {
            1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1
        };
        
        public DES() {      
        }
        
        private byte[] performXOR(byte[] one, byte[] two) {
            byte[] result = new byte[one.length];
            for (int i = 0 ; i &lt; one.length ; i&#43;&#43;) {
                result[i] = (byte) (one[i] ^ two[i]);
            }
            return result;
        }
        
        private byte[] permute(byte[] input, int[] mapping) {
            int byteCount = 1 &#43; (mapping.length - 1) / 8;
            byte[] output = new byte[byteCount];
            int pos;
            
            for (int i = 0 ; i &lt; mapping.length ; i&#43;&#43;) {
                pos = mapping[i] - 1;
                int value = getBitFromArray(input, pos);
                setBitInArray(output, i, value);
            }       
            return output;
        }   

        private int getBitFromArray(byte[] array, int pos) {
            int value;
            int bytePos = pos / 8;
            int bitPos = pos % 8;       
            value = (array[bytePos] &gt;&gt; (8 - (bitPos &#43; 1))) &amp; 0x0001;        
            /* eg: right shift selected byte 5 times to get 3rd bit 
             * (bitPos = 2) at rightmost position and 
             * then AND with 0x0001*/
            return value;
        }
        
        private void setBitInArray(byte[] input, int pos, int value) {
            int bytePos = pos / 8;
            int bitPos = pos % 8;       
            byte old = input[bytePos];
            old = (byte) (((0xFF7F &gt;&gt; bitPos) &amp; old) &amp; 0x00FF);
            byte newByte = (byte) ((value &lt;&lt; (8 - (bitPos &#43; 1))) | old);
            input[bytePos] = newByte;
        }
        
        private byte[] hexStringToByteArray(String string) {
            int length = string.length();
            int n = (int)Math.ceil((length &#43; 1) / 2);
            byte[] result = new byte[n];        
            for (int i = length - 1; i &gt;= 0 ; i -= 2) { 
                if (i == 0) {
                    result[i / 2] = (byte) ((Character.digit(&#39;0&#39;, 16) &lt;&lt; 4)
                            &#43; Character.digit(string.charAt(i), 16));
                } else {
                    result[i / 2] = (byte) ((Character.digit(string.charAt(i - 1), 16) &lt;&lt; 4)
                        &#43; Character.digit(string.charAt(i), 16));
                }
            }
            return result;
        }
        
        private void printBytes(byte[] input) {             
            for (int i = 0 ; i &lt; input.length; i&#43;&#43;) {
                System.out.print(byteToBits(input[i]) &#43; &#34; &#34;);
            }
            System.out.println();
        }
        
        private String byteToBits(byte b) {
            StringBuffer buffer = new StringBuffer();
            for (int i = 0 ; i &lt; 8 ; i&#43;&#43;)
                buffer.append((int)(b &gt;&gt; (8-(i&#43;1)) &amp; 0x0001));
            return buffer.toString();
        }

        private byte[] getBits(byte[] input, int startPos, int length) {
            int noOfBytes = (length-1)/8 &#43; 1;
            byte[] output = new byte[noOfBytes];
            for (int i = 0 ; i &lt; length ; i&#43;&#43;) {
                int value = getBitFromArray(input, startPos &#43; i);
                setBitInArray(output, i, value);
            }
            return output;
        }   
        
        private byte[] rotateLeft(byte[] input, int step, int length) {     
            int noOfBytes = (length - 1) / 8 &#43; 1;
            byte[] output = new byte[noOfBytes];
            for (int i = 0 ; i &lt; length ; i&#43;&#43;) {
                int value = getBitFromArray(input, (i &#43; step) % length);
                setBitInArray(output, i, value);
            }
            return output;
        }
        
        private byte[] concatBits(byte[] one, int oneLength, 
                byte[] two, int twoLength) {
            int noOfBytes = (oneLength &#43; twoLength - 1) / 8 &#43; 1;
            byte[] output = new byte[noOfBytes];
            int i = 0, j = 0;
            for (; i &lt; oneLength ; i&#43;&#43;) {
                int value = getBitFromArray(one, i);
                setBitInArray(output, j, value);
                j&#43;&#43;;
            }       
            for (i = 0 ; i &lt; twoLength ; i&#43;&#43;) {
                int value = getBitFromArray(two, i);
                setBitInArray(output, j, value);
                j&#43;&#43;;
            }
            return output;
        }
        
        private byte[][] getSubKeys(byte[] masterKey) {
            int noOfSubKeys = SHIFTS.length;
            int keySize = PC1.length;
            byte[] key = permute(masterKey, PC1);
            byte[][] subKeys = new byte[noOfSubKeys][keySize];
            byte[] leftHalf = getBits(key, 0, keySize/2);
            byte[] rightHalf = getBits(key, keySize/2, keySize/2);
            for (int i = 0 ; i &lt; noOfSubKeys ; i&#43;&#43;) {
                leftHalf = rotateLeft(leftHalf, SHIFTS[i], keySize/2);
                rightHalf = rotateLeft(rightHalf, SHIFTS[i], keySize/2);
                byte[] subKey = concatBits(leftHalf, keySize/2, rightHalf, keySize/2);
                subKeys[i] = permute(subKey, PC2); 
            }
            return subKeys;
        }
        
        public byte[] crypt(byte[] message, byte[] key, String operation) {
            if (message.length &lt; 8) {
                System.out.println(&#34;Message should be atleast 64 bits&#34;);
                System.exit(1);
            }
            if (key.length != 8) {
                System.out.println(&#34;Key should be 64 bits&#34;);
                System.exit(1);
            }
            int length = message.length;
            int n = (length &#43; 7)/8 * 8;
            byte[] cipher = new byte[n];
            if (length == 8) {
                return cryptText(message, key, operation);
            }
            int i = 0;
            int k = 0;
            while (i &lt; length) {
                byte[] block = new byte[8];
                byte[] result = new byte[8];
                int j = 0;
                for (; j &lt; 8 &amp;&amp; i &lt; length; j&#43;&#43;, i&#43;&#43;) {
                    block[j] = message[i];
                }
                while (j &lt; 8) {
                    block[j&#43;&#43;] = 0x00;
                }
                System.out.println(&#34;BLOCK: &#34;);
                printBytes(block);          
                result = cryptText(block, key, operation);
                System.out.println(&#34;RESULT: &#34;);
                printBytes(result);
                for (j = 0 ; j &lt; 8 &amp;&amp; k &lt; cipher.length; j&#43;&#43;, k&#43;&#43;) {
                    cipher[k] = result[j];
                }
            }
            return cipher;      
        }
        
        public byte[] cryptText(byte[] message, byte[] key, String operation) {
            if (message.length != 8) {
                System.out.println(&#34;Message should be 64 bits&#34;);
                System.exit(1);
            }
            if (key.length != 8) {
                System.out.println(&#34;Key should be 64 bits&#34;);
                System.exit(1);
            }
            byte[] result = null;
            int blockSize = IP.length;
            byte[][] subKeys = getSubKeys(key);
            int noOfRounds = subKeys.length;
            /**
             * Initial Permutation
             */
            message = permute(message, IP);
            /**
             * Split message into two halves
             */
            byte[] leftHalf = getBits(message, 0, blockSize/2);
            byte[] rightHalf = getBits(message, blockSize/2, blockSize/2);
            for (int i = 0 ; i &lt; noOfRounds ; i&#43;&#43;) {
                byte[] temp = rightHalf;
                /**
                 * Expansion
                 */
                rightHalf = permute(rightHalf, E);
                /**
                 * XOR rightHalf with roundKey
                 */
                byte[] roundKey = null;
                if (operation.equalsIgnoreCase(&#34;encrypt&#34;)) {
                    roundKey = subKeys[i];
                } else if (operation.equalsIgnoreCase(&#34;decrypt&#34;)) {
                    roundKey = subKeys[noOfRounds - i - 1];
                } else {
                    System.out.println(&#34;Unsupported operation&#34;);
                    System.exit(0);
                }
                rightHalf = performXOR(rightHalf, roundKey);
                /**
                 * S-Box
                 */
                rightHalf = sBox(rightHalf);
                /**
                 * Permutation
                 */
                rightHalf = permute(rightHalf, P);
                /**
                 * XOR rightHalf with leftHalf
                 */
                rightHalf = performXOR(rightHalf, leftHalf);
                /**
                 * L(i) = R(i-1)
                 */
                leftHalf = temp;
            }
            /**
             * 32 bit swap
             */
            byte[] concatHalves = concatBits(rightHalf, blockSize/2, leftHalf, blockSize/2);
            /**
             * Inverse Initial Permutation
             */
            result = permute(concatHalves, IIP);
            return result;
        }
        
        private byte[] sBox(byte[] input) {     
            /**
             * Split input to 6-bit blocks
             */
            input = split(input,6);
            byte[] output = new byte[input.length/2];
            int leftHalf = 0;       
            for (int i = 0; i &lt; input.length ; i&#43;&#43;) {
                byte block = input[i];          
                /**
                 * row - first and last bits
                 * column - 4 bits in the middle
                 */
                int row = 2 * (block &gt;&gt; 7 &amp; 0x0001) &#43; (block &gt;&gt; 2 &amp; 0x0001);
                int col = block &gt;&gt; 3 &amp; 0x000F;
                int[] selectedSBox = getSBox(i);
                int rightHalf = selectedSBox[16 * row &#43; col];
                if (i % 2 == 0) {
                    leftHalf = rightHalf;
                } else {
                    output[i/2] = (byte) (16 * leftHalf &#43; rightHalf);
                    leftHalf = 0;
                }
            }
            return output;
        }

        private int[] getSBox(int i) {
            switch (i) {
                case 0: return S1;
                case 1: return S2;
                case 2: return S3;
                case 3: return S4;
                case 4: return S5;
                case 5: return S6;
                case 6: return S7;
                case 7: return S8;  
                default: return null;           
            }
        }

        private byte[] split(byte[] input, int length) {
            int noOfBytes = (8 * input.length - 1) / length &#43; 1;
            byte[] output = new byte[noOfBytes];
            for (int i = 0 ; i &lt; noOfBytes ; i&#43;&#43;) {
                for (int j = 0; j &lt; length ; j&#43;&#43;) {
                    int value = getBitFromArray(input, length * i &#43; j);             
                    setBitInArray(output, 8 * i &#43; j, value);
                }
            }
            return output;
        }

        public static void main(String[] args) {
            DES des = new DES();        
            byte[] message = des.hexStringToByteArray(&#34;123456789ABCDEF&#34;);
            System.out.println(&#34;PLAIN TEXT:&#34;);
            des.printBytes(message);
            byte[] key =  des.hexStringToByteArray(&#34;133457799BBCDFF1&#34;);
            System.out.println(&#34;KEY:&#34;);
            des.printBytes(key);
            byte[] cipher = des.crypt(message, key, &#34;encrypt&#34;);
            System.out.println(&#34;CIPHER TEXT:&#34;);
            des.printBytes(cipher);
            byte[] result = des.crypt(cipher, key, &#34;decrypt&#34;);
            System.out.println(&#34;DECRYPTED TEXT:&#34;);
            des.printBytes(result);
        }
            
    }
Output">
<meta name="keywords" content="">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="DES Implementation In Java">
  <meta name="twitter:description" content="DES.java
public class DES { /* Initial Permutation */ static final int[] IP = { 58, 50, 42, 34, 26, 18, 10, 2, 60, 52, 44, 36, 28, 20, 12, 4, 62, 54, 46, 38, 30, 22, 14, 6, 64, 56, 48, 40, 32, 24, 16, 8, 57, 49, 41, 33, 25, 17, 9, 1, 59, 51, 43, 35, 27, 19, 11, 3, 61, 53, 45, 37, 29, 21, 13, 5, 63, 55, 47, 39, 31, 23, 15, 7 }; /* Inverse Initial Permutation */ static final int[] IIP = { 40, 8, 48, 16, 56, 24, 64, 32, 39, 7, 47, 15, 55, 23, 63, 31, 38, 6, 46, 14, 54, 22, 62, 30, 37, 5, 45, 13, 53, 21, 61, 29, 36, 4, 44, 12, 52, 20, 60, 28, 35, 3, 43, 11, 51, 19, 59, 27, 34, 2, 42, 10, 50, 18, 58, 26, 33, 1, 41, 9, 49, 17, 57, 25 }; /* Expansion Permutation */ static final int[] E = { 32, 1, 2, 3, 4, 5, 4, 5, 6, 7, 8, 9, 8, 9, 10, 11, 12, 13, 12, 13, 14, 15, 16, 17, 16, 17, 18, 19, 20, 21, 20, 21, 22, 23, 24, 25, 24, 25, 26, 27, 28, 29, 28, 29, 30, 31, 32, 1 }; /* Permutation Function */ static final int[] P = { 16, 7, 20, 21, 29, 12, 28, 17, 1, 15, 23, 26, 5, 18, 31, 10, 2, 8, 24, 14, 32, 27, 3, 9, 19, 13, 30, 6, 22, 11, 4, 25 }; /* S-Boxes*/ static final int[] S1 = { 14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7, 0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8, 4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0, 15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13 }; static final int[] S2 = { 15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10, 3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5, 0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15, 13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9 }; static final int[] S3 = { 10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8, 13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1, 13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7, 1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12 }; static final int[] S4 = { 7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15, 13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9, 10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4, 3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14 }; static final int[] S5 = { 2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9, 14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6, 4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14, 11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3 }; static final int[] S6 = { 12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11, 10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8, 9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6, 4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13 }; static final int[] S7 = { 4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1, 13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6, 1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2, 6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12 }; static final int[] S8 = { 13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7, 1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2, 7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8, 2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11 }; /* Permuted Choice One */ static final int[] PC1 = { 57, 49, 41, 33, 25, 17, 9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51, 43, 35, 27, 19, 11, 3, 60, 52, 44, 36, 63, 55, 47, 39, 31, 23, 15, 7, 62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21, 13, 5, 28, 20, 12, 4 }; /* Permuted Choice Two */ static final int[] PC2 = { 14, 17, 11, 24, 1, 5, 3, 28, 15, 6, 21, 10, 23, 19, 12, 4, 26, 8, 16, 7, 27, 20, 13, 2, 41, 52, 31, 37, 47, 55, 30, 40, 51, 45, 33, 48, 44, 49, 39, 56, 34, 53, 46, 42, 50, 36, 29, 32 }; /* Schedule of Left Shifts */ static final int[] SHIFTS = { 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1 }; public DES() { } private byte[] performXOR(byte[] one, byte[] two) { byte[] result = new byte[one.length]; for (int i = 0 ; i &lt; one.length ; i&#43;&#43;) { result[i] = (byte) (one[i] ^ two[i]); } return result; } private byte[] permute(byte[] input, int[] mapping) { int byteCount = 1 &#43; (mapping.length - 1) / 8; byte[] output = new byte[byteCount]; int pos; for (int i = 0 ; i &lt; mapping.length ; i&#43;&#43;) { pos = mapping[i] - 1; int value = getBitFromArray(input, pos); setBitInArray(output, i, value); } return output; } private int getBitFromArray(byte[] array, int pos) { int value; int bytePos = pos / 8; int bitPos = pos % 8; value = (array[bytePos] &gt;&gt; (8 - (bitPos &#43; 1))) &amp; 0x0001; /* eg: right shift selected byte 5 times to get 3rd bit * (bitPos = 2) at rightmost position and * then AND with 0x0001*/ return value; } private void setBitInArray(byte[] input, int pos, int value) { int bytePos = pos / 8; int bitPos = pos % 8; byte old = input[bytePos]; old = (byte) (((0xFF7F &gt;&gt; bitPos) &amp; old) &amp; 0x00FF); byte newByte = (byte) ((value &lt;&lt; (8 - (bitPos &#43; 1))) | old); input[bytePos] = newByte; } private byte[] hexStringToByteArray(String string) { int length = string.length(); int n = (int)Math.ceil((length &#43; 1) / 2); byte[] result = new byte[n]; for (int i = length - 1; i &gt;= 0 ; i -= 2) { if (i == 0) { result[i / 2] = (byte) ((Character.digit(&#39;0&#39;, 16) &lt;&lt; 4) &#43; Character.digit(string.charAt(i), 16)); } else { result[i / 2] = (byte) ((Character.digit(string.charAt(i - 1), 16) &lt;&lt; 4) &#43; Character.digit(string.charAt(i), 16)); } } return result; } private void printBytes(byte[] input) { for (int i = 0 ; i &lt; input.length; i&#43;&#43;) { System.out.print(byteToBits(input[i]) &#43; &#34; &#34;); } System.out.println(); } private String byteToBits(byte b) { StringBuffer buffer = new StringBuffer(); for (int i = 0 ; i &lt; 8 ; i&#43;&#43;) buffer.append((int)(b &gt;&gt; (8-(i&#43;1)) &amp; 0x0001)); return buffer.toString(); } private byte[] getBits(byte[] input, int startPos, int length) { int noOfBytes = (length-1)/8 &#43; 1; byte[] output = new byte[noOfBytes]; for (int i = 0 ; i &lt; length ; i&#43;&#43;) { int value = getBitFromArray(input, startPos &#43; i); setBitInArray(output, i, value); } return output; } private byte[] rotateLeft(byte[] input, int step, int length) { int noOfBytes = (length - 1) / 8 &#43; 1; byte[] output = new byte[noOfBytes]; for (int i = 0 ; i &lt; length ; i&#43;&#43;) { int value = getBitFromArray(input, (i &#43; step) % length); setBitInArray(output, i, value); } return output; } private byte[] concatBits(byte[] one, int oneLength, byte[] two, int twoLength) { int noOfBytes = (oneLength &#43; twoLength - 1) / 8 &#43; 1; byte[] output = new byte[noOfBytes]; int i = 0, j = 0; for (; i &lt; oneLength ; i&#43;&#43;) { int value = getBitFromArray(one, i); setBitInArray(output, j, value); j&#43;&#43;; } for (i = 0 ; i &lt; twoLength ; i&#43;&#43;) { int value = getBitFromArray(two, i); setBitInArray(output, j, value); j&#43;&#43;; } return output; } private byte[][] getSubKeys(byte[] masterKey) { int noOfSubKeys = SHIFTS.length; int keySize = PC1.length; byte[] key = permute(masterKey, PC1); byte[][] subKeys = new byte[noOfSubKeys][keySize]; byte[] leftHalf = getBits(key, 0, keySize/2); byte[] rightHalf = getBits(key, keySize/2, keySize/2); for (int i = 0 ; i &lt; noOfSubKeys ; i&#43;&#43;) { leftHalf = rotateLeft(leftHalf, SHIFTS[i], keySize/2); rightHalf = rotateLeft(rightHalf, SHIFTS[i], keySize/2); byte[] subKey = concatBits(leftHalf, keySize/2, rightHalf, keySize/2); subKeys[i] = permute(subKey, PC2); } return subKeys; } public byte[] crypt(byte[] message, byte[] key, String operation) { if (message.length &lt; 8) { System.out.println(&#34;Message should be atleast 64 bits&#34;); System.exit(1); } if (key.length != 8) { System.out.println(&#34;Key should be 64 bits&#34;); System.exit(1); } int length = message.length; int n = (length &#43; 7)/8 * 8; byte[] cipher = new byte[n]; if (length == 8) { return cryptText(message, key, operation); } int i = 0; int k = 0; while (i &lt; length) { byte[] block = new byte[8]; byte[] result = new byte[8]; int j = 0; for (; j &lt; 8 &amp;&amp; i &lt; length; j&#43;&#43;, i&#43;&#43;) { block[j] = message[i]; } while (j &lt; 8) { block[j&#43;&#43;] = 0x00; } System.out.println(&#34;BLOCK: &#34;); printBytes(block); result = cryptText(block, key, operation); System.out.println(&#34;RESULT: &#34;); printBytes(result); for (j = 0 ; j &lt; 8 &amp;&amp; k &lt; cipher.length; j&#43;&#43;, k&#43;&#43;) { cipher[k] = result[j]; } } return cipher; } public byte[] cryptText(byte[] message, byte[] key, String operation) { if (message.length != 8) { System.out.println(&#34;Message should be 64 bits&#34;); System.exit(1); } if (key.length != 8) { System.out.println(&#34;Key should be 64 bits&#34;); System.exit(1); } byte[] result = null; int blockSize = IP.length; byte[][] subKeys = getSubKeys(key); int noOfRounds = subKeys.length; /** * Initial Permutation */ message = permute(message, IP); /** * Split message into two halves */ byte[] leftHalf = getBits(message, 0, blockSize/2); byte[] rightHalf = getBits(message, blockSize/2, blockSize/2); for (int i = 0 ; i &lt; noOfRounds ; i&#43;&#43;) { byte[] temp = rightHalf; /** * Expansion */ rightHalf = permute(rightHalf, E); /** * XOR rightHalf with roundKey */ byte[] roundKey = null; if (operation.equalsIgnoreCase(&#34;encrypt&#34;)) { roundKey = subKeys[i]; } else if (operation.equalsIgnoreCase(&#34;decrypt&#34;)) { roundKey = subKeys[noOfRounds - i - 1]; } else { System.out.println(&#34;Unsupported operation&#34;); System.exit(0); } rightHalf = performXOR(rightHalf, roundKey); /** * S-Box */ rightHalf = sBox(rightHalf); /** * Permutation */ rightHalf = permute(rightHalf, P); /** * XOR rightHalf with leftHalf */ rightHalf = performXOR(rightHalf, leftHalf); /** * L(i) = R(i-1) */ leftHalf = temp; } /** * 32 bit swap */ byte[] concatHalves = concatBits(rightHalf, blockSize/2, leftHalf, blockSize/2); /** * Inverse Initial Permutation */ result = permute(concatHalves, IIP); return result; } private byte[] sBox(byte[] input) { /** * Split input to 6-bit blocks */ input = split(input,6); byte[] output = new byte[input.length/2]; int leftHalf = 0; for (int i = 0; i &lt; input.length ; i&#43;&#43;) { byte block = input[i]; /** * row - first and last bits * column - 4 bits in the middle */ int row = 2 * (block &gt;&gt; 7 &amp; 0x0001) &#43; (block &gt;&gt; 2 &amp; 0x0001); int col = block &gt;&gt; 3 &amp; 0x000F; int[] selectedSBox = getSBox(i); int rightHalf = selectedSBox[16 * row &#43; col]; if (i % 2 == 0) { leftHalf = rightHalf; } else { output[i/2] = (byte) (16 * leftHalf &#43; rightHalf); leftHalf = 0; } } return output; } private int[] getSBox(int i) { switch (i) { case 0: return S1; case 1: return S2; case 2: return S3; case 3: return S4; case 4: return S5; case 5: return S6; case 6: return S7; case 7: return S8; default: return null; } } private byte[] split(byte[] input, int length) { int noOfBytes = (8 * input.length - 1) / length &#43; 1; byte[] output = new byte[noOfBytes]; for (int i = 0 ; i &lt; noOfBytes ; i&#43;&#43;) { for (int j = 0; j &lt; length ; j&#43;&#43;) { int value = getBitFromArray(input, length * i &#43; j); setBitInArray(output, 8 * i &#43; j, value); } } return output; } public static void main(String[] args) { DES des = new DES(); byte[] message = des.hexStringToByteArray(&#34;123456789ABCDEF&#34;); System.out.println(&#34;PLAIN TEXT:&#34;); des.printBytes(message); byte[] key = des.hexStringToByteArray(&#34;133457799BBCDFF1&#34;); System.out.println(&#34;KEY:&#34;); des.printBytes(key); byte[] cipher = des.crypt(message, key, &#34;encrypt&#34;); System.out.println(&#34;CIPHER TEXT:&#34;); des.printBytes(cipher); byte[] result = des.crypt(cipher, key, &#34;decrypt&#34;); System.out.println(&#34;DECRYPTED TEXT:&#34;); des.printBytes(result); } } Output">

<meta property="og:url" content="https://dhanoopbhaskar.github.io/posts/2014-06-20-des-implementation-in-java/">
  <meta property="og:site_name" content="The Insane Techie">
  <meta property="og:title" content="DES Implementation In Java">
  <meta property="og:description" content="DES.java
public class DES { /* Initial Permutation */ static final int[] IP = { 58, 50, 42, 34, 26, 18, 10, 2, 60, 52, 44, 36, 28, 20, 12, 4, 62, 54, 46, 38, 30, 22, 14, 6, 64, 56, 48, 40, 32, 24, 16, 8, 57, 49, 41, 33, 25, 17, 9, 1, 59, 51, 43, 35, 27, 19, 11, 3, 61, 53, 45, 37, 29, 21, 13, 5, 63, 55, 47, 39, 31, 23, 15, 7 }; /* Inverse Initial Permutation */ static final int[] IIP = { 40, 8, 48, 16, 56, 24, 64, 32, 39, 7, 47, 15, 55, 23, 63, 31, 38, 6, 46, 14, 54, 22, 62, 30, 37, 5, 45, 13, 53, 21, 61, 29, 36, 4, 44, 12, 52, 20, 60, 28, 35, 3, 43, 11, 51, 19, 59, 27, 34, 2, 42, 10, 50, 18, 58, 26, 33, 1, 41, 9, 49, 17, 57, 25 }; /* Expansion Permutation */ static final int[] E = { 32, 1, 2, 3, 4, 5, 4, 5, 6, 7, 8, 9, 8, 9, 10, 11, 12, 13, 12, 13, 14, 15, 16, 17, 16, 17, 18, 19, 20, 21, 20, 21, 22, 23, 24, 25, 24, 25, 26, 27, 28, 29, 28, 29, 30, 31, 32, 1 }; /* Permutation Function */ static final int[] P = { 16, 7, 20, 21, 29, 12, 28, 17, 1, 15, 23, 26, 5, 18, 31, 10, 2, 8, 24, 14, 32, 27, 3, 9, 19, 13, 30, 6, 22, 11, 4, 25 }; /* S-Boxes*/ static final int[] S1 = { 14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7, 0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8, 4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0, 15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13 }; static final int[] S2 = { 15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10, 3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5, 0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15, 13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9 }; static final int[] S3 = { 10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8, 13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1, 13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7, 1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12 }; static final int[] S4 = { 7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15, 13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9, 10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4, 3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14 }; static final int[] S5 = { 2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9, 14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6, 4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14, 11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3 }; static final int[] S6 = { 12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11, 10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8, 9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6, 4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13 }; static final int[] S7 = { 4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1, 13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6, 1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2, 6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12 }; static final int[] S8 = { 13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7, 1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2, 7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8, 2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11 }; /* Permuted Choice One */ static final int[] PC1 = { 57, 49, 41, 33, 25, 17, 9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51, 43, 35, 27, 19, 11, 3, 60, 52, 44, 36, 63, 55, 47, 39, 31, 23, 15, 7, 62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21, 13, 5, 28, 20, 12, 4 }; /* Permuted Choice Two */ static final int[] PC2 = { 14, 17, 11, 24, 1, 5, 3, 28, 15, 6, 21, 10, 23, 19, 12, 4, 26, 8, 16, 7, 27, 20, 13, 2, 41, 52, 31, 37, 47, 55, 30, 40, 51, 45, 33, 48, 44, 49, 39, 56, 34, 53, 46, 42, 50, 36, 29, 32 }; /* Schedule of Left Shifts */ static final int[] SHIFTS = { 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1 }; public DES() { } private byte[] performXOR(byte[] one, byte[] two) { byte[] result = new byte[one.length]; for (int i = 0 ; i &lt; one.length ; i&#43;&#43;) { result[i] = (byte) (one[i] ^ two[i]); } return result; } private byte[] permute(byte[] input, int[] mapping) { int byteCount = 1 &#43; (mapping.length - 1) / 8; byte[] output = new byte[byteCount]; int pos; for (int i = 0 ; i &lt; mapping.length ; i&#43;&#43;) { pos = mapping[i] - 1; int value = getBitFromArray(input, pos); setBitInArray(output, i, value); } return output; } private int getBitFromArray(byte[] array, int pos) { int value; int bytePos = pos / 8; int bitPos = pos % 8; value = (array[bytePos] &gt;&gt; (8 - (bitPos &#43; 1))) &amp; 0x0001; /* eg: right shift selected byte 5 times to get 3rd bit * (bitPos = 2) at rightmost position and * then AND with 0x0001*/ return value; } private void setBitInArray(byte[] input, int pos, int value) { int bytePos = pos / 8; int bitPos = pos % 8; byte old = input[bytePos]; old = (byte) (((0xFF7F &gt;&gt; bitPos) &amp; old) &amp; 0x00FF); byte newByte = (byte) ((value &lt;&lt; (8 - (bitPos &#43; 1))) | old); input[bytePos] = newByte; } private byte[] hexStringToByteArray(String string) { int length = string.length(); int n = (int)Math.ceil((length &#43; 1) / 2); byte[] result = new byte[n]; for (int i = length - 1; i &gt;= 0 ; i -= 2) { if (i == 0) { result[i / 2] = (byte) ((Character.digit(&#39;0&#39;, 16) &lt;&lt; 4) &#43; Character.digit(string.charAt(i), 16)); } else { result[i / 2] = (byte) ((Character.digit(string.charAt(i - 1), 16) &lt;&lt; 4) &#43; Character.digit(string.charAt(i), 16)); } } return result; } private void printBytes(byte[] input) { for (int i = 0 ; i &lt; input.length; i&#43;&#43;) { System.out.print(byteToBits(input[i]) &#43; &#34; &#34;); } System.out.println(); } private String byteToBits(byte b) { StringBuffer buffer = new StringBuffer(); for (int i = 0 ; i &lt; 8 ; i&#43;&#43;) buffer.append((int)(b &gt;&gt; (8-(i&#43;1)) &amp; 0x0001)); return buffer.toString(); } private byte[] getBits(byte[] input, int startPos, int length) { int noOfBytes = (length-1)/8 &#43; 1; byte[] output = new byte[noOfBytes]; for (int i = 0 ; i &lt; length ; i&#43;&#43;) { int value = getBitFromArray(input, startPos &#43; i); setBitInArray(output, i, value); } return output; } private byte[] rotateLeft(byte[] input, int step, int length) { int noOfBytes = (length - 1) / 8 &#43; 1; byte[] output = new byte[noOfBytes]; for (int i = 0 ; i &lt; length ; i&#43;&#43;) { int value = getBitFromArray(input, (i &#43; step) % length); setBitInArray(output, i, value); } return output; } private byte[] concatBits(byte[] one, int oneLength, byte[] two, int twoLength) { int noOfBytes = (oneLength &#43; twoLength - 1) / 8 &#43; 1; byte[] output = new byte[noOfBytes]; int i = 0, j = 0; for (; i &lt; oneLength ; i&#43;&#43;) { int value = getBitFromArray(one, i); setBitInArray(output, j, value); j&#43;&#43;; } for (i = 0 ; i &lt; twoLength ; i&#43;&#43;) { int value = getBitFromArray(two, i); setBitInArray(output, j, value); j&#43;&#43;; } return output; } private byte[][] getSubKeys(byte[] masterKey) { int noOfSubKeys = SHIFTS.length; int keySize = PC1.length; byte[] key = permute(masterKey, PC1); byte[][] subKeys = new byte[noOfSubKeys][keySize]; byte[] leftHalf = getBits(key, 0, keySize/2); byte[] rightHalf = getBits(key, keySize/2, keySize/2); for (int i = 0 ; i &lt; noOfSubKeys ; i&#43;&#43;) { leftHalf = rotateLeft(leftHalf, SHIFTS[i], keySize/2); rightHalf = rotateLeft(rightHalf, SHIFTS[i], keySize/2); byte[] subKey = concatBits(leftHalf, keySize/2, rightHalf, keySize/2); subKeys[i] = permute(subKey, PC2); } return subKeys; } public byte[] crypt(byte[] message, byte[] key, String operation) { if (message.length &lt; 8) { System.out.println(&#34;Message should be atleast 64 bits&#34;); System.exit(1); } if (key.length != 8) { System.out.println(&#34;Key should be 64 bits&#34;); System.exit(1); } int length = message.length; int n = (length &#43; 7)/8 * 8; byte[] cipher = new byte[n]; if (length == 8) { return cryptText(message, key, operation); } int i = 0; int k = 0; while (i &lt; length) { byte[] block = new byte[8]; byte[] result = new byte[8]; int j = 0; for (; j &lt; 8 &amp;&amp; i &lt; length; j&#43;&#43;, i&#43;&#43;) { block[j] = message[i]; } while (j &lt; 8) { block[j&#43;&#43;] = 0x00; } System.out.println(&#34;BLOCK: &#34;); printBytes(block); result = cryptText(block, key, operation); System.out.println(&#34;RESULT: &#34;); printBytes(result); for (j = 0 ; j &lt; 8 &amp;&amp; k &lt; cipher.length; j&#43;&#43;, k&#43;&#43;) { cipher[k] = result[j]; } } return cipher; } public byte[] cryptText(byte[] message, byte[] key, String operation) { if (message.length != 8) { System.out.println(&#34;Message should be 64 bits&#34;); System.exit(1); } if (key.length != 8) { System.out.println(&#34;Key should be 64 bits&#34;); System.exit(1); } byte[] result = null; int blockSize = IP.length; byte[][] subKeys = getSubKeys(key); int noOfRounds = subKeys.length; /** * Initial Permutation */ message = permute(message, IP); /** * Split message into two halves */ byte[] leftHalf = getBits(message, 0, blockSize/2); byte[] rightHalf = getBits(message, blockSize/2, blockSize/2); for (int i = 0 ; i &lt; noOfRounds ; i&#43;&#43;) { byte[] temp = rightHalf; /** * Expansion */ rightHalf = permute(rightHalf, E); /** * XOR rightHalf with roundKey */ byte[] roundKey = null; if (operation.equalsIgnoreCase(&#34;encrypt&#34;)) { roundKey = subKeys[i]; } else if (operation.equalsIgnoreCase(&#34;decrypt&#34;)) { roundKey = subKeys[noOfRounds - i - 1]; } else { System.out.println(&#34;Unsupported operation&#34;); System.exit(0); } rightHalf = performXOR(rightHalf, roundKey); /** * S-Box */ rightHalf = sBox(rightHalf); /** * Permutation */ rightHalf = permute(rightHalf, P); /** * XOR rightHalf with leftHalf */ rightHalf = performXOR(rightHalf, leftHalf); /** * L(i) = R(i-1) */ leftHalf = temp; } /** * 32 bit swap */ byte[] concatHalves = concatBits(rightHalf, blockSize/2, leftHalf, blockSize/2); /** * Inverse Initial Permutation */ result = permute(concatHalves, IIP); return result; } private byte[] sBox(byte[] input) { /** * Split input to 6-bit blocks */ input = split(input,6); byte[] output = new byte[input.length/2]; int leftHalf = 0; for (int i = 0; i &lt; input.length ; i&#43;&#43;) { byte block = input[i]; /** * row - first and last bits * column - 4 bits in the middle */ int row = 2 * (block &gt;&gt; 7 &amp; 0x0001) &#43; (block &gt;&gt; 2 &amp; 0x0001); int col = block &gt;&gt; 3 &amp; 0x000F; int[] selectedSBox = getSBox(i); int rightHalf = selectedSBox[16 * row &#43; col]; if (i % 2 == 0) { leftHalf = rightHalf; } else { output[i/2] = (byte) (16 * leftHalf &#43; rightHalf); leftHalf = 0; } } return output; } private int[] getSBox(int i) { switch (i) { case 0: return S1; case 1: return S2; case 2: return S3; case 3: return S4; case 4: return S5; case 5: return S6; case 6: return S7; case 7: return S8; default: return null; } } private byte[] split(byte[] input, int length) { int noOfBytes = (8 * input.length - 1) / length &#43; 1; byte[] output = new byte[noOfBytes]; for (int i = 0 ; i &lt; noOfBytes ; i&#43;&#43;) { for (int j = 0; j &lt; length ; j&#43;&#43;) { int value = getBitFromArray(input, length * i &#43; j); setBitInArray(output, 8 * i &#43; j, value); } } return output; } public static void main(String[] args) { DES des = new DES(); byte[] message = des.hexStringToByteArray(&#34;123456789ABCDEF&#34;); System.out.println(&#34;PLAIN TEXT:&#34;); des.printBytes(message); byte[] key = des.hexStringToByteArray(&#34;133457799BBCDFF1&#34;); System.out.println(&#34;KEY:&#34;); des.printBytes(key); byte[] cipher = des.crypt(message, key, &#34;encrypt&#34;); System.out.println(&#34;CIPHER TEXT:&#34;); des.printBytes(cipher); byte[] result = des.crypt(cipher, key, &#34;decrypt&#34;); System.out.println(&#34;DECRYPTED TEXT:&#34;); des.printBytes(result); } } Output">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2014-06-20T00:12:00+05:30">
    <meta property="article:modified_time" content="2014-06-20T00:12:00+05:30">
    <meta property="article:tag" content="Des Algorithm">
    <meta property="article:tag" content="Encryption">
    <meta property="article:tag" content="Crypto">
    <meta property="article:tag" content="Decryption">
    <meta property="article:tag" content="Cryptography">
    <meta property="article:tag" content="Java">




<link rel="canonical" href="https://dhanoopbhaskar.github.io/posts/2014-06-20-des-implementation-in-java/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.7763f8bc6341ecf82378e867c285e1549abb063a899be313ccd25dbfcd24fa7d.css" integrity="sha256-d2P4vGNB7PgjeOhnwoXhVJq7BjqJm&#43;MTzNJdv80k&#43;n0=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://dhanoopbhaskar.github.io/">
      The Insane Techie
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Posts</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/pencils/">Pencils</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/">Categories</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://dhanoopbhaskar.github.io/posts/2014-06-20-des-implementation-in-java/">
              DES Implementation In Java
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2014-06-20T00:12:00&#43;05:30">
                June 20, 2014
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              11-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/des-algorithm/">Des Algorithm</a>
      <span class="separator">â¢</span>
    <a href="/categories/cryptography/">Cryptography</a>
      <span class="separator">â¢</span>
    <a href="/categories/java/">Java</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/des-algorithm/">Des Algorithm</a>
    </span>
      <span class="separator">â¢</span>
    <span class="tag">
      <a href="/tags/encryption/">Encryption</a>
    </span>
      <span class="separator">â¢</span>
    <span class="tag">
      <a href="/tags/crypto/">Crypto</a>
    </span>
      <span class="separator">â¢</span>
    <span class="tag">
      <a href="/tags/decryption/">Decryption</a>
    </span>
      <span class="separator">â¢</span>
    <span class="tag">
      <a href="/tags/cryptography/">Cryptography</a>
    </span>
      <span class="separator">â¢</span>
    <span class="tag">
      <a href="/tags/java/">Java</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p><strong>DES.java</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DES</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Initial Permutation */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> IP <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            58, 50, 42, 34, 26, 18, 10, 2,
</span></span><span style="display:flex;"><span>            60, 52, 44, 36, 28, 20, 12, 4,
</span></span><span style="display:flex;"><span>            62, 54, 46, 38, 30, 22, 14, 6,
</span></span><span style="display:flex;"><span>            64, 56, 48, 40, 32, 24, 16, 8,
</span></span><span style="display:flex;"><span>            57, 49, 41, 33, 25, 17,  9, 1,
</span></span><span style="display:flex;"><span>            59, 51, 43, 35, 27, 19, 11, 3,
</span></span><span style="display:flex;"><span>            61, 53, 45, 37, 29, 21, 13, 5,
</span></span><span style="display:flex;"><span>            63, 55, 47, 39, 31, 23, 15, 7
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Inverse Initial Permutation */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> IIP <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            40, 8, 48, 16, 56, 24, 64, 32,
</span></span><span style="display:flex;"><span>            39, 7, 47, 15, 55, 23, 63, 31,
</span></span><span style="display:flex;"><span>            38, 6, 46, 14, 54, 22, 62, 30,
</span></span><span style="display:flex;"><span>            37, 5, 45, 13, 53, 21, 61, 29,
</span></span><span style="display:flex;"><span>            36, 4, 44, 12, 52, 20, 60, 28,
</span></span><span style="display:flex;"><span>            35, 3, 43, 11, 51, 19, 59, 27,
</span></span><span style="display:flex;"><span>            34, 2, 42, 10, 50, 18, 58, 26,
</span></span><span style="display:flex;"><span>            33, 1, 41,  9, 49, 17, 57, 25
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Expansion Permutation */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> E <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            32,  1,  2,  3,  4,  5,
</span></span><span style="display:flex;"><span>            4,  5,  6,  7,  8,  9,
</span></span><span style="display:flex;"><span>            8,  9, 10, 11, 12, 13,
</span></span><span style="display:flex;"><span>            12, 13, 14, 15, 16, 17,
</span></span><span style="display:flex;"><span>            16, 17, 18, 19, 20, 21,
</span></span><span style="display:flex;"><span>            20, 21, 22, 23, 24, 25,
</span></span><span style="display:flex;"><span>            24, 25, 26, 27, 28, 29,
</span></span><span style="display:flex;"><span>            28, 29, 30, 31, 32,  1
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Permutation Function */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> P <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            16,  7, 20, 21,
</span></span><span style="display:flex;"><span>            29, 12, 28, 17,
</span></span><span style="display:flex;"><span>            1, 15, 23, 26,
</span></span><span style="display:flex;"><span>            5, 18, 31, 10,
</span></span><span style="display:flex;"><span>            2,  8, 24, 14,
</span></span><span style="display:flex;"><span>            32, 27,  3,  9,
</span></span><span style="display:flex;"><span>            19, 13, 30,  6,
</span></span><span style="display:flex;"><span>            22, 11,  4, 25
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* S-Boxes*/</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S1 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            14,  4, 13,  1,  2, 15, 11,  8,  3, 10,  6, 12,  5,  9,  0,  7,
</span></span><span style="display:flex;"><span>             0, 15,  7,  4, 14,  2, 13,  1, 10,  6, 12, 11,  9,  5,  3,  8,
</span></span><span style="display:flex;"><span>             4,  1, 14,  8, 13,  6,  2, 11, 15, 12,  9,  7,  3, 10,  5,  0,
</span></span><span style="display:flex;"><span>            15, 12,  8,  2,  4,  9,  1,  7,  5, 11,  3, 14, 10,  0,  6, 13
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S2 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            15,  1,  8, 14,  6, 11,  3,  4,  9,  7,  2, 13, 12,  0,  5, 10,
</span></span><span style="display:flex;"><span>             3, 13,  4,  7, 15,  2,  8, 14, 12,  0,  1, 10,  6,  9, 11,  5,
</span></span><span style="display:flex;"><span>             0, 14,  7, 11, 10,  4, 13,  1,  5,  8, 12,  6,  9,  3,  2, 15,
</span></span><span style="display:flex;"><span>            13,  8, 10,  1,  3, 15,  4,  2, 11,  6,  7, 12,  0,  5, 14,  9
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S3 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            10,  0,  9, 14,  6,  3, 15,  5,  1, 13, 12,  7, 11,  4,  2,  8,
</span></span><span style="display:flex;"><span>            13,  7,  0,  9,  3,  4,  6, 10,  2,  8,  5, 14, 12, 11, 15,  1,
</span></span><span style="display:flex;"><span>            13,  6,  4,  9,  8, 15,  3,  0, 11,  1,  2, 12,  5, 10, 14,  7,
</span></span><span style="display:flex;"><span>             1, 10, 13,  0,  6,  9,  8,  7,  4, 15, 14,  3, 11,  5,  2, 12
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S4 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>             7, 13, 14,  3,  0,  6,  9, 10,  1,  2,  8,  5, 11, 12,  4, 15,
</span></span><span style="display:flex;"><span>            13,  8, 11,  5,  6, 15,  0,  3,  4,  7,  2, 12,  1, 10, 14,  9,
</span></span><span style="display:flex;"><span>            10,  6,  9,  0, 12, 11,  7, 13, 15,  1,  3, 14,  5,  2,  8,  4,
</span></span><span style="display:flex;"><span>             3, 15,  0,  6, 10,  1, 13,  8,  9,  4,  5, 11, 12,  7,  2, 14
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S5 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>             2, 12,  4,  1,  7, 10, 11,  6,  8,  5,  3, 15, 13,  0, 14,  9,
</span></span><span style="display:flex;"><span>            14, 11,  2, 12,  4,  7, 13,  1,  5,  0, 15, 10,  3,  9,  8,  6,
</span></span><span style="display:flex;"><span>             4,  2,  1, 11, 10, 13,  7,  8, 15,  9, 12,  5,  6,  3,  0, 14,
</span></span><span style="display:flex;"><span>            11,  8, 12,  7,  1, 14,  2, 13,  6, 15,  0,  9, 10,  4,  5,  3
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S6 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            12,  1, 10, 15,  9,  2,  6,  8,  0, 13,  3,  4, 14,  7,  5, 11,
</span></span><span style="display:flex;"><span>            10, 15,  4,  2,  7, 12,  9,  5,  6,  1, 13, 14,  0, 11,  3,  8,
</span></span><span style="display:flex;"><span>             9, 14, 15,  5,  2,  8, 12,  3,  7,  0,  4, 10,  1, 13, 11,  6,
</span></span><span style="display:flex;"><span>             4,  3,  2, 12,  9,  5, 15, 10, 11, 14,  1,  7,  6,  0,  8, 13
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S7 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>             4, 11,  2, 14, 15,  0,  8, 13,  3, 12,  9,  7,  5, 10,  6,  1,
</span></span><span style="display:flex;"><span>            13,  0, 11,  7,  4,  9,  1, 10, 14,  3,  5, 12,  2, 15,  8,  6,
</span></span><span style="display:flex;"><span>             1,  4, 11, 13, 12,  3,  7, 14, 10, 15,  6,  8,  0,  5,  9,  2,
</span></span><span style="display:flex;"><span>             6, 11, 13,  8,  1,  4, 10,  7,  9,  5,  0, 15, 14,  2,  3, 12
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S8 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            13,  2,  8,  4,  6, 15, 11,  1, 10,  9,  3, 14,  5,  0, 12,  7,
</span></span><span style="display:flex;"><span>             1, 15, 13,  8, 10,  3,  7,  4, 12,  5,  6, 11,  0, 14,  9,  2,
</span></span><span style="display:flex;"><span>             7, 11,  4,  1,  9, 12, 14,  2,  0,  6, 10, 13, 15,  3,  5,  8,
</span></span><span style="display:flex;"><span>             2,  1, 14,  7,  4, 10,  8, 13, 15, 12,  9,  0,  3,  5,  6, 11
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Permuted Choice One */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> PC1 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            57, 49, 41, 33, 25, 17,  9,
</span></span><span style="display:flex;"><span>             1, 58, 50, 42, 34, 26, 18,
</span></span><span style="display:flex;"><span>            10,  2, 59, 51, 43, 35, 27,
</span></span><span style="display:flex;"><span>            19, 11,  3, 60, 52, 44, 36,
</span></span><span style="display:flex;"><span>            63, 55, 47, 39, 31, 23, 15,
</span></span><span style="display:flex;"><span>             7, 62, 54, 46, 38, 30, 22,
</span></span><span style="display:flex;"><span>            14,  6, 61, 53, 45, 37, 29,
</span></span><span style="display:flex;"><span>            21, 13,  5, 28, 20, 12,  4
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Permuted Choice Two */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> PC2 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            14, 17, 11, 24,  1,  5,
</span></span><span style="display:flex;"><span>             3, 28, 15,  6, 21, 10,
</span></span><span style="display:flex;"><span>            23, 19, 12,  4, 26,  8,
</span></span><span style="display:flex;"><span>            16,  7, 27, 20, 13,  2,
</span></span><span style="display:flex;"><span>            41, 52, 31, 37, 47, 55,
</span></span><span style="display:flex;"><span>            30, 40, 51, 45, 33, 48,
</span></span><span style="display:flex;"><span>            44, 49, 39, 56, 34, 53,
</span></span><span style="display:flex;"><span>            46, 42, 50, 36, 29, 32
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Schedule of Left Shifts */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> SHIFTS <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DES</span>() {      
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">performXOR</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> one, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> two) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>one.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 ; i <span style="color:#f92672">&lt;</span> one.<span style="color:#a6e22e">length</span> ; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                result<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (one<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> two<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">permute</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> mapping) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> byteCount <span style="color:#f92672">=</span> 1 <span style="color:#f92672">+</span> (mapping.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>byteCount<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> pos;
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 ; i <span style="color:#f92672">&lt;</span> mapping.<span style="color:#a6e22e">length</span> ; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                pos <span style="color:#f92672">=</span> mapping<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">-</span> 1;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, pos);
</span></span><span style="display:flex;"><span>                setBitInArray(output, i, value);
</span></span><span style="display:flex;"><span>            }       
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getBitFromArray</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> array, <span style="color:#66d9ef">int</span> pos) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> value;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bytePos <span style="color:#f92672">=</span> pos <span style="color:#f92672">/</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bitPos <span style="color:#f92672">=</span> pos <span style="color:#f92672">%</span> 8;       
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> (array<span style="color:#f92672">[</span>bytePos<span style="color:#f92672">]</span> <span style="color:#f92672">&gt;&gt;</span> (8 <span style="color:#f92672">-</span> (bitPos <span style="color:#f92672">+</span> 1))) <span style="color:#f92672">&amp;</span> 0x0001;        
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/* eg: right shift selected byte 5 times to get 3rd bit 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * (bitPos = 2) at rightmost position and 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * then AND with 0x0001*/</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> value;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setBitInArray</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> pos, <span style="color:#66d9ef">int</span> value) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bytePos <span style="color:#f92672">=</span> pos <span style="color:#f92672">/</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bitPos <span style="color:#f92672">=</span> pos <span style="color:#f92672">%</span> 8;       
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> old <span style="color:#f92672">=</span> input<span style="color:#f92672">[</span>bytePos<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            old <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (((0xFF7F <span style="color:#f92672">&gt;&gt;</span> bitPos) <span style="color:#f92672">&amp;</span> old) <span style="color:#f92672">&amp;</span> 0x00FF);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> newByte <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((value <span style="color:#f92672">&lt;&lt;</span> (8 <span style="color:#f92672">-</span> (bitPos <span style="color:#f92672">+</span> 1))) <span style="color:#f92672">|</span> old);
</span></span><span style="display:flex;"><span>            input<span style="color:#f92672">[</span>bytePos<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> newByte;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">hexStringToByteArray</span>(String string) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> string.<span style="color:#a6e22e">length</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)Math.<span style="color:#a6e22e">ceil</span>((length <span style="color:#f92672">+</span> 1) <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">]</span>;        
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> length <span style="color:#f92672">-</span> 1; i <span style="color:#f92672">&gt;=</span> 0 ; i <span style="color:#f92672">-=</span> 2) { 
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((Character.<span style="color:#a6e22e">digit</span>(<span style="color:#e6db74">&#39;0&#39;</span>, 16) <span style="color:#f92672">&lt;&lt;</span> 4)
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">+</span> Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i), 16));
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i <span style="color:#f92672">-</span> 1), 16) <span style="color:#f92672">&lt;&lt;</span> 4)
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">+</span> Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i), 16));
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input) {             
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 ; i <span style="color:#f92672">&lt;</span> input.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">print</span>(byteToBits(input<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> String <span style="color:#a6e22e">byteToBits</span>(<span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            StringBuffer buffer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuffer();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 ; i <span style="color:#f92672">&lt;</span> 8 ; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>                buffer.<span style="color:#a6e22e">append</span>((<span style="color:#66d9ef">int</span>)(b <span style="color:#f92672">&gt;&gt;</span> (8<span style="color:#f92672">-</span>(i<span style="color:#f92672">+</span>1)) <span style="color:#f92672">&amp;</span> 0x0001));
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> buffer.<span style="color:#a6e22e">toString</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getBits</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> startPos, <span style="color:#66d9ef">int</span> length) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (length<span style="color:#f92672">-</span>1)<span style="color:#f92672">/</span>8 <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 ; i <span style="color:#f92672">&lt;</span> length ; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, startPos <span style="color:#f92672">+</span> i);
</span></span><span style="display:flex;"><span>                setBitInArray(output, i, value);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }   
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">rotateLeft</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> step, <span style="color:#66d9ef">int</span> length) {     
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (length <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8 <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 ; i <span style="color:#f92672">&lt;</span> length ; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, (i <span style="color:#f92672">+</span> step) <span style="color:#f92672">%</span> length);
</span></span><span style="display:flex;"><span>                setBitInArray(output, i, value);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">concatBits</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> one, <span style="color:#66d9ef">int</span> oneLength, 
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> two, <span style="color:#66d9ef">int</span> twoLength) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (oneLength <span style="color:#f92672">+</span> twoLength <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8 <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0, j <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (; i <span style="color:#f92672">&lt;</span> oneLength ; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(one, i);
</span></span><span style="display:flex;"><span>                setBitInArray(output, j, value);
</span></span><span style="display:flex;"><span>                j<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            }       
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> 0 ; i <span style="color:#f92672">&lt;</span> twoLength ; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(two, i);
</span></span><span style="display:flex;"><span>                setBitInArray(output, j, value);
</span></span><span style="display:flex;"><span>                j<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[][]</span> <span style="color:#a6e22e">getSubKeys</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> masterKey) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfSubKeys <span style="color:#f92672">=</span> SHIFTS.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> keySize <span style="color:#f92672">=</span> PC1.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span> permute(masterKey, PC1);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[][]</span> subKeys <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfSubKeys<span style="color:#f92672">][</span>keySize<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> leftHalf <span style="color:#f92672">=</span> getBits(key, 0, keySize<span style="color:#f92672">/</span>2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> rightHalf <span style="color:#f92672">=</span> getBits(key, keySize<span style="color:#f92672">/</span>2, keySize<span style="color:#f92672">/</span>2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 ; i <span style="color:#f92672">&lt;</span> noOfSubKeys ; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                leftHalf <span style="color:#f92672">=</span> rotateLeft(leftHalf, SHIFTS<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>, keySize<span style="color:#f92672">/</span>2);
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> rotateLeft(rightHalf, SHIFTS<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>, keySize<span style="color:#f92672">/</span>2);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> subKey <span style="color:#f92672">=</span> concatBits(leftHalf, keySize<span style="color:#f92672">/</span>2, rightHalf, keySize<span style="color:#f92672">/</span>2);
</span></span><span style="display:flex;"><span>                subKeys<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> permute(subKey, PC2); 
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> subKeys;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">crypt</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key, String operation) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (message.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Message should be atleast 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (key.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Key should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> message.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (length <span style="color:#f92672">+</span> 7)<span style="color:#f92672">/</span>8 <span style="color:#f92672">*</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (length <span style="color:#f92672">==</span> 8) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> cryptText(message, key, operation);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> (i <span style="color:#f92672">&lt;</span> length) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> block <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (; j <span style="color:#f92672">&lt;</span> 8 <span style="color:#f92672">&amp;&amp;</span> i <span style="color:#f92672">&lt;</span> length; j<span style="color:#f92672">++</span>, i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    block<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> message<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;</span> 8) {
</span></span><span style="display:flex;"><span>                    block<span style="color:#f92672">[</span>j<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> 0x00;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;BLOCK: &#34;</span>);
</span></span><span style="display:flex;"><span>                printBytes(block);          
</span></span><span style="display:flex;"><span>                result <span style="color:#f92672">=</span> cryptText(block, key, operation);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;RESULT: &#34;</span>);
</span></span><span style="display:flex;"><span>                printBytes(result);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (j <span style="color:#f92672">=</span> 0 ; j <span style="color:#f92672">&lt;</span> 8 <span style="color:#f92672">&amp;&amp;</span> k <span style="color:#f92672">&lt;</span> cipher.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>, k<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    cipher<span style="color:#f92672">[</span>k<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> result<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> cipher;      
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">cryptText</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key, String operation) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (message.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Message should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (key.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Key should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> blockSize <span style="color:#f92672">=</span> IP.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[][]</span> subKeys <span style="color:#f92672">=</span> getSubKeys(key);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfRounds <span style="color:#f92672">=</span> subKeys.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Initial Permutation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            message <span style="color:#f92672">=</span> permute(message, IP);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Split message into two halves
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> leftHalf <span style="color:#f92672">=</span> getBits(message, 0, blockSize<span style="color:#f92672">/</span>2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> rightHalf <span style="color:#f92672">=</span> getBits(message, blockSize<span style="color:#f92672">/</span>2, blockSize<span style="color:#f92672">/</span>2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 ; i <span style="color:#f92672">&lt;</span> noOfRounds ; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> rightHalf;
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * Expansion
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> permute(rightHalf, E);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * XOR rightHalf with roundKey
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> roundKey <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;encrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    roundKey <span style="color:#f92672">=</span> subKeys<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;decrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    roundKey <span style="color:#f92672">=</span> subKeys<span style="color:#f92672">[</span>noOfRounds <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> 1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported operation&#34;</span>);
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">exit</span>(0);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> performXOR(rightHalf, roundKey);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * S-Box
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> sBox(rightHalf);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * Permutation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> permute(rightHalf, P);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * XOR rightHalf with leftHalf
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> performXOR(rightHalf, leftHalf);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * L(i) = R(i-1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                leftHalf <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * 32 bit swap
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> concatHalves <span style="color:#f92672">=</span> concatBits(rightHalf, blockSize<span style="color:#f92672">/</span>2, leftHalf, blockSize<span style="color:#f92672">/</span>2);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Inverse Initial Permutation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            result <span style="color:#f92672">=</span> permute(concatHalves, IIP);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">sBox</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input) {     
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Split input to 6-bit blocks
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            input <span style="color:#f92672">=</span> split(input,6);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>input.<span style="color:#a6e22e">length</span><span style="color:#f92672">/</span>2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> leftHalf <span style="color:#f92672">=</span> 0;       
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> input.<span style="color:#a6e22e">length</span> ; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span> block <span style="color:#f92672">=</span> input<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;          
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * row - first and last bits
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * column - 4 bits in the middle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> row <span style="color:#f92672">=</span> 2 <span style="color:#f92672">*</span> (block <span style="color:#f92672">&gt;&gt;</span> 7 <span style="color:#f92672">&amp;</span> 0x0001) <span style="color:#f92672">+</span> (block <span style="color:#f92672">&gt;&gt;</span> 2 <span style="color:#f92672">&amp;</span> 0x0001);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> col <span style="color:#f92672">=</span> block <span style="color:#f92672">&gt;&gt;</span> 3 <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> selectedSBox <span style="color:#f92672">=</span> getSBox(i);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> rightHalf <span style="color:#f92672">=</span> selectedSBox<span style="color:#f92672">[</span>16 <span style="color:#f92672">*</span> row <span style="color:#f92672">+</span> col<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">%</span> 2 <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>                    leftHalf <span style="color:#f92672">=</span> rightHalf;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    output<span style="color:#f92672">[</span>i<span style="color:#f92672">/</span>2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (16 <span style="color:#f92672">*</span> leftHalf <span style="color:#f92672">+</span> rightHalf);
</span></span><span style="display:flex;"><span>                    leftHalf <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getSBox</span>(<span style="color:#66d9ef">int</span> i) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">switch</span> (i) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">case</span> 0: <span style="color:#66d9ef">return</span> S1;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">case</span> 1: <span style="color:#66d9ef">return</span> S2;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">case</span> 2: <span style="color:#66d9ef">return</span> S3;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">case</span> 3: <span style="color:#66d9ef">return</span> S4;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">case</span> 4: <span style="color:#66d9ef">return</span> S5;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">case</span> 5: <span style="color:#66d9ef">return</span> S6;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">case</span> 6: <span style="color:#66d9ef">return</span> S7;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">case</span> 7: <span style="color:#66d9ef">return</span> S8;  
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">default</span>: <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;           
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">split</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> length) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (8 <span style="color:#f92672">*</span> input.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> length <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 ; i <span style="color:#f92672">&lt;</span> noOfBytes ; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> length ; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, length <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j);             
</span></span><span style="display:flex;"><span>                    setBitInArray(output, 8 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j, value);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>            DES des <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DES();        
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message <span style="color:#f92672">=</span> des.<span style="color:#a6e22e">hexStringToByteArray</span>(<span style="color:#e6db74">&#34;123456789ABCDEF&#34;</span>);
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;PLAIN TEXT:&#34;</span>);
</span></span><span style="display:flex;"><span>            des.<span style="color:#a6e22e">printBytes</span>(message);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span>  des.<span style="color:#a6e22e">hexStringToByteArray</span>(<span style="color:#e6db74">&#34;133457799BBCDFF1&#34;</span>);
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;KEY:&#34;</span>);
</span></span><span style="display:flex;"><span>            des.<span style="color:#a6e22e">printBytes</span>(key);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> des.<span style="color:#a6e22e">crypt</span>(message, key, <span style="color:#e6db74">&#34;encrypt&#34;</span>);
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;CIPHER TEXT:&#34;</span>);
</span></span><span style="display:flex;"><span>            des.<span style="color:#a6e22e">printBytes</span>(cipher);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> des.<span style="color:#a6e22e">crypt</span>(cipher, key, <span style="color:#e6db74">&#34;decrypt&#34;</span>);
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;DECRYPTED TEXT:&#34;</span>);
</span></span><span style="display:flex;"><span>            des.<span style="color:#a6e22e">printBytes</span>(result);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p><strong>Output</strong></p>
<pre><code>dhanoopbhaskar@dhanoop-laptop:~$ javac DES.java 
dhanoopbhaskar@dhanoop-laptop:~$ java DES 
PLAIN TEXT: 
00000001 00100011 01000101 01100111 10001001 10101011 11001101 11101111 
KEY: 
00010011 00110100 01010111 01111001 10011011 10111100 11011111 11110001 
CIPHER TEXT: 
10000101 11101000 00010011 01010100 00001111 00001010 10110100 00000101 
DECRYPTED TEXT: 
00000001 00100011 01000101 01100111 10001001 10101011 11001101 11101111
dhanoopbhaskar@dhanoop-laptop:~$
</code></pre>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    
    <p>Hey, let's talk with the computers!</p>
    
    Â©
    
      2019 -
    
    2025
     Dhanoop Bhaskar 
    Â·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169392426-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169392426-1');
</script>


  

  

  

  

  

  

  

  
</body>
</html>
