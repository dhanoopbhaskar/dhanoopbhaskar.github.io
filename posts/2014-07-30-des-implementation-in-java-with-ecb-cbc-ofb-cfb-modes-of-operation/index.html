<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  DES Implementation In Java with ECB | CBC | OFB | CFB Modes Of Operation · The Insane Techie
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Dhanoop Bhaskar">
<meta name="description" content="Note that these are ONLY basic level programs for easy understanding
of the Data Encryption Standard (DES) algorithm
Key Generation - DESkeygen.java
    import java.io.File;
    import java.io.FileWriter;

    public class DESkeygen {

        private final File file = new File(&#34;DESkey.txt&#34;);
        private final int KEY_LENGTH = 16;
        private final static char[] hexArray = &#34;0123456789ABCDEF&#34;.toCharArray();

        public DESkeygen() {
            try {
                FileWriter fileWriter = new FileWriter(file);
                fileWriter.write(&#34;&#34;);
                for (int i = 0; i &lt; KEY_LENGTH; i&#43;&#43;) {
                    double random = Math.random();
                    int index = (int) (random * 16);
                    fileWriter.append(hexArray[index]);
                    fileWriter.flush();
                }
                fileWriter.close();
                System.out.println(&#34;Key generated and saved in &#34; &#43; file.getName());
            } catch (Exception exp) {
                exp.printStackTrace();
            }
        }

        public static void main(String[] args) {
            new DESkeygen();
        }

    }
Encryption - DESencrypt.java">
<meta name="keywords" content="">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="DES Implementation In Java with ECB | CBC | OFB | CFB Modes Of Operation">
  <meta name="twitter:description" content="Note that these are ONLY basic level programs for easy understanding of the Data Encryption Standard (DES) algorithm
Key Generation - DESkeygen.java
import java.io.File; import java.io.FileWriter; public class DESkeygen { private final File file = new File(&#34;DESkey.txt&#34;); private final int KEY_LENGTH = 16; private final static char[] hexArray = &#34;0123456789ABCDEF&#34;.toCharArray(); public DESkeygen() { try { FileWriter fileWriter = new FileWriter(file); fileWriter.write(&#34;&#34;); for (int i = 0; i &lt; KEY_LENGTH; i&#43;&#43;) { double random = Math.random(); int index = (int) (random * 16); fileWriter.append(hexArray[index]); fileWriter.flush(); } fileWriter.close(); System.out.println(&#34;Key generated and saved in &#34; &#43; file.getName()); } catch (Exception exp) { exp.printStackTrace(); } } public static void main(String[] args) { new DESkeygen(); } } Encryption - DESencrypt.java">

<meta property="og:url" content="https://dhanoopbhaskar.github.io/posts/2014-07-30-des-implementation-in-java-with-ecb-cbc-ofb-cfb-modes-of-operation/">
  <meta property="og:site_name" content="The Insane Techie">
  <meta property="og:title" content="DES Implementation In Java with ECB | CBC | OFB | CFB Modes Of Operation">
  <meta property="og:description" content="Note that these are ONLY basic level programs for easy understanding of the Data Encryption Standard (DES) algorithm
Key Generation - DESkeygen.java
import java.io.File; import java.io.FileWriter; public class DESkeygen { private final File file = new File(&#34;DESkey.txt&#34;); private final int KEY_LENGTH = 16; private final static char[] hexArray = &#34;0123456789ABCDEF&#34;.toCharArray(); public DESkeygen() { try { FileWriter fileWriter = new FileWriter(file); fileWriter.write(&#34;&#34;); for (int i = 0; i &lt; KEY_LENGTH; i&#43;&#43;) { double random = Math.random(); int index = (int) (random * 16); fileWriter.append(hexArray[index]); fileWriter.flush(); } fileWriter.close(); System.out.println(&#34;Key generated and saved in &#34; &#43; file.getName()); } catch (Exception exp) { exp.printStackTrace(); } } public static void main(String[] args) { new DESkeygen(); } } Encryption - DESencrypt.java">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2014-07-30T21:35:00+05:30">
    <meta property="article:modified_time" content="2014-07-30T21:35:00+05:30">
    <meta property="article:tag" content="Des Algorithm">
    <meta property="article:tag" content="Encryption">
    <meta property="article:tag" content="Crypto">
    <meta property="article:tag" content="Decryption">
    <meta property="article:tag" content="Cryptography">
    <meta property="article:tag" content="Java">




<link rel="canonical" href="https://dhanoopbhaskar.github.io/posts/2014-07-30-des-implementation-in-java-with-ecb-cbc-ofb-cfb-modes-of-operation/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.7763f8bc6341ecf82378e867c285e1549abb063a899be313ccd25dbfcd24fa7d.css" integrity="sha256-d2P4vGNB7PgjeOhnwoXhVJq7BjqJm&#43;MTzNJdv80k&#43;n0=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://dhanoopbhaskar.github.io/">
      The Insane Techie
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Posts</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/pencils/">Pencils</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/">Categories</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://dhanoopbhaskar.github.io/posts/2014-07-30-des-implementation-in-java-with-ecb-cbc-ofb-cfb-modes-of-operation/">
              DES Implementation In Java with ECB | CBC | OFB | CFB Modes Of Operation
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2014-07-30T21:35:00&#43;05:30">
                July 30, 2014
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              28-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/des-algorithm/">Des Algorithm</a>
      <span class="separator">•</span>
    <a href="/categories/cryptography/">Cryptography</a>
      <span class="separator">•</span>
    <a href="/categories/java/">Java</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/des-algorithm/">Des Algorithm</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/encryption/">Encryption</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/crypto/">Crypto</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/decryption/">Decryption</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/cryptography/">Cryptography</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/java/">Java</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p><em><strong>Note that these are ONLY basic level programs for easy understanding
of the Data Encryption Standard (DES) algorithm</strong></em></p>
<p><strong>Key Generation - DESkeygen.java</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.File;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileWriter;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DESkeygen</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> File file <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;DESkey.txt&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> KEY_LENGTH <span style="color:#f92672">=</span> 16;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> hexArray <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0123456789ABCDEF&#34;</span>.<span style="color:#a6e22e">toCharArray</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DESkeygen</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                FileWriter fileWriter <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileWriter(file);
</span></span><span style="display:flex;"><span>                fileWriter.<span style="color:#a6e22e">write</span>(<span style="color:#e6db74">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> KEY_LENGTH; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">double</span> random <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">random</span>();
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">int</span> index <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>) (random <span style="color:#f92672">*</span> 16);
</span></span><span style="display:flex;"><span>                    fileWriter.<span style="color:#a6e22e">append</span>(hexArray<span style="color:#f92672">[</span>index<span style="color:#f92672">]</span>);
</span></span><span style="display:flex;"><span>                    fileWriter.<span style="color:#a6e22e">flush</span>();
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                fileWriter.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Key generated and saved in &#34;</span> <span style="color:#f92672">+</span> file.<span style="color:#a6e22e">getName</span>());
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (Exception exp) {
</span></span><span style="display:flex;"><span>                exp.<span style="color:#a6e22e">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> DESkeygen();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p><strong>Encryption - DESencrypt.java</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>     
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.BufferedReader;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.ByteArrayOutputStream;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.File;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileInputStream;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileOutputStream;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileReader;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileWriter;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.util.Arrays;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DESencrypt</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> String mode <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> hexArray <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0123456789ABCDEF&#34;</span>.<span style="color:#a6e22e">toCharArray</span>();
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Initial Permutation */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> IP <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          58, 50, 42, 34, 26, 18, 10, 2,
</span></span><span style="display:flex;"><span>          60, 52, 44, 36, 28, 20, 12, 4,
</span></span><span style="display:flex;"><span>          62, 54, 46, 38, 30, 22, 14, 6,
</span></span><span style="display:flex;"><span>          64, 56, 48, 40, 32, 24, 16, 8,
</span></span><span style="display:flex;"><span>          57, 49, 41, 33, 25, 17,  9, 1,
</span></span><span style="display:flex;"><span>          59, 51, 43, 35, 27, 19, 11, 3,
</span></span><span style="display:flex;"><span>          61, 53, 45, 37, 29, 21, 13, 5,
</span></span><span style="display:flex;"><span>          63, 55, 47, 39, 31, 23, 15, 7
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Inverse Initial Permutation */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> IIP <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          40, 8, 48, 16, 56, 24, 64, 32,
</span></span><span style="display:flex;"><span>          39, 7, 47, 15, 55, 23, 63, 31,
</span></span><span style="display:flex;"><span>          38, 6, 46, 14, 54, 22, 62, 30,
</span></span><span style="display:flex;"><span>          37, 5, 45, 13, 53, 21, 61, 29,
</span></span><span style="display:flex;"><span>          36, 4, 44, 12, 52, 20, 60, 28,
</span></span><span style="display:flex;"><span>          35, 3, 43, 11, 51, 19, 59, 27,
</span></span><span style="display:flex;"><span>          34, 2, 42, 10, 50, 18, 58, 26,
</span></span><span style="display:flex;"><span>          33, 1, 41,  9, 49, 17, 57, 25
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Expansion Permutation */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> E <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          32,  1,  2,  3,  4,  5,
</span></span><span style="display:flex;"><span>          4,  5,  6,  7,  8,  9,
</span></span><span style="display:flex;"><span>          8,  9, 10, 11, 12, 13,
</span></span><span style="display:flex;"><span>          12, 13, 14, 15, 16, 17,
</span></span><span style="display:flex;"><span>          16, 17, 18, 19, 20, 21,
</span></span><span style="display:flex;"><span>          20, 21, 22, 23, 24, 25,
</span></span><span style="display:flex;"><span>          24, 25, 26, 27, 28, 29,
</span></span><span style="display:flex;"><span>          28, 29, 30, 31, 32,  1
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Permutation Function */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> P <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          16,  7, 20, 21,
</span></span><span style="display:flex;"><span>          29, 12, 28, 17,
</span></span><span style="display:flex;"><span>          1, 15, 23, 26,
</span></span><span style="display:flex;"><span>          5, 18, 31, 10,
</span></span><span style="display:flex;"><span>          2,  8, 24, 14,
</span></span><span style="display:flex;"><span>          32, 27,  3,  9,
</span></span><span style="display:flex;"><span>          19, 13, 30,  6,
</span></span><span style="display:flex;"><span>          22, 11,  4, 25
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* S-Boxes*/</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S1 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          14,  4, 13,  1,  2, 15, 11,  8,  3, 10,  6, 12,  5,  9,  0,  7,
</span></span><span style="display:flex;"><span>           0, 15,  7,  4, 14,  2, 13,  1, 10,  6, 12, 11,  9,  5,  3,  8,
</span></span><span style="display:flex;"><span>           4,  1, 14,  8, 13,  6,  2, 11, 15, 12,  9,  7,  3, 10,  5,  0,
</span></span><span style="display:flex;"><span>          15, 12,  8,  2,  4,  9,  1,  7,  5, 11,  3, 14, 10,  0,  6, 13
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S2 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          15,  1,  8, 14,  6, 11,  3,  4,  9,  7,  2, 13, 12,  0,  5, 10,
</span></span><span style="display:flex;"><span>           3, 13,  4,  7, 15,  2,  8, 14, 12,  0,  1, 10,  6,  9, 11,  5,
</span></span><span style="display:flex;"><span>           0, 14,  7, 11, 10,  4, 13,  1,  5,  8, 12,  6,  9,  3,  2, 15,
</span></span><span style="display:flex;"><span>          13,  8, 10,  1,  3, 15,  4,  2, 11,  6,  7, 12,  0,  5, 14,  9
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S3 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          10,  0,  9, 14,  6,  3, 15,  5,  1, 13, 12,  7, 11,  4,  2,  8,
</span></span><span style="display:flex;"><span>          13,  7,  0,  9,  3,  4,  6, 10,  2,  8,  5, 14, 12, 11, 15,  1,
</span></span><span style="display:flex;"><span>          13,  6,  4,  9,  8, 15,  3,  0, 11,  1,  2, 12,  5, 10, 14,  7,
</span></span><span style="display:flex;"><span>           1, 10, 13,  0,  6,  9,  8,  7,  4, 15, 14,  3, 11,  5,  2, 12
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S4 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>           7, 13, 14,  3,  0,  6,  9, 10,  1,  2,  8,  5, 11, 12,  4, 15,
</span></span><span style="display:flex;"><span>          13,  8, 11,  5,  6, 15,  0,  3,  4,  7,  2, 12,  1, 10, 14,  9,
</span></span><span style="display:flex;"><span>          10,  6,  9,  0, 12, 11,  7, 13, 15,  1,  3, 14,  5,  2,  8,  4,
</span></span><span style="display:flex;"><span>           3, 15,  0,  6, 10,  1, 13,  8,  9,  4,  5, 11, 12,  7,  2, 14
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S5 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>           2, 12,  4,  1,  7, 10, 11,  6,  8,  5,  3, 15, 13,  0, 14,  9,
</span></span><span style="display:flex;"><span>          14, 11,  2, 12,  4,  7, 13,  1,  5,  0, 15, 10,  3,  9,  8,  6,
</span></span><span style="display:flex;"><span>           4,  2,  1, 11, 10, 13,  7,  8, 15,  9, 12,  5,  6,  3,  0, 14,
</span></span><span style="display:flex;"><span>          11,  8, 12,  7,  1, 14,  2, 13,  6, 15,  0,  9, 10,  4,  5,  3
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S6 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          12,  1, 10, 15,  9,  2,  6,  8,  0, 13,  3,  4, 14,  7,  5, 11,
</span></span><span style="display:flex;"><span>          10, 15,  4,  2,  7, 12,  9,  5,  6,  1, 13, 14,  0, 11,  3,  8,
</span></span><span style="display:flex;"><span>           9, 14, 15,  5,  2,  8, 12,  3,  7,  0,  4, 10,  1, 13, 11,  6,
</span></span><span style="display:flex;"><span>           4,  3,  2, 12,  9,  5, 15, 10, 11, 14,  1,  7,  6,  0,  8, 13
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S7 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>           4, 11,  2, 14, 15,  0,  8, 13,  3, 12,  9,  7,  5, 10,  6,  1,
</span></span><span style="display:flex;"><span>          13,  0, 11,  7,  4,  9,  1, 10, 14,  3,  5, 12,  2, 15,  8,  6,
</span></span><span style="display:flex;"><span>           1,  4, 11, 13, 12,  3,  7, 14, 10, 15,  6,  8,  0,  5,  9,  2,
</span></span><span style="display:flex;"><span>           6, 11, 13,  8,  1,  4, 10,  7,  9,  5,  0, 15, 14,  2,  3, 12
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S8 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          13,  2,  8,  4,  6, 15, 11,  1, 10,  9,  3, 14,  5,  0, 12,  7,
</span></span><span style="display:flex;"><span>           1, 15, 13,  8, 10,  3,  7,  4, 12,  5,  6, 11,  0, 14,  9,  2,
</span></span><span style="display:flex;"><span>           7, 11,  4,  1,  9, 12, 14,  2,  0,  6, 10, 13, 15,  3,  5,  8,
</span></span><span style="display:flex;"><span>           2,  1, 14,  7,  4, 10,  8, 13, 15, 12,  9,  0,  3,  5,  6, 11
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Permuted Choice One */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> PC1 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          57, 49, 41, 33, 25, 17,  9,
</span></span><span style="display:flex;"><span>           1, 58, 50, 42, 34, 26, 18,
</span></span><span style="display:flex;"><span>          10,  2, 59, 51, 43, 35, 27,
</span></span><span style="display:flex;"><span>          19, 11,  3, 60, 52, 44, 36,
</span></span><span style="display:flex;"><span>          63, 55, 47, 39, 31, 23, 15,
</span></span><span style="display:flex;"><span>           7, 62, 54, 46, 38, 30, 22,
</span></span><span style="display:flex;"><span>          14,  6, 61, 53, 45, 37, 29,
</span></span><span style="display:flex;"><span>          21, 13,  5, 28, 20, 12,  4
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Permuted Choice Two */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> PC2 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          14, 17, 11, 24,  1,  5,
</span></span><span style="display:flex;"><span>           3, 28, 15,  6, 21, 10,
</span></span><span style="display:flex;"><span>          23, 19, 12,  4, 26,  8,
</span></span><span style="display:flex;"><span>          16,  7, 27, 20, 13,  2,
</span></span><span style="display:flex;"><span>          41, 52, 31, 37, 47, 55,
</span></span><span style="display:flex;"><span>          30, 40, 51, 45, 33, 48,
</span></span><span style="display:flex;"><span>          44, 49, 39, 56, 34, 53,
</span></span><span style="display:flex;"><span>          46, 42, 50, 36, 29, 32
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Schedule of Left Shifts */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> SHIFTS <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DESencrypt</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">mode</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ECB&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DESencrypt</span>(String mode) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">mode</span> <span style="color:#f92672">=</span> mode;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">performXOR</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> one, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> two) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>one.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> one.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                result<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (one<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> two<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">permute</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> mapping) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> byteCount <span style="color:#f92672">=</span> 1 <span style="color:#f92672">+</span> (mapping.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>byteCount<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> pos;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> mapping.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                pos <span style="color:#f92672">=</span> mapping<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">-</span> 1;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, pos);
</span></span><span style="display:flex;"><span>                setBitInArray(output, i, value);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getBitFromArray</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> array, <span style="color:#66d9ef">int</span> pos) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> value;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bytePos <span style="color:#f92672">=</span> pos <span style="color:#f92672">/</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bitPos <span style="color:#f92672">=</span> pos <span style="color:#f92672">%</span> 8;
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> (array<span style="color:#f92672">[</span>bytePos<span style="color:#f92672">]</span> <span style="color:#f92672">&gt;&gt;</span> (8 <span style="color:#f92672">-</span> (bitPos <span style="color:#f92672">+</span> 1))) <span style="color:#f92672">&amp;</span> 0x0001;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * eg: right shift selected byte 5 times to get 3rd bit (bitPos = 2) at
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * rightmost position and then AND with 0x0001
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> value;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setBitInArray</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> pos, <span style="color:#66d9ef">int</span> value) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bytePos <span style="color:#f92672">=</span> pos <span style="color:#f92672">/</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bitPos <span style="color:#f92672">=</span> pos <span style="color:#f92672">%</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> old <span style="color:#f92672">=</span> input<span style="color:#f92672">[</span>bytePos<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            old <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (((0xFF7F <span style="color:#f92672">&gt;&gt;</span> bitPos) <span style="color:#f92672">&amp;</span> old) <span style="color:#f92672">&amp;</span> 0x00FF);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> newByte <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((value <span style="color:#f92672">&lt;&lt;</span> (8 <span style="color:#f92672">-</span> (bitPos <span style="color:#f92672">+</span> 1))) <span style="color:#f92672">|</span> old);
</span></span><span style="display:flex;"><span>            input<span style="color:#f92672">[</span>bytePos<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> newByte;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">hexStringToByteArray</span>(String string) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> string.<span style="color:#a6e22e">length</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>) Math.<span style="color:#a6e22e">ceil</span>((length <span style="color:#f92672">+</span> 1) <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> length <span style="color:#f92672">-</span> 1; i <span style="color:#f92672">&gt;=</span> 0; i <span style="color:#f92672">-=</span> 2) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((Character.<span style="color:#a6e22e">digit</span>(<span style="color:#e6db74">&#39;0&#39;</span>, 16) <span style="color:#f92672">&lt;&lt;</span> 4) <span style="color:#f92672">+</span> Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i), 16));
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i <span style="color:#f92672">-</span> 1), 16) <span style="color:#f92672">&lt;&lt;</span> 4)
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">+</span> Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i), 16));
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">bytesToHex</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> bytes) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> hexChars <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[</span>bytes.<span style="color:#a6e22e">length</span> <span style="color:#f92672">*</span> 2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> bytes.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> v <span style="color:#f92672">=</span> bytes<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">&amp;</span> 0xFF;
</span></span><span style="display:flex;"><span>                hexChars<span style="color:#f92672">[</span>j <span style="color:#f92672">*</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> hexArray<span style="color:#f92672">[</span>v <span style="color:#f92672">&gt;&gt;&gt;</span> 4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                hexChars<span style="color:#f92672">[</span>j <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> hexArray<span style="color:#f92672">[</span>v <span style="color:#f92672">&amp;</span> 0x0F<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> String(hexChars);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> input.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">print</span>(byteToBits(input<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> String <span style="color:#a6e22e">byteToBits</span>(<span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            StringBuffer buffer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuffer();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> 8; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>                buffer.<span style="color:#a6e22e">append</span>((<span style="color:#66d9ef">int</span>) (b <span style="color:#f92672">&gt;&gt;</span> (8 <span style="color:#f92672">-</span> (i <span style="color:#f92672">+</span> 1)) <span style="color:#f92672">&amp;</span> 0x0001));
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> buffer.<span style="color:#a6e22e">toString</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getBits</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> startPos, <span style="color:#66d9ef">int</span> length) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (length <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8 <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> length; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, startPos <span style="color:#f92672">+</span> i);
</span></span><span style="display:flex;"><span>                setBitInArray(output, i, value);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">rotateLeft</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> step, <span style="color:#66d9ef">int</span> length) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (length <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8 <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> length; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, (i <span style="color:#f92672">+</span> step) <span style="color:#f92672">%</span> length);
</span></span><span style="display:flex;"><span>                setBitInArray(output, i, value);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">concatBits</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> one, <span style="color:#66d9ef">int</span> oneLength, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> two, <span style="color:#66d9ef">int</span> twoLength) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (oneLength <span style="color:#f92672">+</span> twoLength <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8 <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0, j <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (; i <span style="color:#f92672">&lt;</span> oneLength; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(one, i);
</span></span><span style="display:flex;"><span>                setBitInArray(output, j, value);
</span></span><span style="display:flex;"><span>                j<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> twoLength; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(two, i);
</span></span><span style="display:flex;"><span>                setBitInArray(output, j, value);
</span></span><span style="display:flex;"><span>                j<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[][]</span> <span style="color:#a6e22e">getSubKeys</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> masterKey) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfSubKeys <span style="color:#f92672">=</span> SHIFTS.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> keySize <span style="color:#f92672">=</span> PC1.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span> permute(masterKey, PC1);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[][]</span> subKeys <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfSubKeys<span style="color:#f92672">][</span>keySize<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> leftHalf <span style="color:#f92672">=</span> getBits(key, 0, keySize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> rightHalf <span style="color:#f92672">=</span> getBits(key, keySize <span style="color:#f92672">/</span> 2, keySize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> noOfSubKeys; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                leftHalf <span style="color:#f92672">=</span> rotateLeft(leftHalf, SHIFTS<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>, keySize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> rotateLeft(rightHalf, SHIFTS<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>, keySize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> subKey <span style="color:#f92672">=</span> concatBits(leftHalf, keySize <span style="color:#f92672">/</span> 2, rightHalf, keySize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>                subKeys<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> permute(subKey, PC2);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> subKeys;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">crypt</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key, String operation) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (message.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Message should be atleast 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (key.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Key should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> message.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (length <span style="color:#f92672">+</span> 7) <span style="color:#f92672">/</span> 8 <span style="color:#f92672">*</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (length <span style="color:#f92672">==</span> 8) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;ECB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> cryptText(message, key, operation);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> iv <span style="color:#f92672">=</span> getInitializationVector();
</span></span><span style="display:flex;"><span>                    message <span style="color:#f92672">=</span> XORBytes(message, iv);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> cryptText(message, key, operation);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> nounce <span style="color:#f92672">=</span> getNounce();
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> cryptText(nounce, key, operation);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> XORBytes(temp, message);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported mode of operation!&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> feedback <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getInitializationVector();
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getNounce();
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getInitializationVectorCFB();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> (i <span style="color:#f92672">&lt;</span> length) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> block <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (; j <span style="color:#f92672">&lt;</span> 8 <span style="color:#f92672">&amp;&amp;</span> i <span style="color:#f92672">&lt;</span> length; j<span style="color:#f92672">++</span>, i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    block<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> message<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;</span> 8) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* pad with white spaces */</span>
</span></span><span style="display:flex;"><span>                    block<span style="color:#f92672">[</span>j<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> 0x20;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;BLOCK: &#34;);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printBytes(block);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;ECB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> cryptText(block, key, operation);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;encrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                        block <span style="color:#f92672">=</span> XORBytes(block, feedback);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(block, key, operation);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 8);
</span></span><span style="display:flex;"><span>                    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;decrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(block, key, operation);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> XORBytes(result, feedback);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 0, 8);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> cryptText(feedback, key, operation);
</span></span><span style="display:flex;"><span>                    feedback <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 8);
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> XORBytes(result, block);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;encrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(feedback, key, operation);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 4);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 0, 4);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp1 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8), temp1);
</span></span><span style="display:flex;"><span>                        resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8);
</span></span><span style="display:flex;"><span>                        blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 4, 8);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(feedback, key, operation);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp2 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8), temp2);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> mergeBytes(temp1, temp2);
</span></span><span style="display:flex;"><span>                    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;decrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(feedback, key, <span style="color:#e6db74">&#34;encrypt&#34;</span>);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 4);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 0, 4);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp1 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8), blockPart);
</span></span><span style="display:flex;"><span>                        resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8);
</span></span><span style="display:flex;"><span>                        blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 4, 8);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(feedback, key, <span style="color:#e6db74">&#34;encrypt&#34;</span>);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp2 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8), blockPart);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> mergeBytes(temp1, temp2);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported mode of operation!&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;RESULT: &#34;);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printBytes(result);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> 8 <span style="color:#f92672">&amp;&amp;</span> k <span style="color:#f92672">&lt;</span> cipher.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>, k<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    cipher<span style="color:#f92672">[</span>k<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> result<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> cipher;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getInitializationVector</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;DCBE6AE7EA5D5C61&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getInitializationVectorCFB</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;A5D5C61EFADB4351&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getNounce</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// char[] hexArray = &#34;0123456789ABCDEF&#34;.toCharArray();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// String nounceStr = &#34;&#34;;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// for (int i = 0 ; i &lt; 16 ; i++) {</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// double random = Math.random();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// int index = (int) (random * 16);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// nounceStr += hexArray[index];</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// }</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// return hexStringToByteArray(nounceStr);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;DCBE6AE7EA5D5C61&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">mergeBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in1, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in2) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>in1.<span style="color:#a6e22e">length</span> <span style="color:#f92672">+</span> in2.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> in1.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> in1<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> in2.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> in2<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">cryptText</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key, String operation) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (message.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Message should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (key.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Key should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> blockSize <span style="color:#f92672">=</span> IP.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[][]</span> subKeys <span style="color:#f92672">=</span> getSubKeys(key);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfRounds <span style="color:#f92672">=</span> subKeys.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Initial Permutation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            message <span style="color:#f92672">=</span> permute(message, IP);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Split message into two halves
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> leftHalf <span style="color:#f92672">=</span> getBits(message, 0, blockSize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> rightHalf <span style="color:#f92672">=</span> getBits(message, blockSize <span style="color:#f92672">/</span> 2, blockSize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> noOfRounds; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> rightHalf;
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * Expansion
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> permute(rightHalf, E);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * XOR rightHalf with roundKey
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> roundKey <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;encrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    roundKey <span style="color:#f92672">=</span> subKeys<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;decrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    roundKey <span style="color:#f92672">=</span> subKeys<span style="color:#f92672">[</span>noOfRounds <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> 1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported operation&#34;</span>);
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">exit</span>(0);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> performXOR(rightHalf, roundKey);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * S-Box
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> sBox(rightHalf);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * Permutation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> permute(rightHalf, P);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * XOR rightHalf with leftHalf
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> performXOR(rightHalf, leftHalf);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * L(i) = R(i-1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                leftHalf <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * 32 bit swap
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> concatHalves <span style="color:#f92672">=</span> concatBits(rightHalf, blockSize <span style="color:#f92672">/</span> 2, leftHalf, blockSize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Inverse Initial Permutation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            result <span style="color:#f92672">=</span> permute(concatHalves, IIP);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">XORBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in1, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in2) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>in1.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> in1.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((in1<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in2<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">sBox</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Split input to 6-bit blocks
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            input <span style="color:#f92672">=</span> split(input, 6);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>input.<span style="color:#a6e22e">length</span> <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> leftHalf <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> input.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span> block <span style="color:#f92672">=</span> input<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * row - first and last bits column - 4 bits in the middle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> row <span style="color:#f92672">=</span> 2 <span style="color:#f92672">*</span> (block <span style="color:#f92672">&gt;&gt;</span> 7 <span style="color:#f92672">&amp;</span> 0x0001) <span style="color:#f92672">+</span> (block <span style="color:#f92672">&gt;&gt;</span> 2 <span style="color:#f92672">&amp;</span> 0x0001);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> col <span style="color:#f92672">=</span> block <span style="color:#f92672">&gt;&gt;</span> 3 <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> selectedSBox <span style="color:#f92672">=</span> getSBox(i);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> rightHalf <span style="color:#f92672">=</span> selectedSBox<span style="color:#f92672">[</span>16 <span style="color:#f92672">*</span> row <span style="color:#f92672">+</span> col<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">%</span> 2 <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>                    leftHalf <span style="color:#f92672">=</span> rightHalf;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    output<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (16 <span style="color:#f92672">*</span> leftHalf <span style="color:#f92672">+</span> rightHalf);
</span></span><span style="display:flex;"><span>                    leftHalf <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getSBox</span>(<span style="color:#66d9ef">int</span> i) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">switch</span> (i) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 0:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 1:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S2;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 2:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S3;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 3:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S4;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 4:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S5;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 5:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S6;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 6:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S7;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 7:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">default</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">split</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> length) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (8 <span style="color:#f92672">*</span> input.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> length <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> noOfBytes; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> length; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, length <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j);
</span></span><span style="display:flex;"><span>                    setBitInArray(output, 8 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j, value);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (args.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 1) {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Usage: java &lt; classname &gt; &lt; mode &gt;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n\t&lt; mode &gt; := (ECB|CBC|OFB|CFB)&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/* ECB, CBC, OFB, or CFB */</span>
</span></span><span style="display:flex;"><span>                String mode <span style="color:#f92672">=</span> args<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                mode <span style="color:#f92672">=</span> mode.<span style="color:#a6e22e">toUpperCase</span>();
</span></span><span style="display:flex;"><span>                DESencrypt des <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DESencrypt(mode);
</span></span><span style="display:flex;"><span>                File keyFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;DESkey.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                File textFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;DESplaintext.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                File cipherFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;DESciphertext.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                FileReader keyFileReader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileReader(keyFile);
</span></span><span style="display:flex;"><span>                BufferedReader bufferedReader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader(keyFileReader);
</span></span><span style="display:flex;"><span>                FileInputStream textFileInputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream(textFile);
</span></span><span style="display:flex;"><span>                FileOutputStream cipherFileOutputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream(cipherFile);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>(<span style="color:#66d9ef">int</span>) keyFile.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                String keyString <span style="color:#f92672">=</span> bufferedReader.<span style="color:#a6e22e">readLine</span>();
</span></span><span style="display:flex;"><span>                key <span style="color:#f92672">=</span> des.<span style="color:#a6e22e">hexStringToByteArray</span>(keyString);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>(<span style="color:#66d9ef">int</span>) textFile.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                textFileInputStream.<span style="color:#a6e22e">read</span>(message);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> des.<span style="color:#a6e22e">crypt</span>(message, key, <span style="color:#e6db74">&#34;encrypt&#34;</span>);
</span></span><span style="display:flex;"><span>                cipherFileOutputStream.<span style="color:#a6e22e">write</span>(cipher);
</span></span><span style="display:flex;"><span>                cipherFileOutputStream.<span style="color:#a6e22e">flush</span>();
</span></span><span style="display:flex;"><span>                cipherFileOutputStream.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                bufferedReader.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                textFileInputStream.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Encryption done! Please check DESciphertext.txt for output!&#34;</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (Exception exp) {
</span></span><span style="display:flex;"><span>                exp.<span style="color:#a6e22e">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p><strong>Decryption - DESdecrypt.java</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.BufferedReader;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.ByteArrayOutputStream;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.File;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileInputStream;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileOutputStream;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileReader;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.io.FileWriter;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> java.util.Arrays;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DESdecrypt</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> String mode <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> hexArray <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0123456789ABCDEF&#34;</span>.<span style="color:#a6e22e">toCharArray</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Initial Permutation */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> IP <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          58, 50, 42, 34, 26, 18, 10, 2,
</span></span><span style="display:flex;"><span>          60, 52, 44, 36, 28, 20, 12, 4,
</span></span><span style="display:flex;"><span>          62, 54, 46, 38, 30, 22, 14, 6,
</span></span><span style="display:flex;"><span>          64, 56, 48, 40, 32, 24, 16, 8,
</span></span><span style="display:flex;"><span>          57, 49, 41, 33, 25, 17,  9, 1,
</span></span><span style="display:flex;"><span>          59, 51, 43, 35, 27, 19, 11, 3,
</span></span><span style="display:flex;"><span>          61, 53, 45, 37, 29, 21, 13, 5,
</span></span><span style="display:flex;"><span>          63, 55, 47, 39, 31, 23, 15, 7
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Inverse Initial Permutation */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> IIP <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          40, 8, 48, 16, 56, 24, 64, 32,
</span></span><span style="display:flex;"><span>          39, 7, 47, 15, 55, 23, 63, 31,
</span></span><span style="display:flex;"><span>          38, 6, 46, 14, 54, 22, 62, 30,
</span></span><span style="display:flex;"><span>          37, 5, 45, 13, 53, 21, 61, 29,
</span></span><span style="display:flex;"><span>          36, 4, 44, 12, 52, 20, 60, 28,
</span></span><span style="display:flex;"><span>          35, 3, 43, 11, 51, 19, 59, 27,
</span></span><span style="display:flex;"><span>          34, 2, 42, 10, 50, 18, 58, 26,
</span></span><span style="display:flex;"><span>          33, 1, 41,  9, 49, 17, 57, 25
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Expansion Permutation */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> E <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          32,  1,  2,  3,  4,  5,
</span></span><span style="display:flex;"><span>          4,  5,  6,  7,  8,  9,
</span></span><span style="display:flex;"><span>          8,  9, 10, 11, 12, 13,
</span></span><span style="display:flex;"><span>          12, 13, 14, 15, 16, 17,
</span></span><span style="display:flex;"><span>          16, 17, 18, 19, 20, 21,
</span></span><span style="display:flex;"><span>          20, 21, 22, 23, 24, 25,
</span></span><span style="display:flex;"><span>          24, 25, 26, 27, 28, 29,
</span></span><span style="display:flex;"><span>          28, 29, 30, 31, 32,  1
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Permutation Function */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> P <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          16,  7, 20, 21,
</span></span><span style="display:flex;"><span>          29, 12, 28, 17,
</span></span><span style="display:flex;"><span>          1, 15, 23, 26,
</span></span><span style="display:flex;"><span>          5, 18, 31, 10,
</span></span><span style="display:flex;"><span>          2,  8, 24, 14,
</span></span><span style="display:flex;"><span>          32, 27,  3,  9,
</span></span><span style="display:flex;"><span>          19, 13, 30,  6,
</span></span><span style="display:flex;"><span>          22, 11,  4, 25
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* S-Boxes*/</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S1 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          14,  4, 13,  1,  2, 15, 11,  8,  3, 10,  6, 12,  5,  9,  0,  7,
</span></span><span style="display:flex;"><span>           0, 15,  7,  4, 14,  2, 13,  1, 10,  6, 12, 11,  9,  5,  3,  8,
</span></span><span style="display:flex;"><span>           4,  1, 14,  8, 13,  6,  2, 11, 15, 12,  9,  7,  3, 10,  5,  0,
</span></span><span style="display:flex;"><span>          15, 12,  8,  2,  4,  9,  1,  7,  5, 11,  3, 14, 10,  0,  6, 13
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S2 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          15,  1,  8, 14,  6, 11,  3,  4,  9,  7,  2, 13, 12,  0,  5, 10,
</span></span><span style="display:flex;"><span>           3, 13,  4,  7, 15,  2,  8, 14, 12,  0,  1, 10,  6,  9, 11,  5,
</span></span><span style="display:flex;"><span>           0, 14,  7, 11, 10,  4, 13,  1,  5,  8, 12,  6,  9,  3,  2, 15,
</span></span><span style="display:flex;"><span>          13,  8, 10,  1,  3, 15,  4,  2, 11,  6,  7, 12,  0,  5, 14,  9
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S3 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          10,  0,  9, 14,  6,  3, 15,  5,  1, 13, 12,  7, 11,  4,  2,  8,
</span></span><span style="display:flex;"><span>          13,  7,  0,  9,  3,  4,  6, 10,  2,  8,  5, 14, 12, 11, 15,  1,
</span></span><span style="display:flex;"><span>          13,  6,  4,  9,  8, 15,  3,  0, 11,  1,  2, 12,  5, 10, 14,  7,
</span></span><span style="display:flex;"><span>           1, 10, 13,  0,  6,  9,  8,  7,  4, 15, 14,  3, 11,  5,  2, 12
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S4 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>           7, 13, 14,  3,  0,  6,  9, 10,  1,  2,  8,  5, 11, 12,  4, 15,
</span></span><span style="display:flex;"><span>          13,  8, 11,  5,  6, 15,  0,  3,  4,  7,  2, 12,  1, 10, 14,  9,
</span></span><span style="display:flex;"><span>          10,  6,  9,  0, 12, 11,  7, 13, 15,  1,  3, 14,  5,  2,  8,  4,
</span></span><span style="display:flex;"><span>           3, 15,  0,  6, 10,  1, 13,  8,  9,  4,  5, 11, 12,  7,  2, 14
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S5 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>           2, 12,  4,  1,  7, 10, 11,  6,  8,  5,  3, 15, 13,  0, 14,  9,
</span></span><span style="display:flex;"><span>          14, 11,  2, 12,  4,  7, 13,  1,  5,  0, 15, 10,  3,  9,  8,  6,
</span></span><span style="display:flex;"><span>           4,  2,  1, 11, 10, 13,  7,  8, 15,  9, 12,  5,  6,  3,  0, 14,
</span></span><span style="display:flex;"><span>          11,  8, 12,  7,  1, 14,  2, 13,  6, 15,  0,  9, 10,  4,  5,  3
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S6 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          12,  1, 10, 15,  9,  2,  6,  8,  0, 13,  3,  4, 14,  7,  5, 11,
</span></span><span style="display:flex;"><span>          10, 15,  4,  2,  7, 12,  9,  5,  6,  1, 13, 14,  0, 11,  3,  8,
</span></span><span style="display:flex;"><span>           9, 14, 15,  5,  2,  8, 12,  3,  7,  0,  4, 10,  1, 13, 11,  6,
</span></span><span style="display:flex;"><span>           4,  3,  2, 12,  9,  5, 15, 10, 11, 14,  1,  7,  6,  0,  8, 13
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S7 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>           4, 11,  2, 14, 15,  0,  8, 13,  3, 12,  9,  7,  5, 10,  6,  1,
</span></span><span style="display:flex;"><span>          13,  0, 11,  7,  4,  9,  1, 10, 14,  3,  5, 12,  2, 15,  8,  6,
</span></span><span style="display:flex;"><span>           1,  4, 11, 13, 12,  3,  7, 14, 10, 15,  6,  8,  0,  5,  9,  2,
</span></span><span style="display:flex;"><span>           6, 11, 13,  8,  1,  4, 10,  7,  9,  5,  0, 15, 14,  2,  3, 12
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> S8 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          13,  2,  8,  4,  6, 15, 11,  1, 10,  9,  3, 14,  5,  0, 12,  7,
</span></span><span style="display:flex;"><span>           1, 15, 13,  8, 10,  3,  7,  4, 12,  5,  6, 11,  0, 14,  9,  2,
</span></span><span style="display:flex;"><span>           7, 11,  4,  1,  9, 12, 14,  2,  0,  6, 10, 13, 15,  3,  5,  8,
</span></span><span style="display:flex;"><span>           2,  1, 14,  7,  4, 10,  8, 13, 15, 12,  9,  0,  3,  5,  6, 11
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Permuted Choice One */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> PC1 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          57, 49, 41, 33, 25, 17,  9,
</span></span><span style="display:flex;"><span>           1, 58, 50, 42, 34, 26, 18,
</span></span><span style="display:flex;"><span>          10,  2, 59, 51, 43, 35, 27,
</span></span><span style="display:flex;"><span>          19, 11,  3, 60, 52, 44, 36,
</span></span><span style="display:flex;"><span>          63, 55, 47, 39, 31, 23, 15,
</span></span><span style="display:flex;"><span>           7, 62, 54, 46, 38, 30, 22,
</span></span><span style="display:flex;"><span>          14,  6, 61, 53, 45, 37, 29,
</span></span><span style="display:flex;"><span>          21, 13,  5, 28, 20, 12,  4
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Permuted Choice Two */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> PC2 <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          14, 17, 11, 24,  1,  5,
</span></span><span style="display:flex;"><span>           3, 28, 15,  6, 21, 10,
</span></span><span style="display:flex;"><span>          23, 19, 12,  4, 26,  8,
</span></span><span style="display:flex;"><span>          16,  7, 27, 20, 13,  2,
</span></span><span style="display:flex;"><span>          41, 52, 31, 37, 47, 55,
</span></span><span style="display:flex;"><span>          30, 40, 51, 45, 33, 48,
</span></span><span style="display:flex;"><span>          44, 49, 39, 56, 34, 53,
</span></span><span style="display:flex;"><span>          46, 42, 50, 36, 29, 32
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* Schedule of Left Shifts */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> SHIFTS <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DESdecrypt</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">mode</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ECB&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">DESdecrypt</span>(String mode) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">mode</span> <span style="color:#f92672">=</span> mode;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">performXOR</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> one, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> two) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>one.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> one.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                result<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (one<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> two<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">permute</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> mapping) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> byteCount <span style="color:#f92672">=</span> 1 <span style="color:#f92672">+</span> (mapping.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>byteCount<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> pos;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> mapping.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                pos <span style="color:#f92672">=</span> mapping<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">-</span> 1;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, pos);
</span></span><span style="display:flex;"><span>                setBitInArray(output, i, value);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getBitFromArray</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> array, <span style="color:#66d9ef">int</span> pos) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> value;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bytePos <span style="color:#f92672">=</span> pos <span style="color:#f92672">/</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bitPos <span style="color:#f92672">=</span> pos <span style="color:#f92672">%</span> 8;
</span></span><span style="display:flex;"><span>            value <span style="color:#f92672">=</span> (array<span style="color:#f92672">[</span>bytePos<span style="color:#f92672">]</span> <span style="color:#f92672">&gt;&gt;</span> (8 <span style="color:#f92672">-</span> (bitPos <span style="color:#f92672">+</span> 1))) <span style="color:#f92672">&amp;</span> 0x0001;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * eg: right shift selected byte 5 times to get 3rd bit (bitPos = 2) at
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * rightmost position and then AND with 0x0001
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> value;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setBitInArray</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> pos, <span style="color:#66d9ef">int</span> value) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bytePos <span style="color:#f92672">=</span> pos <span style="color:#f92672">/</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> bitPos <span style="color:#f92672">=</span> pos <span style="color:#f92672">%</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> old <span style="color:#f92672">=</span> input<span style="color:#f92672">[</span>bytePos<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            old <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (((0xFF7F <span style="color:#f92672">&gt;&gt;</span> bitPos) <span style="color:#f92672">&amp;</span> old) <span style="color:#f92672">&amp;</span> 0x00FF);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span> newByte <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((value <span style="color:#f92672">&lt;&lt;</span> (8 <span style="color:#f92672">-</span> (bitPos <span style="color:#f92672">+</span> 1))) <span style="color:#f92672">|</span> old);
</span></span><span style="display:flex;"><span>            input<span style="color:#f92672">[</span>bytePos<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> newByte;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">hexStringToByteArray</span>(String string) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> string.<span style="color:#a6e22e">length</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>) Math.<span style="color:#a6e22e">ceil</span>((length <span style="color:#f92672">+</span> 1) <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> length <span style="color:#f92672">-</span> 1; i <span style="color:#f92672">&gt;=</span> 0; i <span style="color:#f92672">-=</span> 2) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((Character.<span style="color:#a6e22e">digit</span>(<span style="color:#e6db74">&#39;0&#39;</span>, 16) <span style="color:#f92672">&lt;&lt;</span> 4) <span style="color:#f92672">+</span> Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i), 16));
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    result<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i <span style="color:#f92672">-</span> 1), 16) <span style="color:#f92672">&lt;&lt;</span> 4)
</span></span><span style="display:flex;"><span>                            <span style="color:#f92672">+</span> Character.<span style="color:#a6e22e">digit</span>(string.<span style="color:#a6e22e">charAt</span>(i), 16));
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">bytesToHex</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> bytes) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> hexChars <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">[</span>bytes.<span style="color:#a6e22e">length</span> <span style="color:#f92672">*</span> 2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> bytes.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> v <span style="color:#f92672">=</span> bytes<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">&amp;</span> 0xFF;
</span></span><span style="display:flex;"><span>                hexChars<span style="color:#f92672">[</span>j <span style="color:#f92672">*</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> hexArray<span style="color:#f92672">[</span>v <span style="color:#f92672">&gt;&gt;&gt;</span> 4<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                hexChars<span style="color:#f92672">[</span>j <span style="color:#f92672">*</span> 2 <span style="color:#f92672">+</span> 1<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> hexArray<span style="color:#f92672">[</span>v <span style="color:#f92672">&amp;</span> 0x0F<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> String(hexChars);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> input.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">print</span>(byteToBits(input<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> String <span style="color:#a6e22e">byteToBits</span>(<span style="color:#66d9ef">byte</span> b) {
</span></span><span style="display:flex;"><span>            StringBuffer buffer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuffer();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> 8; i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span>                buffer.<span style="color:#a6e22e">append</span>((<span style="color:#66d9ef">int</span>) (b <span style="color:#f92672">&gt;&gt;</span> (8 <span style="color:#f92672">-</span> (i <span style="color:#f92672">+</span> 1)) <span style="color:#f92672">&amp;</span> 0x0001));
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> buffer.<span style="color:#a6e22e">toString</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getBits</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> startPos, <span style="color:#66d9ef">int</span> length) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (length <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8 <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> length; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, startPos <span style="color:#f92672">+</span> i);
</span></span><span style="display:flex;"><span>                setBitInArray(output, i, value);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">rotateLeft</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> step, <span style="color:#66d9ef">int</span> length) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (length <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8 <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> length; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, (i <span style="color:#f92672">+</span> step) <span style="color:#f92672">%</span> length);
</span></span><span style="display:flex;"><span>                setBitInArray(output, i, value);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">concatBits</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> one, <span style="color:#66d9ef">int</span> oneLength, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> two, <span style="color:#66d9ef">int</span> twoLength) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (oneLength <span style="color:#f92672">+</span> twoLength <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> 8 <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0, j <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (; i <span style="color:#f92672">&lt;</span> oneLength; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(one, i);
</span></span><span style="display:flex;"><span>                setBitInArray(output, j, value);
</span></span><span style="display:flex;"><span>                j<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> twoLength; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(two, i);
</span></span><span style="display:flex;"><span>                setBitInArray(output, j, value);
</span></span><span style="display:flex;"><span>                j<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[][]</span> <span style="color:#a6e22e">getSubKeys</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> masterKey) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfSubKeys <span style="color:#f92672">=</span> SHIFTS.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> keySize <span style="color:#f92672">=</span> PC1.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span> permute(masterKey, PC1);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[][]</span> subKeys <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfSubKeys<span style="color:#f92672">][</span>keySize<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> leftHalf <span style="color:#f92672">=</span> getBits(key, 0, keySize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> rightHalf <span style="color:#f92672">=</span> getBits(key, keySize <span style="color:#f92672">/</span> 2, keySize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> noOfSubKeys; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                leftHalf <span style="color:#f92672">=</span> rotateLeft(leftHalf, SHIFTS<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>, keySize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> rotateLeft(rightHalf, SHIFTS<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>, keySize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> subKey <span style="color:#f92672">=</span> concatBits(leftHalf, keySize <span style="color:#f92672">/</span> 2, rightHalf, keySize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>                subKeys<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> permute(subKey, PC2);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> subKeys;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">crypt</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key, String operation) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (message.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Message should be atleast 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (key.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Key should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> message.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> (length <span style="color:#f92672">+</span> 7) <span style="color:#f92672">/</span> 8 <span style="color:#f92672">*</span> 8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (length <span style="color:#f92672">==</span> 8) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;ECB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> cryptText(message, key, operation);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> iv <span style="color:#f92672">=</span> getInitializationVector();
</span></span><span style="display:flex;"><span>                    message <span style="color:#f92672">=</span> XORBytes(message, iv);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> cryptText(message, key, operation);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> nounce <span style="color:#f92672">=</span> getNounce();
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> cryptText(nounce, key, <span style="color:#e6db74">&#34;encrypt&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> XORBytes(temp, message);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported mode of operation!&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> feedback <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getInitializationVector();
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getNounce();
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                feedback <span style="color:#f92672">=</span> getInitializationVectorCFB();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> (i <span style="color:#f92672">&lt;</span> length) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> block <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>8<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (; j <span style="color:#f92672">&lt;</span> 8 <span style="color:#f92672">&amp;&amp;</span> i <span style="color:#f92672">&lt;</span> length; j<span style="color:#f92672">++</span>, i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    block<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> message<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">while</span> (j <span style="color:#f92672">&lt;</span> 8) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* pad with white spaces */</span>
</span></span><span style="display:flex;"><span>                    block<span style="color:#f92672">[</span>j<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> 0x20;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;BLOCK: &#34;);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printBytes(block);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;ECB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> cryptText(block, key, operation);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CBC&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;encrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                        block <span style="color:#f92672">=</span> XORBytes(block, feedback);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(block, key, operation);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 8);
</span></span><span style="display:flex;"><span>                    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;decrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(block, key, operation);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> XORBytes(result, feedback);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 0, 8);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;OFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> cryptText(feedback, key, <span style="color:#e6db74">&#34;encrypt&#34;</span>);
</span></span><span style="display:flex;"><span>                    feedback <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 8);
</span></span><span style="display:flex;"><span>                    result <span style="color:#f92672">=</span> XORBytes(result, block);
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (mode.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;CFB&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;encrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(feedback, key, operation);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 4);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 0, 4);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp1 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8), temp1);
</span></span><span style="display:flex;"><span>                        resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8);
</span></span><span style="display:flex;"><span>                        blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 4, 8);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(feedback, key, operation);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp2 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8), temp2);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> mergeBytes(temp1, temp2);
</span></span><span style="display:flex;"><span>                    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;decrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(feedback, key, <span style="color:#e6db74">&#34;encrypt&#34;</span>);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 0, 4);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 0, 4);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp1 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8), blockPart);
</span></span><span style="display:flex;"><span>                        resultPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8);
</span></span><span style="display:flex;"><span>                        blockPart <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">copyOfRange</span>(block, 4, 8);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> cryptText(feedback, key, <span style="color:#e6db74">&#34;encrypt&#34;</span>);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp2 <span style="color:#f92672">=</span> XORBytes(resultPart, blockPart);
</span></span><span style="display:flex;"><span>                        feedback <span style="color:#f92672">=</span> mergeBytes(Arrays.<span style="color:#a6e22e">copyOfRange</span>(result, 4, 8), blockPart);
</span></span><span style="display:flex;"><span>                        result <span style="color:#f92672">=</span> mergeBytes(temp1, temp2);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported mode of operation!&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// System.out.println(&#34;RESULT: &#34;);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// printBytes(result);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> 8 <span style="color:#f92672">&amp;&amp;</span> k <span style="color:#f92672">&lt;</span> cipher.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>, k<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    cipher<span style="color:#f92672">[</span>k<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> result<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> cipher;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getInitializationVector</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;DCBE6AE7EA5D5C61&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getInitializationVectorCFB</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;A5D5C61EFADB4351&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getNounce</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// char[] hexArray = &#34;0123456789ABCDEF&#34;.toCharArray();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// String nounceStr = &#34;&#34;;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// for (int i = 0 ; i &lt; 16 ; i++) {</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// double random = Math.random();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// int index = (int) (random * 16);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// nounceStr += hexArray[index];</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// }</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// return hexStringToByteArray(nounceStr);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> hexStringToByteArray(<span style="color:#e6db74">&#34;DCBE6AE7EA5D5C61&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">mergeBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in1, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in2) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>in1.<span style="color:#a6e22e">length</span> <span style="color:#f92672">+</span> in2.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> in1.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> in1<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> in2.<span style="color:#a6e22e">length</span>; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> in2<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">cryptText</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key, String operation) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (message.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Message should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (key.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 8) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Key should be 64 bits&#34;</span>);
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">exit</span>(1);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> blockSize <span style="color:#f92672">=</span> IP.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[][]</span> subKeys <span style="color:#f92672">=</span> getSubKeys(key);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfRounds <span style="color:#f92672">=</span> subKeys.<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Initial Permutation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            message <span style="color:#f92672">=</span> permute(message, IP);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Split message into two halves
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> leftHalf <span style="color:#f92672">=</span> getBits(message, 0, blockSize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> rightHalf <span style="color:#f92672">=</span> getBits(message, blockSize <span style="color:#f92672">/</span> 2, blockSize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> noOfRounds; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> temp <span style="color:#f92672">=</span> rightHalf;
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * Expansion
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> permute(rightHalf, E);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * XOR rightHalf with roundKey
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> roundKey <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;encrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    roundKey <span style="color:#f92672">=</span> subKeys<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (operation.<span style="color:#a6e22e">equalsIgnoreCase</span>(<span style="color:#e6db74">&#34;decrypt&#34;</span>)) {
</span></span><span style="display:flex;"><span>                    roundKey <span style="color:#f92672">=</span> subKeys<span style="color:#f92672">[</span>noOfRounds <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> 1<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Unsupported operation&#34;</span>);
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">exit</span>(0);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> performXOR(rightHalf, roundKey);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * S-Box
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> sBox(rightHalf);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * Permutation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> permute(rightHalf, P);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * XOR rightHalf with leftHalf
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                rightHalf <span style="color:#f92672">=</span> performXOR(rightHalf, leftHalf);
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * L(i) = R(i-1)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                leftHalf <span style="color:#f92672">=</span> temp;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * 32 bit swap
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> concatHalves <span style="color:#f92672">=</span> concatBits(rightHalf, blockSize <span style="color:#f92672">/</span> 2, leftHalf, blockSize <span style="color:#f92672">/</span> 2);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Inverse Initial Permutation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            result <span style="color:#f92672">=</span> permute(concatHalves, IIP);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">XORBytes</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in1, <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> in2) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> out <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>in1.<span style="color:#a6e22e">length</span><span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> in1.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                out<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) ((in1<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">^</span> in2<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>) <span style="color:#f92672">&amp;</span> 0xff);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> out;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">sBox</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             * Split input to 6-bit blocks
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">             */</span>
</span></span><span style="display:flex;"><span>            input <span style="color:#f92672">=</span> split(input, 6);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>input.<span style="color:#a6e22e">length</span> <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> leftHalf <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> input.<span style="color:#a6e22e">length</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span> block <span style="color:#f92672">=</span> input<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 * row - first and last bits column - 4 bits in the middle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                 */</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> row <span style="color:#f92672">=</span> 2 <span style="color:#f92672">*</span> (block <span style="color:#f92672">&gt;&gt;</span> 7 <span style="color:#f92672">&amp;</span> 0x0001) <span style="color:#f92672">+</span> (block <span style="color:#f92672">&gt;&gt;</span> 2 <span style="color:#f92672">&amp;</span> 0x0001);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> col <span style="color:#f92672">=</span> block <span style="color:#f92672">&gt;&gt;</span> 3 <span style="color:#f92672">&amp;</span> 0x000F;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> selectedSBox <span style="color:#f92672">=</span> getSBox(i);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> rightHalf <span style="color:#f92672">=</span> selectedSBox<span style="color:#f92672">[</span>16 <span style="color:#f92672">*</span> row <span style="color:#f92672">+</span> col<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">%</span> 2 <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span>                    leftHalf <span style="color:#f92672">=</span> rightHalf;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    output<span style="color:#f92672">[</span>i <span style="color:#f92672">/</span> 2<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> (<span style="color:#66d9ef">byte</span>) (16 <span style="color:#f92672">*</span> leftHalf <span style="color:#f92672">+</span> rightHalf);
</span></span><span style="display:flex;"><span>                    leftHalf <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">getSBox</span>(<span style="color:#66d9ef">int</span> i) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">switch</span> (i) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 0:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 1:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S2;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 2:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S3;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 3:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S4;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 4:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S5;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 5:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S6;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 6:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S7;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> 7:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> S8;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">default</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">split</span>(<span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> input, <span style="color:#66d9ef">int</span> length) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> noOfBytes <span style="color:#f92672">=</span> (8 <span style="color:#f92672">*</span> input.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> 1) <span style="color:#f92672">/</span> length <span style="color:#f92672">+</span> 1;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> output <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>noOfBytes<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0; i <span style="color:#f92672">&lt;</span> noOfBytes; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0; j <span style="color:#f92672">&lt;</span> length; j<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">int</span> value <span style="color:#f92672">=</span> getBitFromArray(input, length <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j);
</span></span><span style="display:flex;"><span>                    setBitInArray(output, 8 <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j, value);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> output;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (args.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> 1) {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Usage: java &lt; classname &gt; &lt; mode &gt;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\n\t&lt; mode &gt; := (ECB|CBC|OFB|CFB)&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">/* ECB, CBC, OFB, or CFB */</span>
</span></span><span style="display:flex;"><span>                String mode <span style="color:#f92672">=</span> args<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                mode <span style="color:#f92672">=</span> mode.<span style="color:#a6e22e">toUpperCase</span>();
</span></span><span style="display:flex;"><span>                DESdecrypt des <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DESdecrypt(mode);
</span></span><span style="display:flex;"><span>                File keyFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;DESkey.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                File textFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;DESplaintext.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                File cipherFile <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> File(<span style="color:#e6db74">&#34;DESciphertext.txt&#34;</span>);
</span></span><span style="display:flex;"><span>                FileReader keyFileReader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileReader(keyFile);
</span></span><span style="display:flex;"><span>                BufferedReader bufferedReader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BufferedReader(keyFileReader);
</span></span><span style="display:flex;"><span>                FileInputStream cipherFileInputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream(cipherFile);
</span></span><span style="display:flex;"><span>                FileOutputStream textFileOutputStream <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream(textFile);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> key <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>(<span style="color:#66d9ef">int</span>) keyFile.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                String keyString <span style="color:#f92672">=</span> bufferedReader.<span style="color:#a6e22e">readLine</span>();
</span></span><span style="display:flex;"><span>                key <span style="color:#f92672">=</span> des.<span style="color:#a6e22e">hexStringToByteArray</span>(keyString);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> cipher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>(<span style="color:#66d9ef">int</span>) cipherFile.<span style="color:#a6e22e">length</span>()<span style="color:#f92672">]</span>;
</span></span><span style="display:flex;"><span>                cipherFileInputStream.<span style="color:#a6e22e">read</span>(cipher);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> message <span style="color:#f92672">=</span> des.<span style="color:#a6e22e">crypt</span>(cipher, key, <span style="color:#e6db74">&#34;decrypt&#34;</span>);
</span></span><span style="display:flex;"><span>                textFileOutputStream.<span style="color:#a6e22e">write</span>(message);
</span></span><span style="display:flex;"><span>                textFileOutputStream.<span style="color:#a6e22e">flush</span>();
</span></span><span style="display:flex;"><span>                textFileOutputStream.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                bufferedReader.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                cipherFileInputStream.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Decryption done! Please check DESplaintext.txt for output!&#34;</span>);
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (Exception exp) {
</span></span><span style="display:flex;"><span>                exp.<span style="color:#a6e22e">printStackTrace</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  </span></span></code></pre></div>
<p><strong>Output</strong></p>
<pre><code>dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESkeygen
Key generated and saved in DESkey.txt
dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESencrypt
Usage: java &lt;classname&gt; &lt;mode&gt;
 &lt;mode&gt; := (ECB|CBC|OFB|CFB)
dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESencrypt ecb
Encryption done! Please check DESciphertext.txt for output!
dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESdecrypt ecb
Decryption done! Please check DESplaintext.txt for output!
dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESencrypt cbc
Encryption done! Please check DESciphertext.txt for output!
dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESdecrypt cbc
Decryption done! Please check DESplaintext.txt for output!
dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESencrypt ofb
Encryption done! Please check DESciphertext.txt for output!
dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESdecrypt ofb
Decryption done! Please check DESplaintext.txt for output!
dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESencrypt cfb
Encryption done! Please check DESciphertext.txt for output!
dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESdecrypt cfb
Decryption done! Please check DESplaintext.txt for output!
dhanoopbhaskar@dhanoop-laptop:~/workspace$ java DESdecrypt cfb
Decryption done! Please check DESplaintext.txt for output!
dhanoopbhaskar@dhanoop-laptop:~/workspace$ 
</code></pre>
<p><strong>About Input/Output Files</strong><br>
DESkeygen.java - (output) DESkey.txt</p>
<p>DESencrypt.java - (input) DESkey.txt &amp; DESplaintext.txt (output)
DESciphertext.txt </p>
<p>DESdecrypt.java - (input) DESkey.txt &amp; DESciphertext.txt (output)
DESplaintext.txt</p>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    
    <p>Hey, let's talk with the computers!</p>
    
    ©
    
      2019 -
    
    2025
     Dhanoop Bhaskar 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169392426-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169392426-1');
</script>


  

  

  

  

  

  

  

  
</body>
</html>
